package com.Pisquare.Dao;


import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.sql.CallableStatement;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.text.DecimalFormat;
import java.text.NumberFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.List;
import java.util.List.*;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.web.context.request.RequestContextHolder;

import com.Pisquare.Beans.Change_Password;
import com.Pisquare.Beans.Cus;
import com.Pisquare.Beans.Customer;
import com.Pisquare.Beans.GL_Master;
import com.Pisquare.Beans.Login;
import com.Pisquare.Beans.Branch_Master;
import com.Pisquare.Beans.Simple;
import com.Pisquare.Beans.SimpleBranch;
import com.Pisquare.Beans.UserDetails;
import com.Pisquare.Controllers.Configuration_Controller;


public class JLArrearDao {
	
	int Binfo=201;
	
	@Autowired
	private Configuration_Controller con;
JdbcTemplate template;
	
	public void setTemplate(JdbcTemplate template)
	{
		this.template=template;
		
	}
	
	public static String newline = System.getProperty("line.separator");
	
	
	 public List<SimpleBranch>useBranch_Code2(int code)
		{
			//--Set Connection----------------------------
		 int j=Binfo;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			return template.query("select * from Branch_Master where Branch_Code="+code+"",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
																					{  
			
																						SimpleBranch c=new SimpleBranch();
																						c.setS1(rs.getInt(1));//BRANCH_CODE
																						c.setS2(rs.getString(10));//BRANCH_NAME
																						c.setS3(rs.getString(3));//BRANCH_ADDRESS
																						c.setS4(rs.getString(4));//BRANCH_CITY
																						c.setS5(rs.getString(5));//BRANCH_PINCODE
																						c.setS6(rs.getString(6));//BRANCH_PHONE
																						c.setS7(rs.getLong(7));//
																						c.setS8(rs.getLong(8));//
																						
																						return c;
																					}
		 																		 }     );
		}
	 

		public List<SimpleBranch> getSKFD_Monthly_Report(String Monthly_From_Date,
				String Monthly_To_Date,String Status, int Bcode) {
			// --Set Connection------------------------------------
			int j = Bcode;
			this.template = con.getCon2(j);
		//	String sql="select a.* from (select FD_Master_View.Open_Date,(select Branch_Name from Branch_Master where Branch_Code=FD_Master_View.Branch_Code) as Branch_Name,FD_Master_View.Customer_Name,FD_Master_View.Mode_Of_Operation,FD_Master_View.Customer_Id,(case when Renewal_NO is null then 'Fresh' else 'Renewal' end) as acc_Type,(select Scheme_Name from scheme_Master where scheme_code=FD_Master_View.Scheme_Code) as SName,FD_Master_View.Deposit_Amount,(case when Period_Days = '0' then to_char(Period_Months||'M') else to_char(Period_Days||'D') end) as Period,(Employee_Target.Employee_Id || ' - '|| Employee_Target.Employee_Name) as Staff_ID from FD_Master_View left join Employee_Target on FD_Master_View.Account_No=Employee_Target.Account_No where FD_Master_View.Scheme_Code in (select scheme_code from Scheme_Master where dep=9) and FD_Master_View.Open_Date between to_date('"+Monthly_From_Date+"','dd-MM-yyyy') and to_date('"+Monthly_To_Date+"','dd-MM-yyyy') order by FD_Master_View.Branch_Code) a where a.acc_Type='"+Status+"'";
			//String sql="select a.* from (select FD_Master_View.Open_Date,(select Branch_Name from Branch_Master where Branch_Code=FD_Master_View.Branch_Code) as Branch_Name,(case when Mode_Of_Operation = 'E' then FD_Master_View.Customer_Name || ' - ' || FD_Master_View.Customer_Name_2 when Mode_Of_Operation = 'A' then FD_Master_View.Customer_Name || ' - ' || FD_Master_View.Customer_Name_2 || ' - ' || FD_Master_View.Customer_Name_3  else FD_Master_View.Customer_Name end) as Customer_Name,FD_Master_View.Mode_Of_Operation,FD_Master_View.Customer_Id,(case when Renewal_NO is null then 'Fresh' else 'Renewal' end) as acc_Type,(select Scheme_Name from scheme_Master where scheme_code=FD_Master_View.Scheme_Code) as SName,FD_Master_View.Deposit_Amount,(case when Period_Days = '0' then to_char(Period_Months||'M') else to_char(Period_Days||'D') end) as Period,(Employee_Target.Employee_Id || ' - '|| Employee_Target.Employee_Name) as Staff_ID,case when R_2000>0 then '2000 x ' || R_2000 || '; ' else '' End || case when R_500>0 then '500 x ' || R_500 || '; ' else '' End || case when R_200>0 then '200 x ' || R_200 || '; ' else '' End || case when R_100>0 then '100 x ' || R_100 || '; ' else '' End || case when R_50>0 then '50 x ' || R_50 || '; ' else '' End || case when R_20>0 then '20 x ' || R_20 || '; ' else '' End || case when R_10>0 then '10 x ' || R_10 || '; ' else '' End || case when R_5>0 then '5 x ' || R_5 || '; ' else '' End || case when R_adjustment>0 then R_adjustment || ';' else '' End || case when R_coins>0 then R_coins || ' - coins; ' else '' End  as Denomination from FD_Master_View left join Employee_Target on FD_Master_View.Account_No=Employee_Target.Account_No left join (Select Account_No,Transaction_Id,Transaction_date from Daily_Transaction_Table where Page_Source='FDM' and Transaction_Type='Credit' and Flag='AC') b on FD_Master_View.Account_no=b.Account_No left join Denomination_View c on b.Transaction_Id=c.Transaction_Id and b.Transaction_date=c.Transaction_date where FD_Master_View.Scheme_Code in (select Scheme_Code from Scheme_Master where Dep=9) and FD_Master_View.Open_Date between to_date('"+Monthly_From_Date+"','dd-MM-yyyy') and to_date('"+Monthly_To_Date+"','dd-MM-yyyy') order by FD_Master_View.Branch_Code) a where a.acc_Type='"+Status+"'";
			String sql="select a.* from (select FD_Master_View.Open_Date,(select Branch_Name from Branch_Master where Branch_Code=FD_Master_View.Branch_Code) as Branch_Name,(case when Mode_Of_Operation = 'E' then FD_Master_View.Customer_Name || ' - ' || FD_Master_View.Customer_Name_2 when Mode_Of_Operation = 'A' then FD_Master_View.Customer_Name || ' - ' || FD_Master_View.Customer_Name_2 || ' - ' || FD_Master_View.Customer_Name_3  else FD_Master_View.Customer_Name end) as Customer_Name,FD_Master_View.Mode_Of_Operation,FD_Master_View.Customer_Id,(case when Renewal_NO is null then 'Fresh' else 'Renewal' end) as acc_Type,(select Scheme_Name from scheme_Master where scheme_code=FD_Master_View.Scheme_Code) as SName,FD_Master_View.Deposit_Amount,(case when Period_Days = '0' then to_char(Period_Months||'M') else to_char(Period_Days||'D') end) as Period,(Employee_Target.Employee_Id || ' - '|| Employee_Target.Employee_Name) as Staff_ID,case when R_2000>0 then '2000 x ' || R_2000 || '; ' else '' End || case when R_500>0 then '500 x ' || R_500 || '; ' else '' End || case when R_200>0 then '200 x ' || R_200 || '; ' else '' End || case when R_100>0 then '100 x ' || R_100 || '; ' else '' End || case when R_50>0 then '50 x ' || R_50 || '; ' else '' End || case when R_20>0 then '20 x ' || R_20 || '; ' else '' End || case when R_10>0 then '10 x ' || R_10 || '; ' else '' End || case when R_5>0 then '5 x ' || R_5 || '; ' else '' End || case when R_adjustment>0 then R_adjustment || ';' else '' End || case when R_coins>0 then R_coins || ' - coins; ' else '' End  as Denomination from FD_Master_View left join Employee_Target on FD_Master_View.Account_No=Employee_Target.Account_No left join (Select Account_No,Transaction_Id,Transaction_date,Branch from Daily_Transaction_Table where Page_Source='FDM' and Transaction_Type='Credit' and Flag='AC') b on FD_Master_View.Account_no=b.Account_No left join Denomination_View c on b.Transaction_Id=c.Transaction_Id and b.Transaction_date=c.Transaction_date and b.Branch=c.Bcode where FD_Master_View.Scheme_Code in (select Scheme_Code from Scheme_Master where Dep=9) and FD_Master_View.Open_Date between to_date('"+Monthly_From_Date+"','dd-MM-yyyy') and to_date('"+Monthly_To_Date+"','dd-MM-yyyy') order by FD_Master_View.Branch_Code) a where a.acc_Type='"+Status+"'";

			
			System.out.println("Active="+sql);
			return template
					.query(sql,
							new RowMapper<SimpleBranch>() {
								public SimpleBranch mapRow(ResultSet rs, int row)
										throws SQLException {
									SimpleDateFormat sd = new SimpleDateFormat(
											"dd/MM/yyyy");

									SimpleBranch jm = new SimpleBranch();
									
									jm.setS33(sd.format(rs.getDate(1))); // Open date										
									jm.setS31(rs.getString(2)); // branch name
									jm.setS32(rs.getString(3)); // customer name
									jm.setS37(rs.getString(4)); // MOP										
									jm.setS35(rs.getString(5)); // customer id
									jm.setS36(rs.getString(6)); // acc type										
									jm.setS39(rs.getString(7)); // scheme name
									jm.setS141(rs.getDouble(8));//deposit amount
									jm.setS34(rs.getString(9)); // interest rate									
									jm.setS135(rs.getString(10)); //staff id
									jm.setS38(rs.getString(11)); // denomination

									return jm;
								}
							});
		}
		


	
	 public List<SimpleBranch>getJLArrearReport(String To_Date, int Days, int code)
		{
			//--Set Connection----------------------------
		 int j=Binfo;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			System.out.println("Inside dao---------------------------------------");
			
	//		String query="select k.bname,k.sname,k.Account_no,k.customer_name,k.open_date,k.loan_amount,(-1)* k.closing_balance,k.days as pending_days,k.interest_paid_upto,k.Transamt as arrear_interest,k.bal_as_on from(select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '201' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser1.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser1.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser1.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser1.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '202' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser2.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser2.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser2.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser2.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '203' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser3.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser3.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser3.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser3.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '204' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser4.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser4.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser4.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser4.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '205' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser5.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser5.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser5.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser5.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '206' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser6.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser6.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser6.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser6.jl_Master where Account_Status='A'  order by scheme_code,days desc)a )b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '207' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser7.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser7.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser7.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser7.jl_Master where Account_Status='A'  order by scheme_code,days desc)a )b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '208' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser8.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser8.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser8.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser8.jl_Master where Account_Status='A'  order by scheme_code,days desc)a )b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '209' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser9.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser9.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser9.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser9.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '210' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser10.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser10.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser10.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser10.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '211' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser11.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser11.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser11.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser11.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '212' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser12.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser12.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser12.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser12.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '213' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser13.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser13.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser13.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser13.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '214' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,user14.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(user14.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(user14.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from user14.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '215' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser15.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser15.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser15.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser15.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '216' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser16.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser16.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser16.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser16.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '217' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser17.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser17.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser17.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser17.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '218' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser18.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser18.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser18.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser18.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '219' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser19.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser19.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser19.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser19.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '220' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser20.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser20.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser20.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser20.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '221' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser21.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser21.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser21.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser21.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '222' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser22.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser22.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser22.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser22.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '223' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser23.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser23.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser23.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser23.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '224' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser24.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser24.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser24.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser24.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '225' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser25.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser25.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser25.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser25.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '226' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser26.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser26.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser26.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser26.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '227' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser27.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser27.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser27.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser27.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '228' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser28.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser28.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser28.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser28.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '229' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser29.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser29.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser29.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser29.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '230' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser30.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser30.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser30.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser30.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '231' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser31.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser31.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser31.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser31.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '232' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser32.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser32.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser32.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser32.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '233' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser33.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser33.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser33.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser33.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b)k where k.days>"+Days+" order by k.branch,k.scheme_code";
	//		String query="select k.bname,k.sname,k.Account_no,k.customer_name,k.open_date,k.loan_amount,(-1)* k.closing_balance,k.days as pending_days,k.interest_paid_upto,k.Transamt as arrear_interest,k.bal_as_on from(select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '201' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser1.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser1.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser1.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser1.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '202' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser2.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser2.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser2.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser2.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '203' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser3.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser3.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser3.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser3.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '204' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser4.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser4.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser4.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser4.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '205' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser5.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser5.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser5.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser5.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '206' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser6.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser6.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser6.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser6.jl_Master where Account_Status='A'  order by scheme_code,days desc)a )b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '207' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser7.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser7.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser7.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser7.jl_Master where Account_Status='A'  order by scheme_code,days desc)a )b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '208' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser8.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser8.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser8.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser8.jl_Master where Account_Status='A'  order by scheme_code,days desc)a )b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '209' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser9.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser9.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser9.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser9.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '210' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser10.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser10.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser10.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser10.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '211' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser11.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser11.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser11.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser11.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '212' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser12.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser12.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser12.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser12.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '213' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser13.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser13.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser13.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser13.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '214' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,user14.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(user14.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(user14.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from user14.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '215' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser15.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser15.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser15.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser15.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '216' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser16.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser16.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser16.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser16.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '217' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser17.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser17.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser17.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser17.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '218' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser18.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser18.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser18.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser18.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '219' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser19.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser19.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser19.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser19.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '220' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser20.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser20.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser20.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser20.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '221' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser21.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser21.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser21.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser21.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '222' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser22.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser22.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser22.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser22.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '223' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser23.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser23.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser23.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser23.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '224' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser24.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser24.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser24.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser24.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '225' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser25.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser25.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser25.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser25.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '226' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser26.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser26.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser26.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser26.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '227' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser27.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser27.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser27.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser27.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '228' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser28.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser28.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser28.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser28.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '229' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser29.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser29.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser29.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser29.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '230' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser30.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser30.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser30.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser30.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '231' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser31.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser31.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser31.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser31.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '232' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser32.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser32.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser32.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser32.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,(select scheme_name from scheme_master where scheme_code=b.scheme_code) as sname from (select '233' as branch, a.scheme_code, a.Account_no,a.open_date,a.interest_rate,a.loan_amount,a.days,Case when a.interest_rate=11 and a.days<=30 then 11 else a.Revised_Rate end,a.Transamt,a.Customer_name,a.Interest_paid_upto,a.customer_id,a.closing_balance,(-1*a.Bal_as_On) as Bal_as_On from(select Account_no, open_date,interest_rate,loan_amount,to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO as days,dbuser33.Get_JL_Interest_Rate_60018((to_date('"+To_Date+"', 'dd/MM/yyyy')-INTEREST_PAID_UPTO),Interest_Rate,Scheme_Code,to_char(Open_Date,'dd/MM/yyyy'),Account_No) as Revised_Rate ,(dbuser33.GET_JL_INTEREST2018(Account_no,'"+To_Date+"'))as Transamt,customer_name,INTEREST_PAID_UPTO,customer_id,scheme_code,closing_balance,(dbuser33.Get_Acc_Balance(jl_Master.Account_no,'"+To_Date+"'))as Bal_as_On from dbuser33.jl_Master where Account_Status='A'  order by scheme_code,days desc)a)b)k where k.days>"+Days+" order by k.branch,k.scheme_code";
	//		String query="select k.bname,k.sname,k.Account_no,k.customer_name,k.open_date,k.loan_amount, k.cb,k.days as pending_days,k.interest_paid_upto,k.overdue,k.total,k.odd from (select k2.*,(select branch_Name from branch_master where to_char(branch_code)=k2.branch) as bname,(select scheme_name from scheme_master where scheme_code=k2.scheme_code)as sname from (select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '201' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser1.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser1.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser1.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser1.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser1.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '202' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser2.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser2.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser2.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser2.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser2.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union  select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '203' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser3.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser3.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser3.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser3.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser3.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '204' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser4.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser4.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser4.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser4.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser4.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '205' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser5.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser5.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser5.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser5.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser5.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '206' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser6.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser6.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser6.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser6.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser6.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '207' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser7.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser7.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser7.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser7.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser7.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '208' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser8.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser8.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser8.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser8.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser8.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '209' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser9.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser9.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser9.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser9.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser9.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '210' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser10.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser10.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser10.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser10.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser10.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '211' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser11.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser11.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser11.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser11.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser11.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '212' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser12.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser12.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser12.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser12.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser12.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '213' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser13.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser13.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser13.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser13.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser13.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '214' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,user14.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,user14.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,user14.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,user14.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from user14.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '215' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser15.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser15.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser15.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser15.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser15.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '216' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser16.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser16.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser16.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser16.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser16.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '217' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser17.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser17.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser17.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser17.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser17.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '218' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser18.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser18.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser18.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser18.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser18.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '219' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser19.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser19.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser19.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser19.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser19.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '220' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser20.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser20.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser20.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser20.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser20.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '221' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser21.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser21.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser21.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser21.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser21.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '222' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser22.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser22.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser22.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser22.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser22.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '223' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser23.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser23.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser23.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser23.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser23.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '224' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser24.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser24.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser24.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser24.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser24.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '225' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser25.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser25.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser25.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser25.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser25.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '226' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser26.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser26.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser26.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser26.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser26.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '227' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser27.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser27.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser27.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser27.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser27.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '228' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser28.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser28.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser28.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser28.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser28.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '229' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser29.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser29.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser29.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser29.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser29.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '230' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser30.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser30.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser30.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser30.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser30.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '231' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser31.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser31.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser31.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser31.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser31.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '232' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser32.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser32.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser32.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser32.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser32.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '233' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser33.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser33.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser33.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser33.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total from dbuser33.jl_Master where Account_Status='A' order by scheme_code,Account_No)a)k2)k where k.days>0 and k.days>="+Days+"";
	//		String query="select k.bname,k.sname,k.Account_no,k.customer_name,k.open_date,k.loan_amount, k.cb,k.days as pending_days,k.interest_paid_upto,k.overdue,k.total,k.odd,to_char(k.due_date,'dd/MM/yyyy') as due_date1,to_char(k.period_months|| 'M') as period from (select k2.*,(select branch_Name from branch_master where to_char(branch_code)=k2.branch) as bname,(select scheme_name from scheme_master where scheme_code=k2.scheme_code)as sname from (select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '201' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser1.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser1.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser1.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser1.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser1.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '202' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser2.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser2.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser2.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser2.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser2.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '203' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser3.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser3.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser3.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser3.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser3.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '204' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser4.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser4.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser4.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser4.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser4.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '205' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser5.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser5.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser5.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser5.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser5.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '206' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser6.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser6.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser6.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser6.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser6.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '207' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser7.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser7.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser7.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser7.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser7.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '208' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser8.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser8.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser8.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser8.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser8.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '209' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser9.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser9.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser9.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser9.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser9.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '210' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser10.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser10.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser10.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser10.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser10.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '211' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser11.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser11.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser11.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser11.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser11.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '212' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser12.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser12.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser12.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser12.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser12.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '213' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser13.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser13.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser13.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser13.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser13.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '214' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,user14.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,user14.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,user14.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,user14.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from user14.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '215' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser15.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser15.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser15.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser15.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser15.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '216' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser16.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser16.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser16.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser16.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser16.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '217' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser17.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser17.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser17.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser17.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser17.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '218' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser18.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser18.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser18.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser18.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser18.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '219' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser19.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser19.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser19.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser19.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser19.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '220' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser20.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser20.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser20.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser20.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser20.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '221' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser21.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser21.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser21.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser21.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser21.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '222' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser22.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser22.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser22.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser22.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser22.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '223' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser23.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser23.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser23.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser23.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser23.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '224' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser24.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser24.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser24.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser24.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser24.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '225' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser25.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser25.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser25.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser25.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser25.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '226' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser26.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser26.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser26.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser26.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser26.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '227' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser27.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser27.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser27.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser27.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser27.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '228' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser28.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser28.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser28.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser28.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser28.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '229' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser29.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser29.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser29.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser29.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser29.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '230' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser30.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser30.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser30.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser30.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser30.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '231' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser31.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser31.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser31.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser31.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser31.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '232' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser32.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser32.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser32.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser32.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser32.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '233' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser33.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser33.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser33.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser33.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser33.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '234' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser34.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser34.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser34.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser34.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser34.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '235' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser35.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser35.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser35.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser35.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser35.jl_Master where Account_Status='A' order by scheme_code,Account_No)a)k2)k where k.days>0 and k.days>="+Days+"";
	//		String query="select a1.*,(select Mobile_No from Customer where Customer_Id=a1.customer_id) as mobile_no from (select k.bname,k.sname,k.Account_no,k.customer_name,k.open_date,k.loan_amount, k.cb,k.days as pending_days,k.interest_paid_upto,k.overdue,k.total,k.odd,k.due_date,to_char(k.period_months|| 'M') as period,k.customer_Id from (select k2.*,(select branch_Name from branch_master where to_char(branch_code)=k2.branch) as bname,(select scheme_name from scheme_master where scheme_code=k2.scheme_code)as sname from (select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '201' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser1.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser1.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser1.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser1.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser1.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '202' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser2.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser2.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser2.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser2.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser2.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '203' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser3.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser3.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser3.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser3.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser3.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '204' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser4.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser4.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser4.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser4.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser4.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '205' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser5.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser5.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser5.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser5.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser5.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '206' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser6.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser6.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser6.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser6.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser6.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '207' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser7.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser7.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser7.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser7.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser7.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '208' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser8.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser8.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser8.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser8.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser8.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '209' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser9.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser9.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser9.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser9.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser9.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '210' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser10.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser10.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser10.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser10.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser10.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '211' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser11.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser11.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser11.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser11.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser11.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '212' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser12.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser12.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser12.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser12.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser12.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '213' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser13.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser13.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser13.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser13.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser13.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '214' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,user14.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,user14.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,user14.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,user14.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from user14.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '215' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser15.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser15.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser15.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser15.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser15.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '216' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser16.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser16.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser16.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser16.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser16.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '217' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser17.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser17.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser17.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser17.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser17.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '218' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser18.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser18.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser18.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser18.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser18.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '219' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser19.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser19.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser19.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser19.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser19.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '220' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser20.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser20.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser20.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser20.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser20.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '221' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser21.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser21.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser21.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser21.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser21.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '222' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser22.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser22.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser22.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser22.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser22.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '223' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser23.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser23.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser23.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser23.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser23.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '224' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser24.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser24.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser24.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser24.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser24.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '225' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser25.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser25.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser25.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser25.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser25.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '226' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser26.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser26.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser26.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser26.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser26.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '227' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser27.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser27.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser27.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser27.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser27.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '228' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser28.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser28.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser28.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser28.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser28.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '229' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser29.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser29.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser29.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser29.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser29.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '230' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser30.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser30.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser30.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser30.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser30.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '231' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser31.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser31.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser31.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser31.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser31.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '232' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser32.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser32.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser32.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser32.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser32.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '233' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser33.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser33.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser33.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser33.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser33.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '234' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser34.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser34.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser34.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser34.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser34.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '235' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser35.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser35.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser35.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser35.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser35.jl_Master where Account_Status='A' order by scheme_code,Account_No)a)k2)k where k.days>0 and k.days>="+Days+")a1";
			//System.out.println("query-----------"+query);
			
			//21-07-2022
			//case when JL_Master.scheme_code='60026' then to_char(Period_Months|| ' days') else to_char(Period_Months|| ' months') end
			//String query="select a1.*,(select Mobile_No from Customer_View where Customer_Id=a1.customer_id and rownum=1) as mobile_no from (select k.bname,k.sname,k.Account_no,k.customer_name,k.open_date,k.loan_amount, k.cb,k.days as pending_days,k.interest_paid_upto,k.overdue,k.total,k.odd,k.due_date,case when k.scheme_code in ('60026','60028') then  to_char(k.period_months|| 'D') else to_char(k.period_months|| 'M') end as period,k.customer_Id from (select k2.*,(select branch_Name from branch_master where to_char(branch_code)=k2.branch) as bname,(select scheme_name from scheme_master where scheme_code=k2.scheme_code)as sname from (select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '201' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser1.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser1.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser1.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser1.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser1.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '202' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser2.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser2.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser2.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser2.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser2.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '203' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser3.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser3.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser3.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser3.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser3.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '204' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser4.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser4.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser4.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser4.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser4.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '205' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser5.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser5.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser5.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser5.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser5.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '206' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser6.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser6.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser6.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser6.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser6.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '207' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser7.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser7.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser7.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser7.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser7.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '208' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser8.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser8.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser8.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser8.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser8.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '209' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser9.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser9.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser9.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser9.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser9.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '210' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser10.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser10.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser10.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser10.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser10.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '211' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser11.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser11.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser11.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser11.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser11.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '212' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser12.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser12.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser12.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser12.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser12.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '213' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser13.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser13.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser13.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser13.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser13.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '214' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,user14.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,user14.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,user14.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,user14.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from user14.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '215' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser15.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser15.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser15.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser15.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser15.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '216' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser16.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser16.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser16.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser16.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser16.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '217' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser17.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser17.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser17.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser17.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser17.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '218' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser18.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser18.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser18.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser18.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser18.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '219' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser19.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser19.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser19.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser19.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser19.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '220' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser20.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser20.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser20.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser20.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser20.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '221' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser21.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser21.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser21.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser21.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser21.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '222' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser22.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser22.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser22.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser22.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser22.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '223' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser23.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser23.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser23.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser23.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser23.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '224' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser24.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser24.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser24.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser24.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser24.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '225' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser25.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser25.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser25.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser25.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser25.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '226' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser26.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser26.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser26.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser26.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser26.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '227' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser27.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser27.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser27.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser27.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser27.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '228' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser28.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser28.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser28.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser28.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser28.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '229' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser29.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser29.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser29.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser29.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser29.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '230' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser30.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser30.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser30.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser30.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser30.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '231' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser31.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser31.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser31.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser31.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser31.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '232' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser32.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser32.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser32.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser32.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser32.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '233' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser33.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser33.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser33.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser33.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser33.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '234' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser34.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser34.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser34.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser34.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser34.jl_Master where Account_Status='A' order by scheme_code,Account_No)a union select a.*,case when a.oddays>0 then a.oddays else 0 end as odd from (select '235' as branch,Account_No,open_date,interest_rate,loan_amount,due_date,Scheme_Code,interest_paid_upto,(-1)*closing_balance as CB,Customer_name,customer_id,dbuser35.get_JL_Arrear_pro_Message(Account_No,'"+To_Date+"') as Msg,dbuser35.get_JL_Arrear_pro_totaldays(Account_No,'"+To_Date+"') as days,case when interest_paid_upto>due_date then to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto else to_date('"+To_Date+"','dd/MM/yyyy')-due_date end as oddays ,dbuser35.GET_JL_ARREAR_PRO_ODINTEREST(Account_No,'"+To_Date+"') as overdue ,dbuser35.GET_JL_ARREAR_PRO_TOTALINTEREST(Account_No,'"+To_Date+"') as total,period_months from dbuser35.jl_Master where Account_Status='A' order by scheme_code,Account_No)a)k2)k where k.days>0 and k.days>="+Days+")a1";
			//05.09.2023
			String query="Select b.BRANCH_NAME as BNAME,Scheme_Name as SNAME,a.Account_No,a.Customer_Name,a.Open_Date,Loan_Amount,NVL(e.Debit1,0)-NVL(d.Credit1,0) as CB,Floor(to_date('"+To_Date+"','dd/MM/yyyy')-a.INTEREST_PAID_UPTO) as Pending_Days,INTEREST_PAID_UPTO,case when Due_Date<'"+To_Date+"' then NVL(JL_Interest_Slab_New_Function_View(a.Account_No,'"+To_Date+"'),0) else 0 End as Overdue,NVL(JL_Interest_Slab_New_Function_View(a.Account_No,'"+To_Date+"'),0) as Total,case when Due_Date<'"+To_Date+"' then Floor(to_date('"+To_Date+"','dd/MM/yyyy')-Due_Date) else 0 End as ODD,Due_Date, case when Period_months>=60 then to_char(period_months|| 'D') else to_char(period_months|| 'M') End as Period, a.Customer_Id,MOBILE_NO from JL_Master_View a   left join BRANCH_MASTER b on a.BRANCH_CODE=b.BRANCH_CODE   left join dbuser1.Scheme_Master c on a.Scheme_Code=c.Scheme_Code   left join Customer_View c1 on a.Customer_Id=c1.Customer_Id and a.BRANCH_CODE=c1.BRANCH  left join (SELECT Account_No,SUM(TRANSACTION_AMOUNT) as CREDIT1 FROM DAILY_TRANSACTION_TABLE WHERE TRANSACTION_DATE <=TO_DATE('"+To_Date+"','dd/MM/yyyy') AND TRANSACTION_TYPE='Credit' and Flag='AC' group by Account_No) d on a.Account_No=d.Account_no left join (SELECT Account_No,SUM(TRANSACTION_AMOUNT) as DEBIT1 FROM DAILY_TRANSACTION_TABLE WHERE TRANSACTION_DATE <=TO_DATE('"+To_Date+"','dd/MM/yyyy') AND TRANSACTION_TYPE='Debit' and Flag='AC' group by Account_No) e on a.Account_No=e.Account_no   where NVL(e.Debit1,0)-NVL(d.Credit1,0)>0 and Floor(to_date('"+To_Date+"','dd/MM/yyyy')-a.INTEREST_PAID_UPTO) >= "+Days;
			System.out.println("query-----------"+query);
			
			return template.query(query,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
																					{  
			
																						SimpleBranch c=new SimpleBranch();
																						SimpleDateFormat sd=new SimpleDateFormat("dd-MM-yyyy");
																						c.setS2(rs.getString(1));//BRANCH_NAME
																						//System.out.println("rs.getString(1)------------------"+rs.getString(1));
																						c.setS3(rs.getString(2));//Scheme name
																						//System.out.println("rs.getString(2)------------------------"+rs.getString(2));
																						c.setS4(rs.getString(3));//Account no
																						//System.out.println("rs.getString(3)---------------------"+rs.getString(3));
																						c.setS5(rs.getString(4));//Customer name
																						//System.out.println("rs.getString(4)----------------------"+rs.getString(4));
																						//c.setS6(rs.getString(5));//open date
																						
																						System.out.println("1");
																						c.setS15(rs.getDate(5)); //open date
																						
																				//		System.out.println("rs.getDate(5)---------------------"+rs.getDate(5));
																					
																						
																						//c.setS6(sd.format(rs.getDate(5)));
																						//c.setS131(rs.getString(6)); // loan amount
																						System.out.println("2");
																						c.setS141(rs.getDouble(6)); //loan maount
																						
																						//System.out.println("rs.getString(6)---------------------"+rs.getString(6));
																						//c.setS32(rs.getString(7));//closing balance
																						System.out.println("3");
																						c.setS142(rs.getDouble(7)); // closing balance
																						
																						//System.out.println("rs.getString(7)-----------------------"+rs.getString(7));
																						//c.setS33(rs.getString(8)); // pending days
																						System.out.println("4");
																						c.setS11(rs.getInt(8)); // pending days
																						
																						
																						//System.out.println("rs.getString(8)----------------------"+rs.getString(8));
																						//c.setS34(rs.getString(9)); // interest paid aupto
																						//System.out.println("rs.getString(9)-------------------"+rs.getString(9));
																						//c.setS34(sd.format(rs.getDate(9)));
																						System.out.println("5");
																						c.setS16(rs.getDate(9)); // int paid upto
																						
																					//	System.out.println("rs.getDate(9)---------"+rs.getDate(9));
																						//c.setS35(rs.getString(10)); // arrear interest
																						System.out.println("6");
																						c.setS143(rs.getDouble(10)); //over due interest
																						
																						//System.out.println("rs.getString(10)------------------"+rs.getString(10));
																						//c.setS36(rs.getString(11));//total interest
																						System.out.println("7");
																						c.setS144(rs.getDouble(11)); // total interest
																						
																						//c.setS37(rs.getString(12));//oddays
																						System.out.println("8");
																						c.setS12(rs.getInt(12)); //oddays
																						
																						//c.setS38(rs.getString(13));//duedate
																						System.out.println("9");
																						c.setS25(rs.getDate(13)); // due date
																						
																						//System.out.println("rs.getDate(13)---------"+rs.getDate(13));
																						System.out.println("10");
																						c.setS39(rs.getString(14));//period
																						c.setS40(rs.getString(16));//mobile no
																						
																						c.setS38(rs.getString("Customer_Id")); //customer id
																						
																						return c;
																					}
			
		 																		 }     );
		}
		
	 public List<SimpleBranch>getDLArrearReport(String To_Date, int Days, int code)
		{
			//--Set Connection----------------------------
		 int j=Binfo;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			System.out.println("Inside dao---------------------------------------");
			
			String query="select (Select branch_name from branch_master where to_char(branch_code)=kk.branch) as bname,kk.Account_no,kk.customer_name,kk.open_date,kk.due_date,kk.loan_amount,kk.cb,kk.interest_paid_upto,kk.days1 as pending_days,kk.interest as arrear_interest from (select j.* from(select i.* from (select h.* from (select g.* from (select f.*,round(((f.CB*f.Days1*f.interest_rate)/36000))as Interest from (select e.*,(case when (to_date('"+To_Date+"','dd/MM/yyyy')-e.Interest_paid_upto)>0 then (to_date('"+To_Date+"','dd/MM/yyyy')-e.Interest_paid_upto) else 0 end) as Days1 from (select d.* from (select c.* from (select b.* from (select a.*,(Select DEPOSIT_NO from lien_Accounts where LOAN_NO=a.Account_no and Deposit_Status='A' and rownum=1)as Deposit_No from(select branch, Account_no,customer_id,customer_name,open_date,Loan_Amount,due_date,interest_rate,INTEREST_PAID_UPTO,((-1)*Closing_Balance)as CB from OL_MASTER_VIEW3 where Scheme_code='70010' and Account_status='A' and Due_Date>=to_date('"+To_Date+"','dd/MM/yyyy'))a)b)c )d )e)f)g )h)i)j)kk where kk.Days1>"+Days+" order by kk.branch,kk.account_no";
			System.out.println("query-----------"+query);
			return template.query("select (Select branch_name from branch_master where to_char(branch_code)=kk.branch) as bname,kk.Account_no,kk.customer_name,kk.open_date,kk.due_date,kk.loan_amount,kk.cb,kk.interest_paid_upto,kk.days1 as pending_days,kk.interest as arrear_interest from (select j.* from(select i.* from (select h.* from (select g.* from (select f.*,round(((f.CB*f.Days1*f.interest_rate)/36000))as Interest from (select e.*,(case when (to_date('"+To_Date+"','dd/MM/yyyy')-e.Interest_paid_upto)>0 then (to_date('"+To_Date+"','dd/MM/yyyy')-e.Interest_paid_upto) else 0 end) as Days1 from (select d.* from (select c.* from (select b.* from (select a.*,(Select DEPOSIT_NO from lien_Accounts where LOAN_NO=a.Account_no and Deposit_Status='A' and rownum=1)as Deposit_No from(select branch, Account_no,customer_id,customer_name,open_date,Loan_Amount,due_date,interest_rate,INTEREST_PAID_UPTO,((-1)*Closing_Balance)as CB from OL_MASTER_VIEW3 where Scheme_code='70010' and Account_status='A' and Due_Date>=to_date('"+To_Date+"','dd/MM/yyyy'))a)b)c )d )e)f)g )h)i)j)kk where kk.Days1>"+Days+" order by kk.branch,kk.account_no",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
																					{  
			
																						SimpleBranch c=new SimpleBranch();
																						SimpleDateFormat sd=new SimpleDateFormat("dd-MM-yyyy");
																						c.setS2(rs.getString(1));//BRANCH_NAME
																						c.setS3(rs.getString(2));//Account no																					
																						c.setS4(rs.getString(3));//		Customer name														
																						//c.setS5(rs.getString(4));//		open date
																						//c.setS5(sd.format(rs.getDate(4)));
																						
																						c.setS15(rs.getDate(4)); // open date
																						
																						//c.setS6(rs.getString(5));//			// due date												
																						//c.setS6(sd.format(rs.getDate(5)));
																						
																						c.setS16(rs.getDate(5)); // due date
																						
																						//c.setS131(rs.getString(6)); // loan amount	
																						
																						c.setS141(rs.getDouble(6)); // loan amount
																						
																						//c.setS32(rs.getString(7));//closing balance	
																						
																						c.setS142(rs.getDouble(7)); // closing balance
																						
																						if(rs.getString(8)=="")
																						{
																							//c.setS34(rs.getString(8)); // interest paid aupto
																							c.setS25(rs.getDate(8)); //interest paid aupto
																						}
																						else
																						{
																							//c.setS34(rs.getString(8)); // interest paid aupto															
																							//c.setS34(sd.format(rs.getDate(8)));	
																							c.setS25(rs.getDate(8)); //interest paid aupto	
																						}
																						
																						//c.setS33(rs.getString(9)); // pending days
																						c.setS11(rs.getInt(9)); // pending days
																						
																																								
																						//c.setS35(rs.getString(10)); // arrear interest	
																						c.setS143(rs.getDouble(10)); // arrear interest
																						
																						
																						return c;
																					}
		 																		 }     );
		}

	
	 

	 public List<SimpleBranch>getMLArrearReport(String To_Date,int Days, int code)
		{
			//--Set Connection----------------------------
		 int j=Binfo;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			System.out.println("Inside dao---------------------------------------");
			
	//		String query="select c.* from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,b.arrear_e,b.emi,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,(b.Total_Count-b.Total_Paid) as no_due_pending,b.Period from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period from (Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) -(select EMI from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1) as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid, Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='AC' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy')and NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0)- NVL(Int_Recd,0) > 0)a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between to_date('"+To_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending > "+Days+"";
			//System.out.println("query-----------"+query);
	
	//		String query="select c.* from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,b.arrear_e,b.emi,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,(b.Total_Count-b.Total_Paid) as no_due_pending,b.Period from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period from (Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) -(select EMI from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1) as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid, Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='AC' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy')and NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0)- NVL(Int_Recd,0) > 0)a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between to_date('"+To_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending > "+Days+""
	//		String query="select c.*  from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,b.arrear_e,b.emi,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,(b.Total_Count-b.Total_Paid) as no_due_pending,b.Period,b.cl from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period from (Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) -(select EMI from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1) as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid, Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='INT' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy')and NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0)- NVL(Int_Recd,0) > 0)a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between (to_date('"+To_Date+"','dd/MM/yyyy')-case when substr('"+To_Date+"',1,2) = '31' then 16 else 15 end) and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending > "+Days+"";
         
			//String query="select c.*,(select case when max(transaction_date) is null then 'NA' else to_char(max(transaction_date),'dd/MM/yyyy') end from daily_transaction_table where  flag='INT' and Account_no=c.Account_no group by Account_no) as last_Trans_date  from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,b.arrear_e,b.emi,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,(b.Total_Count-b.Total_Paid) as no_due_pending,b.Period ,b.c1 from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period from (Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) -(select EMI from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1) as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid, Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='AC' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy')and NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0)- NVL(Int_Recd,0) > 0)a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between (to_date('"+To_Date+"','dd/MM/yyyy')-case when substr('"+To_Date+"',1,2) = '31' then 16 else 15 end) and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending > "+Days+"";

			//27-0-2-2021
			 //String query="select c.*,(select case when max(transaction_date) is null then 'NA' else to_char(max(transaction_date),'dd/MM/yyyy') end from daily_transaction_table where  flag='INT' and Account_no=c.Account_no group by Account_no) as last_Trans_date  from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,b.arrear_e,b.emi,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,case when b.due_date >=to_date('"+To_Date+"','dd/MM/yyyy') then (b.Current_Count-b.Total_Paid) else (b.Total_Count-b.Total_Paid) end as no_due_pending,b.Period ,b.c1,b.Current_count,b.total_count from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period,a.Current_Count from (Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) -(select EMI from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1) as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid, Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and to_date<=to_date('"+To_Date+"','dd/MM/yyyy')) as current_count from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='AC' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy')and NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0)- NVL(Int_Recd,0) > 0)a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between (to_date('"+To_Date+"','dd/MM/yyyy')-case when substr('"+To_Date+"',1,2) = '31' then 16 else 15 end) and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending > "+Days+"";

			//03-03-2021
	//		 String query="select c.*,(select case when max(transaction_date) is null then 'NA' else to_char(max(transaction_date),'dd/MM/yyyy') end from daily_transaction_table where   Account_no=c.Account_no group by Account_no) as last_Trans_date  from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,b.arrear_e,b.emi,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,case when b.due_date >=to_date('"+To_Date+"','dd/MM/yyyy') then (b.Current_Count-b.Total_Paid) else (b.Total_Count-b.Total_Paid) end as no_due_pending,b.Period ,b.c1,b.Current_count,b.total_count from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period,a.Current_Count from (Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) -(select EMI from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1) as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid, Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and to_date<=to_date('"+To_Date+"','dd/MM/yyyy')) as current_count from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='AC' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy')and NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0)- NVL(Int_Recd,0) > 0)a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between to_date(to_char('01'||substr('"+To_Date+"',3)),'dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending > "+Days+"";

			 //19-03-2021
			 //String query="select c.*,(select case when max(transaction_date) is null then 'NA' else to_char(max(transaction_date),'dd/MM/yyyy') end from daily_transaction_table where   Account_no=c.Account_no group by Account_no) as last_Trans_date  from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,b.arrear_e,b.emi,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,case when b.due_date >=to_date('"+To_Date+"','dd/MM/yyyy') then (b.Current_Count-b.Total_Paid) else (b.Total_Count-b.Total_Paid) end as no_due_pending,b.Period ,b.c1,b.Current_count,b.total_count from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period,a.Current_Count from (Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) -(select EMI from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1) as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid, Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and to_date<=to_date('"+To_Date+"','dd/MM/yyyy')) as current_count from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='AC' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy')and NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0)- NVL(Int_Recd,0) > 0)a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between to_date(to_char('01'||substr('"+To_Date+"',3)),'dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and transaction_type='Credit' group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending > "+Days+"";

			//06-11-2021
	//		String query="select c.*,(select case when max(transaction_date) is null then 'NA' else to_char(max(transaction_date),'dd/MM/yyyy') end from daily_transaction_table where   Account_no=c.Account_no group by Account_no) as last_Trans_date  from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,b.arrear_e,case when b.arrear_e >0 then b.emi else 0 end as emi,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,case when b.due_date >=to_date('"+To_Date+"','dd/MM/yyyy') then (b.Current_Count-b.Total_Paid) else (b.Total_Count-b.Total_Paid) end as no_due_pending,b.Period ,b.c1,b.Current_count,b.total_count from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period,a.Current_Count from (Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) -(select EMI from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1) as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid, Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and to_date<=to_date('"+To_Date+"','dd/MM/yyyy')) as current_count from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='AC' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy')and NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0)- NVL(Int_Recd,0) > 0)a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between to_date(to_char('01'||substr('"+To_Date+"',3)),'dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and transaction_type='Credit' group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending > "+Days+"";

			//08-11-2021
	//		String query="select c.*,(select case when max(transaction_date) is null then 'NA' else to_char(max(transaction_date),'dd/MM/yyyy') end from daily_transaction_table where   Account_no=c.Account_no group by Account_no) as last_Trans_date  from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,(case when b.tot_emi<=0 then 0 else case when b.arrear_e>=b.emi then b.arrear_e- b.emi else 0 end  end ),(case when b.tot_emi<=0 then 0 else case when b.arrear_e>=b.emi then b.emi else 0 end  end ) ,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,case when b.due_date >=to_date('"+To_Date+"','dd/MM/yyyy') then (b.Current_Count-b.Total_Paid) else (b.Total_Count-b.Total_Paid) end as no_due_pending,b.Period ,b.c1,b.Current_count,b.total_count from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period,a.Current_Count from (Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0)  as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid, Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and to_date<=to_date('"+To_Date+"','dd/MM/yyyy')) as current_count from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='AC' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy'))a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between to_date(to_char('01'||substr('"+To_Date+"',3)),'dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and transaction_type='Credit' group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending >= "+Days+"";

			//12-11-2021
	//		String query="select mm.Account_no,mm.open_date,mm.customer_name,mm.mobile_no,mm.loan_amount,case when mm.due_date<to_date('"+To_Date+"','dd/MM/yyyy') then mm.tot_emi else mm.arrear_e end as arrear_e,case when mm.due_date<to_date('"+To_Date+"','dd/MM/yyyy') then 0 else mm.emi end as emi,mm.tot_emi,mm.interest_paid_upto,mm.total_paid,mm.bname,mm.due_date,mm.closing_balance,mm.interest_rate,no_due_pending,mm.period,mm.c1,mm.current_count,mm.total_count,to_date(mm.last_trans_date,'dd/MM/yyyy') as last_trans_date  from ( select c.*,(select case when max(transaction_date) is null then 'NA' else to_char(max(transaction_date),'dd/MM/yyyy') end from daily_transaction_table where Account_no=c.Account_no group by Account_no) as last_Trans_date from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,(case when b.tot_emi<=0 then 0 else case when b.arrear_e>=b.emi then b.arrear_e- b.emi else 0 end  end ) as arrear_e,(case when b.tot_emi<=0 then 0 else case when b.arrear_e>=b.emi then b.emi else 0 end  end ) as emi,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,case when b.due_date >=to_date('"+To_Date+"','dd/MM/yyyy') then (b.Current_Count-b.Total_Paid) else (b.Total_Count-b.Total_Paid) end as no_due_pending,b.Period ,b.c1,b.Current_count,b.total_count from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period,a.Current_Count from(Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid,Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and to_date<=to_date('"+To_Date+"','dd/MM/yyyy')) as current_count from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='AC' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy'))a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between to_date(to_char('01'||substr('"+To_Date+"',3)),'dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and transaction_type='Credit' group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending >= "+Days+")mm";
			
			//06-07-2023
			String query="select mm.Account_no,mm.open_date,mm.customer_name,mm.mobile_no,mm.loan_amount,case when mm.due_date<to_date('"+To_Date+"','dd/MM/yyyy') then mm.tot_emi else mm.arrear_e end as arrear_e,case when mm.due_date<to_date('"+To_Date+"','dd/MM/yyyy') then 0 else mm.emi end as emi,mm.tot_emi,mm.interest_paid_upto,mm.total_paid,mm.bname,mm.due_date,mm.closing_balance,mm.interest_rate,no_due_pending,mm.period,mm.c1,mm.current_count,mm.total_count,to_date(mm.last_trans_date,'dd/MM/yyyy') as last_trans_date  from ( select c.*,(select case when max(transaction_date) is null then 'NA' else to_char(max(transaction_date),'dd/MM/yyyy') end from daily_transaction_table where Account_no=c.Account_no group by Account_no) as last_Trans_date from(select b.Account_No, b.Open_Date,b.customer_name,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,b.Loan_Amount,(case when b.tot_emi<=0 then 0 else case when b.arrear_e>=b.emi then b.arrear_e- b.emi else 0 end  end ) as arrear_e,(case when b.tot_emi<=0 then 0 else case when b.arrear_e>=b.emi then b.emi else 0 end  end ) as emi,b.tot_emi,b.Interest_Paid_Upto,b.Total_Paid,(select branch_name from branch_master where to_char(branch_code)=b.branch) as bname,b.Due_date,b.Closing_Balance,b.Interest_Rate,case when b.due_date >=to_date('"+To_Date+"','dd/MM/yyyy') then (b.Current_Count-b.Total_Paid) else (b.Total_Count-b.Total_Paid) end as no_due_pending,b.Period ,b.c1,b.Current_count,b.total_count from (select a.branch,a. customer_name, a.Account_No,round(a.tot_emi/a.emi,3) as noofpendue ,a.total_due as arrear_e, a.emi,a.tot_emi,case when b.collected1 is null then 0 else  b.collected1 end as c1,a.Open_Date,a.Loan_Amount,a.Interest_Paid_Upto,a.Customer_Id,a.Total_Paid,a.Total_Due,a.Due_date,a.Closing_Balance,a.Interest_Rate,a.Total_Count,a.Period,a.Current_Count from(Select OL_MASTER_VIEW3.branch, OL_MASTER_VIEW3.Account_No,OL_MASTER_VIEW3.Customer_Id,OL_MASTER_VIEW3.Customer_Name,Open_Date, Loan_Amount, Due_date,(-1*Closing_Balance) as Closing_Balance,Interest_Paid_Upto,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0))as Prin_Due,NVL(Interest,0) - NVL(Int_Recd,0) as Int_Due, NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0) + NVL(Interest,0) - NVL(Int_Recd,0)) as Arrear_emi,0.0 as Penal_Due,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0) - NVL(Int_Recd,0) as Total_Due,ADD_MONTHS(Open_Date,(Months_Between(to_date('"+To_Date+"','dd/MM/yyyy'),Open_Date))) as Inst_Due_Date,(select EMI from emi_view where Account_no=OL_MASTER_VIEW3.Account_no and rownum=1)as EMI,NVL(Prin,0) - (NVL(Pr_Recd,0) - NVL(Int_Recd,0)) +NVL(Interest,0)+NVL(Pen_Recd,0) - NVL(Int_Recd,0) as Tot_emi,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no) AS Total_Count,(Select count(*) from EMI_VIEW where status='Paid' and Account_no=OL_MASTER_VIEW3.Account_no) as Total_Paid,Interest_Rate, case when OL_MASTER_VIEW3.Period_Months=0 or OL_MASTER_VIEW3.Period_Months is null then (OL_MASTER_VIEW3.Period_Days || ' D') else (OL_MASTER_VIEW3.Period_Months || ' M') end as Period,(Select max(Reference_id) from EMI_VIEW where Account_no=OL_MASTER_VIEW3.Account_no and to_date<=to_date('"+To_Date+"','dd/MM/yyyy')) as current_count from OL_MASTER_VIEW3 left join (Select Account_No,sum(Interest) as Interest from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e1 on OL_MASTER_VIEW3.Account_No = e1.Account_No left join (Select Account_No,sum(Principal) as Prin from EMI_VIEW where To_Date<=to_date('"+To_Date+"','dd/MM/yyyy') group by Account_No) e on OL_MASTER_VIEW3.Account_No = e.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pr_Recd from Daily_Transaction_table where Transaction_Type='Credit' and Flag='AC' group by Account_No) t on OL_MASTER_VIEW3.Account_No = t.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Pen_Recd from Daily_Transaction_table where Transaction_Type='Debit' and Flag='PEN' group by Account_No) tp on OL_MASTER_VIEW3.Account_No = tp.Account_No left join (Select Account_No,case when sum(Transaction_Amount) is NULL then 0 else sum(Transaction_Amount) End as Int_Recd from Daily_Transaction_table where Flag='INT' group by Account_No) t1 on OL_MASTER_VIEW3.Account_No = t1.Account_No where Scheme_Code=80001 and Account_Status='A' and Open_Date<to_date('"+To_Date+"','dd/MM/yyyy'))a left join (select Account_no,case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from daily_transaction_table where transaction_date between to_date(to_char('01'||substr('"+To_Date+"',3)),'dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and transaction_type='Credit' group by Account_no ) b on a.account_no=b.account_no order by a.branch,a.account_no)b)c where c.No_due_pending >= "+Days+")mm";
			
			System.out.println(query);
			
			return template.query(query,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
																					{  
			
																						SimpleBranch c=new SimpleBranch();
																						SimpleDateFormat sd=new SimpleDateFormat("dd-MM-yyyy");
																						
																						c.setS2(rs.getString(1));//Account no	
																						//c.setS3(rs.getString(2));//open date	
																						//c.setS3(sd.format(rs.getDate(2)));
																						c.setS15(rs.getDate(2)); // open date
																						
																						c.setS4(rs.getString(3));//	cust name														
																						c.setS5(rs.getString(4));//		mob no
																						
																						//c.setS6(rs.getString(5));//			// loan amount	
																						c.setS141(rs.getDouble(5)); //loan amount
																					
																						//c.setS131(rs.getString(6)); // arrear emi	
																						c.setS145(rs.getDouble(6)); // arrear emi
																						
																						//c.setS32(rs.getString(7));//current emi
																						c.setS146(rs.getDouble(7)); // current emi
																						
																						//c.setS34(rs.getString(8)); // total due
																						c.setS147(rs.getDouble(8)); //total due
																						
																						//c.setS31(rs.getString(9)); //due paid date
																						//c.setS31(sd.format(rs.getDate(9)));
																						c.setS16(rs.getDate(9)); //due paid date
																						
																						//c.setS33(rs.getString(10));//paid count
																						
																						c.setS11(rs.getInt(10)); //paid count
																						
																						c.setS35(rs.getString(11));// branch
																						//c.setS36(rs.getString(12)); //due date
																						//c.setS36(sd.format(rs.getDate(12)));
																						
																						c.setS25(rs.getDate(12)); //due date
																						
																						//c.setS37(rs.getString(13)); //closing balance
																						c.setS142(rs.getDouble(13)); //closing balance
																						
																						//c.setS38(rs.getString(14)); //interest rate
																						c.setS13(rs.getFloat(14)); //interest rate
																						//c.setS39(rs.getString(15)); //pending due
																						c.setS12(rs.getInt(15)); //pending due
																						
																						
																						c.setS40(rs.getString(16)); //period
																						//c.setS132(rs.getString(17)); //paid
																						c.setS144(rs.getDouble(17)); //paid
																					//new
																						//c.setS133(rs.getString(20)); //Last transdate
																						c.setS26(rs.getDate(20)); // last trasn date

																						
																						
																						
																							
																							
																						
																						
																						return c;
																					}
		 																		 }     );
		}
	 
	 
	
	 
	 public List<SimpleBranch>getSLArrearReport(String To_Date, int code)
		{
			//--Set Connection----------------------------
		 int j=Binfo;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			System.out.println("Inside dao---------------------------------------");
			
	//		String query="select a.Account_No,a.Open_Date,a.Customer_Name,a.Mobile_No,((-1)*a.Sanction_Limit)as Sanction_Limit,((-1)*a.Outstanding)as CB,a.Last_Transaction_Date,a.collected,a.bname,((-1)*a.Bal_As_On) as Bal_As_On,a.Due_Date from(select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser1.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser1.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from (Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser1.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser1.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser1.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser2.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser2.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser2.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser2.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser2.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser3.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser3.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser3.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser3.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser3.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser4.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser4.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser4.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser4.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser4.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser5.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser5.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser5.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser5.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser5.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser7.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser7.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser7.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser7.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser7.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser8.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser8.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser8.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser8.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser8.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser9.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser9.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser9.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser9.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser9.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser10.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser10.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser10.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser10.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser10.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser11.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser11.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser11.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser11.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser11.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser12.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser12.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser12.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser12.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser12.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser13.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser13.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser13.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser13.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser13.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from user14.daily_transaction where transaction_date = (select Last_Transaction_Date from user14.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,user14.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,user14.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from user14.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser15.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser15.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser15.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser15.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser15.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser16.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser16.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser16.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser16.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser16.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser17.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser17.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser17.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser17.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser17.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser18.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser18.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser18.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser18.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser18.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser19.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser19.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser19.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser19.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser19.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser20.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser20.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser20.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser20.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser20.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser21.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser21.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser21.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser21.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser21.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser22.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser22.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser22.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser22.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser22.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser23.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser23.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser23.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser23.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser23.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser24.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser24.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser24.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser24.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser24.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser25.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser25.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser25.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser25.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser25.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser26.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser26.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser26.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser26.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser26.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser27.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser27.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser27.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser27.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser27.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser28.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser28.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser28.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser28.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser28.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser29.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser29.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser29.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser29.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser29.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser30.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser30.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser30.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser30.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser30.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser31.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser31.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser31.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser31.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser31.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser32.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser32.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser32.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser32.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser32.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser33.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser32.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser33.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser33.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser33.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b) a order by a.Branch_Code,a.Account_No";
	//		String query="select a.Account_No,a.Open_Date,a.Customer_Name,a.Mobile_No,((-1)*a.Sanction_Limit)as Sanction_Limit,((-1)*a.Outstanding)as CB,a.Last_Transaction_Date,a.collected,a.bname,((-1)*a.Bal_As_On) as Bal_As_On,a.Due_Date from(select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser1.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser1.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from (Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser1.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser1.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser1.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser2.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser2.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser2.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser2.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser2.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser3.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser3.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser3.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser3.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser3.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser4.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser4.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser4.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser4.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser4.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser5.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser5.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser5.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser5.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser5.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser7.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser7.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser7.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser7.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser7.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser8.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser8.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser8.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser8.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser8.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser9.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser9.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser9.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser9.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser9.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser10.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser10.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser10.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser10.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser10.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser11.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser11.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser11.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser11.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser11.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser12.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser12.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser12.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser12.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser12.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser13.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser13.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser13.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser13.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser13.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from user14.daily_transaction where transaction_date = (select Last_Transaction_Date from user14.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,user14.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,user14.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from user14.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser15.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser15.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser15.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser15.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser15.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser16.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser16.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser16.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser16.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser16.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser17.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser17.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser17.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser17.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser17.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser18.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser18.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser18.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser18.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser18.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser19.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser19.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser19.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser19.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser19.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser20.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser20.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser20.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser20.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser20.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser21.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser21.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser21.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser21.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser21.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser22.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser22.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser22.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser22.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser22.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser23.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser23.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser23.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser23.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser23.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser24.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser24.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser24.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser24.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser24.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser25.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser25.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser25.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser25.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser25.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser26.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser26.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser26.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser26.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser26.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser27.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser27.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser27.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser27.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser27.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser28.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser28.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser28.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser28.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser28.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser29.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser29.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser29.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser29.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser29.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser30.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser30.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser30.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser30.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser30.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser31.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser31.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser31.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser31.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser31.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser32.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser32.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser32.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser32.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser32.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser33.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser32.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser33.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser33.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser33.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b) a order by a.Branch_Code,a.Account_No";
	//		String query="select main_qry.Account_no,main_qry.open_date,main_qry.customer_name,main_qry.mobile_no,main_qry.sanction_limit,main_qry.cb,main_qry.last_transaction_date,main_qry.collected,main_qry.bname,main_qry.bal_as_on,case when main_qry.duedate1 is null then 'NA' else to_char(main_qry.duedate1,'dd/MM/yyyy') end as duedate2,main_qry.due_date from (select a.Account_No,a.Open_Date,a.Customer_Name,a.Mobile_No,((-1)*a.Sanction_Limit)as Sanction_Limit,((-1)*a.Outstanding)as CB,a.Last_Transaction_Date,a.collected,a.bname,((-1)*a.Bal_As_On) as Bal_As_On,(select Max(transaction_date) from daily_transaction_table where Account_no=a.Account_no and transaction_type='Credit' group by account_no)as duedate1,a.due_date from(select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser1.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser1.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from (Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser1.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser1.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser1.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser2.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser2.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser2.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser2.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser2.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser3.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser3.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser3.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser3.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser3.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser4.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser4.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser4.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser4.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser4.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser5.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser5.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser5.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser5.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser5.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser7.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser7.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser7.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser7.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser7.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser8.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser8.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser8.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser8.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser8.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser9.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser9.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser9.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser9.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser9.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser10.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser10.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser10.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser10.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser10.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser11.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser11.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser11.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser11.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser11.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser12.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser12.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser12.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser12.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser12.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser13.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser13.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser13.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser13.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser13.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from user14.daily_transaction where transaction_date = (select Last_Transaction_Date from user14.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,user14.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,user14.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from user14.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser15.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser15.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser15.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser15.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser15.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser16.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser16.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser16.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser16.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser16.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser17.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser17.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser17.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser17.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser17.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser18.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser18.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser18.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser18.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser18.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser19.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser19.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser19.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser19.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser19.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser20.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser20.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser20.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser20.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser20.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser21.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser21.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser21.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser21.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser21.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser22.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser22.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser22.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser22.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser22.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser23.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser23.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser23.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser23.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser23.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser24.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser24.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser24.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser24.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser24.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser25.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser25.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser25.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser25.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser25.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser26.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser26.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser26.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser26.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser26.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser27.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser27.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser27.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser27.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser27.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser28.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser28.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser28.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser28.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser28.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser29.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser29.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser29.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser29.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser29.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser30.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser30.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser30.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser30.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser30.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser31.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser31.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser31.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser31.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser31.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser32.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser32.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser32.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser32.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser32.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser33.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser32.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser33.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser33.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser33.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser34.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser34.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser34.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser34.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser34.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser35.daily_transaction where transaction_date = (select Last_Transaction_Date from dbuser35.cc_master where Account_No=b.account_no and rownum=1) and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser35.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser35.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser35.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b) a order by a.Branch_Code,a.Account_No)main_qry";
	//25-02-2021
//			String query="select main_qry.Account_no,main_qry.open_date,main_qry.customer_name,main_qry.mobile_no,main_qry.sanction_limit,main_qry.cb,main_qry.last_transaction_date,main_qry.collected,main_qry.bname,main_qry.bal_as_on,case when main_qry.duedate1 is null then 'NA' else to_char(main_qry.duedate1,'dd/MM/yyyy') end as duedate2,main_qry.due_date from (select a.Account_No,a.Open_Date,a.Customer_Name,a.Mobile_No,((-1)*a.Sanction_Limit)as Sanction_Limit,((-1)*a.Outstanding)as CB,a.Last_Transaction_Date,a.collected,a.bname,((-1)*a.Bal_As_On) as Bal_As_On,(select Max(transaction_date) from daily_transaction_table where Account_no=a.Account_no and transaction_type='Credit' group by account_no)as duedate1,a.due_date from(select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser1.daily_transaction where transaction_date between (select open_date from dbuser1.cc_master where Account_No=b.account_no and rownum=1)and to_date('"+To_Date+"','dd/MM/yyyy')  and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from (Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser1.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser1.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser1.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser2.daily_transaction where transaction_date  between (select open_date from dbuser2.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser2.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser2.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser2.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser3.daily_transaction where transaction_date  between (select open_date from dbuser3.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser3.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser3.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser3.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser4.daily_transaction where transaction_date  between (select open_date from dbuser4.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser4.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser4.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser4.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser5.daily_transaction where transaction_date  between (select open_date from dbuser5.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser5.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser5.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser5.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser7.daily_transaction where transaction_date  between (select open_date from dbuser7.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser7.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser7.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser7.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser8.daily_transaction where transaction_date  between (select open_date from dbuser8.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser8.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser8.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser8.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser9.daily_transaction where transaction_date  between (select open_date from dbuser9.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser9.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser9.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser9.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser10.daily_transaction where transaction_date  between (select open_date from dbuser10.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser10.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser10.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser10.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser11.daily_transaction where transaction_date  between (select open_date from dbuser11.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser11.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser11.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser11.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser12.daily_transaction where transaction_date  between (select open_date from dbuser12.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser12.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser12.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser12.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser13.daily_transaction where transaction_date  between (select open_date from dbuser13.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser13.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser13.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser13.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from user14.daily_transaction where transaction_date  between (select open_date from user14.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,user14.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,user14.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from user14.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser15.daily_transaction where transaction_date  between (select open_date from dbuser15.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser15.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser15.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser15.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser16.daily_transaction where transaction_date  between (select open_date from dbuser16.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser16.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser16.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser16.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser17.daily_transaction where transaction_date  between (select open_date from dbuser17.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser17.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser17.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser17.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser18.daily_transaction where transaction_date  between (select open_date from dbuser18.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser18.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser18.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser18.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser19.daily_transaction where transaction_date  between (select open_date from dbuser19.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser19.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser19.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser19.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser20.daily_transaction where transaction_date  between (select open_date from dbuser20.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser20.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser20.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser20.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser21.daily_transaction where transaction_date  between (select open_date from dbuser21.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser21.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser21.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser21.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser22.daily_transaction where transaction_date  between (select open_date from dbuser22.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser22.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser22.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser22.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser23.daily_transaction where transaction_date  between (select open_date from dbuser23.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser23.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser23.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser23.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser24.daily_transaction where transaction_date  between (select open_date from dbuser24.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser24.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser24.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser24.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser25.daily_transaction where transaction_date  between (select open_date from dbuser25.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser25.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser25.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser25.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser26.daily_transaction where transaction_date  between (select open_date from dbuser26.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser26.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser26.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser26.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser27.daily_transaction where transaction_date  between (select open_date from dbuser27.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser27.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser27.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser27.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser28.daily_transaction where transaction_date  between (select open_date from dbuser28.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser28.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser28.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser28.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser29.daily_transaction where transaction_date  between (select open_date from dbuser29.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser29.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser29.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser29.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser30.daily_transaction where transaction_date  between (select open_date from dbuser30.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser30.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser30.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser30.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser31.daily_transaction where transaction_date  between (select open_date from dbuser31.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser31.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser31.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser31.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser32.daily_transaction where transaction_date  between (select open_date from dbuser32.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser32.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser32.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser32.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser33.daily_transaction where transaction_date  between (select open_date from dbuser32.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser33.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser33.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser33.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser34.daily_transaction where transaction_date  between (select open_date from dbuser34.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser34.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser34.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser34.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser35.daily_transaction where transaction_date  between (select open_date from dbuser35.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no group by Account_no) as collected from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser35.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser35.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date from dbuser35.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b) a order by a.Branch_Code,a.Account_No)main_qry";
			String query="";
			if(con.GetCompSName().equalsIgnoreCase("SNNL"))
			//29-09-2021
			 query="select b1.Account_no,b1.open_date,b1.customer_name,b1.mobile_no,b1.sanction_limit,b1.cb,b1.last_transaction_date,b1.collected,b1.bname,b1.bal_as_on,b1.duedate2,b1.Due_date,b1.int1,b1.final_os,b1.lastintposted from (select main_qry.Account_no,main_qry.open_date,main_qry.customer_name,main_qry.mobile_no,main_qry.sanction_limit,main_qry.cb,main_qry.last_transaction_date,main_qry.collected,main_qry.bname,main_qry.bal_as_on,case when main_qry.duedate1 is null then main_qry.Open_Date else main_qry.duedate1 end as duedate2,main_qry.due_date,main_qry.int1,(main_qry.cb+main_qry.int1) as final_os,main_qry.lastintposted from (select a.Account_No,a.Open_Date,a.Customer_Name,a.Mobile_No,((-1)*a.Sanction_Limit)as Sanction_Limit,((-1)*a.Outstanding)as CB,a.Last_Transaction_Date,a.collected,a.bname,((-1)*a.Bal_As_On) as Bal_As_On,(select Max(transaction_date) from daily_transaction_table where Account_no=a.Account_no and transaction_type='Credit' group by account_no)as duedate1,a.due_date,a.int1,a.lastintposted from(select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser1.daily_transaction where transaction_date between (select open_date from dbuser1.cc_master where Account_No=b.account_no and rownum=1)and to_date('"+To_Date+"','dd/MM/yyyy')  and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser1.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser1.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from (Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser1.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser1.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser1.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser2.daily_transaction where transaction_date  between (select open_date from dbuser2.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser2.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser2.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser2.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser2.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser2.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser3.daily_transaction where transaction_date  between (select open_date from dbuser3.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser3.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser3.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser3.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser3.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser3.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser4.daily_transaction where transaction_date  between (select open_date from dbuser4.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser4.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser4.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser4.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser4.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser4.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser5.daily_transaction where transaction_date  between (select open_date from dbuser5.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser5.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser5.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser5.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser5.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser5.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser7.daily_transaction where transaction_date  between (select open_date from dbuser7.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser7.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser7.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser7.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser7.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser7.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser8.daily_transaction where transaction_date  between (select open_date from dbuser8.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser8.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser8.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser8.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser8.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser8.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser9.daily_transaction where transaction_date  between (select open_date from dbuser9.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser9.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser9.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser9.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser9.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser9.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser10.daily_transaction where transaction_date  between (select open_date from dbuser10.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser10.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser10.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser10.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser10.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser10.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser11.daily_transaction where transaction_date  between (select open_date from dbuser11.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser11.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser11.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser11.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser11.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser11.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser12.daily_transaction where transaction_date  between (select open_date from dbuser12.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser12.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser12.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser12.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser12.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser12.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser13.daily_transaction where transaction_date  between (select open_date from dbuser13.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser13.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser13.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser13.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser13.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser13.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from user14.daily_transaction where transaction_date  between (select open_date from user14.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from user14.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( user14.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,user14.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,user14.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from user14.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser15.daily_transaction where transaction_date  between (select open_date from dbuser15.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser15.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser15.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser15.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser15.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser15.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser16.daily_transaction where transaction_date  between (select open_date from dbuser16.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser16.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser16.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser16.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser16.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser16.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser17.daily_transaction where transaction_date  between (select open_date from dbuser17.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser17.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser17.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser17.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser17.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser17.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser18.daily_transaction where transaction_date  between (select open_date from dbuser18.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser18.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser18.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser18.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser18.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser18.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser19.daily_transaction where transaction_date  between (select open_date from dbuser19.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser19.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser19.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser19.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser19.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser19.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser20.daily_transaction where transaction_date  between (select open_date from dbuser20.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser20.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser20.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser20.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser20.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser20.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser21.daily_transaction where transaction_date  between (select open_date from dbuser21.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser21.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser21.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser21.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser21.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser21.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser22.daily_transaction where transaction_date  between (select open_date from dbuser22.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser22.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser22.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser22.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser22.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser22.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser23.daily_transaction where transaction_date  between (select open_date from dbuser23.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser23.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser23.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser23.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser23.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser23.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser24.daily_transaction where transaction_date  between (select open_date from dbuser24.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser24.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser24.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser24.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser24.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser24.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser25.daily_transaction where transaction_date  between (select open_date from dbuser25.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser25.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser25.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser25.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser25.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser25.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser26.daily_transaction where transaction_date  between (select open_date from dbuser26.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser26.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser26.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser26.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser26.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser26.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser27.daily_transaction where transaction_date  between (select open_date from dbuser27.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser27.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser27.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser27.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser27.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser27.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser28.daily_transaction where transaction_date  between (select open_date from dbuser28.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser28.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser28.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser28.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser28.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser28.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser29.daily_transaction where transaction_date  between (select open_date from dbuser29.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser29.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser29.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser29.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser29.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser29.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser30.daily_transaction where transaction_date  between (select open_date from dbuser30.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser30.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser30.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser30.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser30.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser30.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser31.daily_transaction where transaction_date  between (select open_date from dbuser31.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser31.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser31.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser31.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser31.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser31.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser32.daily_transaction where transaction_date  between (select open_date from dbuser32.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser32.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser32.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser32.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser32.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser32.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser33.daily_transaction where transaction_date  between (select open_date from dbuser32.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser33.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser33.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser33.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser33.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser33.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser34.daily_transaction where transaction_date  between (select open_date from dbuser34.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser34.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser34.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser34.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser34.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser34.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser35.daily_transaction where transaction_date  between (select open_date from dbuser35.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser35.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser35.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser35.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser35.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser35.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser36.daily_transaction where transaction_date  between (select open_date from dbuser36.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser36.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser36.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser36.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser36.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser36.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b union select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser37.daily_transaction where transaction_date  between (select open_date from dbuser37.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser37.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser37.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser37.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser37.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,CC_Master.Due_Date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser37.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b ) a order by a.Branch_Code,a.Account_No)main_qry)b1";
			else
				query="select b1.Account_no,b1.open_date,b1.customer_name,b1.mobile_no,b1.sanction_limit,b1.cb,b1.last_transaction_date,b1.collected,b1.bname,b1.bal_as_on,b1.duedate2,b1.Due_date,b1.int1,b1.final_os,b1.lastintposted from (select main_qry.Account_no,main_qry.open_date,main_qry.customer_name,main_qry.mobile_no,main_qry.sanction_limit,main_qry.cb,main_qry.last_transaction_date,main_qry.collected,main_qry.bname,main_qry.bal_as_on,case when main_qry.duedate1 is null then main_qry.Open_Date else main_qry.duedate1 end as duedate2,main_qry.due_date,main_qry.int1,(main_qry.cb+main_qry.int1) as final_os,main_qry.lastintposted from (select a.Account_No,a.Open_Date,a.Customer_Name,a.Mobile_No,((-1)*a.Sanction_Limit)as Sanction_Limit,((-1)*a.Outstanding)as CB,a.Last_Transaction_Date,a.collected,a.bname,((-1)*a.Bal_As_On) as Bal_As_On,(select Max(transaction_date) from daily_transaction_table where Account_no=a.Account_no and transaction_type='Credit' group by account_no)as duedate1,a.due_date,a.int1,a.lastintposted from(select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser1.daily_transaction where transaction_date between (select open_date from dbuser1.cc_master where Account_No=b.account_no and rownum=1)and to_date('"+To_Date+"','dd/MM/yyyy')  and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser1.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser1.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from (Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser1.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser1.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser1.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b  union  select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser2.daily_transaction where transaction_date  between (select open_date from dbuser2.cc_master where Account_No=b.account_no and rownum=1) and to_date('"+To_Date+"','dd/MM/yyyy') and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser2.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser2.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from ( Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser2.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser2.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser2.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b      ) a order by a.Branch_Code,a.Account_No)main_qry)b1";

			//29-09-2021 UAT
			//String query="select main_qry.Account_no,main_qry.open_date,main_qry.customer_name,main_qry.mobile_no,main_qry.sanction_limit,main_qry.cb,main_qry.last_transaction_date,main_qry.collected,main_qry.bname,main_qry.bal_as_on,case when main_qry.duedate1 is null then 'NA' else to_char(main_qry.duedate1,'dd/MM/yyyy') end as duedate2,main_qry.due_date,main_qry.int1,(main_qry.cb+main_qry.int1) as final_os,main_qry.lastintposted from (select a.Account_No,a.Open_Date,a.Customer_Name,a.Mobile_No,((-1)*a.Sanction_Limit)as Sanction_Limit,((-1)*a.Outstanding)as CB,a.Last_Transaction_Date,a.collected,a.bname,((-1)*a.Bal_As_On) as Bal_As_On,(select Max(transaction_date) from daily_transaction_table where Account_no=a.Account_no and transaction_type='Credit' group by account_no)as duedate1,a.due_date,a.int1,a.lastintposted from(select b.*,(select branch_name from branch_master where to_char(branch_code)=b.Branch_Code) as bname,(select Mobile_No from customer_view where Customer_Id=b.Customer_Id and rownum=1) as Mobile_No,(select case when sum(transaction_amount)is null then 0 else sum(transaction_amount) end as collected1 from dbuser1.daily_transaction where transaction_date between (select open_date from dbuser1.cc_master where Account_No=b.account_no and rownum=1)and to_date('"+To_Date+"','dd/MM/yyyy')  and Account_No=b.account_no and transaction_type='Credit' group by Account_no) as collected ,(select TRANSACTION_AMOUNT from(select transaction_amount from dbuser1.daily_transaction where Account_no=b.Account_no and transaction_type='Debit' and flag='INT'  order by transaction_date desc) where rownum=1) as lastIntPosted,round(abs( dbuser1.ccproductf(b.Account_no,to_char(b.LAST_INT_APPLIED_DATE,'dd/MM/yyyy'),to_char(to_date('"+To_Date+"','dd/MM/yyyy')+1,'dd/MM/yyyy')))*b.interest_rate/36500) as int1 from (Select CC_Master.Branch_Code,CC_Master.Account_No,CC_Master.Customer_Id,CC_Master.Customer_Name,dbuser1.Get_Outstanding_Balance( CC_Master.Account_No,'"+To_Date+"') as Outstanding,CC_Master.Open_Date,CC_Master.Sanction_Limit,CC_Master.Last_Transaction_Date,dbuser1.GET_ACC_BALANCECC( CC_Master.Account_No,'"+To_Date+"') as Bal_As_On,cc_master.due_date,CC_Master.interest_rate ,CC_MAster.LAST_INT_APPLIED_DATE from dbuser1.CC_Master,dual where CC_Master.Open_Date<= TO_DATE('"+To_Date+"','dd/MM/yyyy') and Account_Status='A' order by Account_No desc)b  ) a order by a.Branch_Code,a.Account_No)main_qry";

			System.out.println("query-----------"+query);
			return template.query(query,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
																					{  
			
																						SimpleBranch c=new SimpleBranch();
																						SimpleDateFormat sd=new SimpleDateFormat("dd-MM-yyyy");
																						c.setS2(rs.getString(1));//Account no	
																						//c.setS131(rs.getString(2)); // Open date	
																						//c.setS131(sd.format(rs.getDate(2)));
																						System.out.println("rs.getDate(2)------"+rs.getDate(2));
																						c.setS15(rs.getDate(2)); //open date
																						
																						System.out.println("rs.getString(3)----"+rs.getString(3));
																						c.setS3(rs.getString(3));//Customer name	
																						
																						System.out.println("rs.getString(4)-----"+rs.getString(4));
																						c.setS4(rs.getString(4));//mobile no
																						
																						System.out.println("rs.getDouble(5)----"+rs.getDouble(5));
																						//c.setS5(rs.getString(5));//sanction limit
																						c.setS141(rs.getDouble(5)); //sanction limit
																						
																						System.out.println("rs.getDouble(6)------"+rs.getDouble(6));
																						//c.setS6(rs.getString(6));//closing balance
																						c.setS142(rs.getDouble(6)); //closing balance
																						
																						//c.setS132(rs.getString(11)); // due date	
																						
																						//c.setS132(sd.format(rs.getDate(7)));
																						System.out.println("rs.getDate(11)------"+rs.getDate(11));
																						c.setS16(rs.getDate(11));// due date
																						
																						//c.setS31(rs.getString(8)); // paid amount
																						System.out.println("rs.getDouble(8)------"+rs.getDouble(8));
																						c.setS143(rs.getDouble(8)); // paid amount
																						
																						System.out.println("rs.getString(9)----"+rs.getString(9));
																						c.setS32(rs.getString(9));// branch name
																						
																						System.out.println("rs.getDouble(10)----"+rs.getDouble(10));
																						//c.setS33(rs.getString(10));// bal as on
																						c.setS144(rs.getDouble(10));
																						
																						//c.setS34(rs.getString(11));// due date
																						//c.setS34(sd.format(rs.getDate(12)));
																						System.out.println("rs.getDate(12)-------"+rs.getDate(12));
																						c.setS25(rs.getDate(12)); // due date
																						
																						System.out.println("rs.getDouble(13)----"+rs.getDouble(13));
																						//c.setS37(rs.getString(13)); // int
																						c.setS145(rs.getDouble(13)); //int
																						
																						System.out.println("rs.getDouble(14)----"+rs.getDouble(14));
																						//c.setS38(rs.getString(14));// Total os
																						c.setS146(rs.getDouble(14)); // total os
																						
																						System.out.println("rs.getDouble(15)----"+rs.getDouble(15));
																						//c.setS36(rs.getString(15));//int posted
																						c.setS147(rs.getDouble(15)); // int posted

																						return c;
																					}
		 																		 }     );
		}

	 
	 public List<SimpleBranch>getRLArrearReport(String To_Date, int code)
		{
			//--Set Connection----------------------------
		 int j=Binfo;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			System.out.println("Inside dao---------------------------------------");
			
			
			String query="";
			if(con.GetCompSName().equalsIgnoreCase("SNNL"))
			
				query="select (select branch_name from branch_master where to_char(branch_code)=k.branch) as bname,k.Account_no,k.customer_name,k.open_date,k.due_date,k.loan_amount,abs(k.osbalance),k.pending_days,k.interest_paid_upto,k.pending_Interest  from ( select '201' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser1.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser1.RL_Master where Account_status='A')a union select '202' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser2.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser2.RL_Master where Account_status='A')a union select '203' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser3.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser3.RL_Master where Account_status='A')a union select '204' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser4.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser4.RL_Master where Account_status='A')a union select '205' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser5.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser5.RL_Master where Account_status='A')a union select '206' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser6.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser6.RL_Master where Account_status='A')a union select '207' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser7.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser7.RL_Master where Account_status='A')a union select '208' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser8.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser8.RL_Master where Account_status='A')a union select '209' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser9.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser9.RL_Master where Account_status='A')a union select '210' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser10.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser10.RL_Master where Account_status='A')a union select '211' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser11.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser11.RL_Master where Account_status='A')a union select '212' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser12.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser12.RL_Master where Account_status='A')a union select '213' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser13.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser13.RL_Master where Account_status='A')a union select '214' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,user14.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from user14.RL_Master where Account_status='A')a union select '215' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser15.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser15.RL_Master where Account_status='A')a union select '216' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser16.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser16.RL_Master where Account_status='A')a union select '217' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser17.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser17.RL_Master where Account_status='A')a union select '218' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser18.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser18.RL_Master where Account_status='A')a union select '219' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser19.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser19.RL_Master where Account_status='A')a union select '220' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser20.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser20.RL_Master where Account_status='A')a union select '221' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser21.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser21.RL_Master where Account_status='A')a union select '222' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser22.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser22.RL_Master where Account_status='A')a union select '223' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser23.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser23.RL_Master where Account_status='A')a union select '224' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser24.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser24.RL_Master where Account_status='A')a union select '225' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser25.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser25.RL_Master where Account_status='A')a union select '226' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser26.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser26.RL_Master where Account_status='A')a union select '227' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser27.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser27.RL_Master where Account_status='A')a union select '228' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser28.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser28.RL_Master where Account_status='A')a union select '229' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser29.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser29.RL_Master where Account_status='A')a union select '230' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser30.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser30.RL_Master where Account_status='A')a union select '231' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser31.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser31.RL_Master where Account_status='A')a union select '232' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser32.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser32.RL_Master where Account_status='A')a union select '233' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser33.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser33.RL_Master where Account_status='A')a union select '234' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser34.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser34.RL_Master where Account_status='A')a union select '235' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser35.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser35.RL_Master where Account_status='A')a)k";
			else
				 query="select (select branch_name from branch_master where to_char(branch_code)=k.branch) as bname,k.Account_no,k.customer_name,k.open_date,k.due_date,k.loan_amount,abs(k.osbalance),k.pending_days,k.interest_paid_upto,k.pending_Interest  from ( select '201' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser1.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser1.RL_Master where Account_status='A')a union select '202' as Branch,a.ACCOUNT_NO,a.CUSTOMER_ID,a.CUSTOMER_NAME,a.OPEN_DATE,a.LOAN_AMOUNT,a.DUE_DATE,a.INTEREST_RATE,a.INTEREST_PAID_UPTO,a.INTEREST_PAID_AMOUNT,a.ACCOUNT_STATUS,a.CLOSED_DATE,a.DAILY_LOAN_AMOUNT,a.DAILY_INT_AMOUNT,a.DAILY_INSTALMENT_AMOUNT,a.TOTAL_INTEREST,dbuser2.get_acc_balance_rl(a.Account_no,'"+To_Date+"') as osbalance,to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto as pending_days,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_int_amount as pending_Interest,(to_date('"+To_Date+"','dd/MM/yyyy')-interest_paid_upto)*daily_loan_amount as pending_Pronc,scheme_code from (select *  from dbuser2.RL_Master where Account_status='A')a )k";

			
			System.out.println("query-----------"+query);
			return template.query(query,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
																					{  
			
																						SimpleBranch c=new SimpleBranch();
																						SimpleDateFormat sd=new SimpleDateFormat("dd-MM-yyyy");
																						c.setS2(rs.getString(1));//BRANCH_NAME
																						System.out.println("rs.getString(1)------------------"+rs.getString(1));
																						c.setS3(rs.getString(2));//Scheme name
																						System.out.println("rs.getString(2)------------------------"+rs.getString(2));
																						c.setS4(rs.getString(3));//Account no
																						System.out.println("rs.getString(3)---------------------"+rs.getString(3));
																						///c.setS5(rs.getString(4));//Customer name
																						c.setS15(rs.getDate(4));
																						System.out.println("rs.getString(4)----------------------"+rs.getString(4));
																						
																						//c.setS6(rs.getString(5));//open date
																						//c.setS6(sd.format(rs.getDate(5)));
																						c.setS16(rs.getDate(5)); //open date
																						System.out.println("rs.getString(5)---------------------"+rs.getString(5));
																						
																						
																						//c.setS131(rs.getString(6)); // loan amount
																						c.setS141(rs.getDouble(6)); //loan amount
																						System.out.println("rs.getString(6)---------------------"+rs.getString(6));
																						
																						//c.setS32(rs.getString(7));//closing balance
																						c.setS142(rs.getDouble(7)); //closing balance
																						System.out.println("rs.getString(7)-----------------------"+rs.getString(7));
																						
																						//c.setS33(rs.getString(8)); // pending days
																						c.setS11(rs.getInt(8)); //pending days																						System.out.println("rs.getString(8)----------------------"+rs.getString(8));
																						//c.setS34(rs.getString(9)); // interest paid aupto
																						System.out.println("rs.getString(9)-------------------"+rs.getString(9));
																						//c.setS34(sd.format(rs.getDate(9)));
																						c.setS25(rs.getDate(9));	//interest paid upto																			
																					//	c.setS35(rs.getString(10)); // arrear interest	
																						c.setS143(rs.getDouble(10)); //arrear interest
																						System.out.println("rs.getString(10)------------------"+rs.getString(10));
																						
																						return c;
																					}
		 																		 }     );
		}

	 
	 public List<SimpleBranch>getFD_ConsolidatedReport(String From_Date,String To_Date, int code)
		{
			//--Set Connection----------------------------
		 int j=Binfo;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			System.out.println("Inside dao---------------------------------------");
			
			//String sql="select k.* from (select a1.*,a.Closed_Count,a.total_closed_amount,case when b.Closed_Renewal_Count is null then 0 else b.closed_renewal_count end as closed_renewal_count,case when b.Closed_Renewal_amount is null then 0 else b.Closed_Renewal_amount end as Closed_renewal_Amount,case when c.New_Count is null then 0 else New_Count end as NewCount,case when c.New_amount is null then 0 else c.New_amount end As newAmount ,case when d.Renewal_Count is null then 0 else  d.Renewal_Count end as Renewalcount,case when d.Renewal_amount is null then 0 else d.Renewal_amount end as Renewal_amount from (select to_char(branch_code) as branch,branch_name from branch_master)a1 left join (select branch,case when count(*) is null then 0 else count(*) end  as Closed_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_amount)end as total_closed_amount from fd_master_view where closed_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no  not in  (select renewal_no from fd_master where renewal_no is not null)  group by branch) a on a1.branch=a.branch left join (select branch,case when count(*) is null then 0 else count(*) end as Closed_Renewal_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_Amount) end as Closed_Renewal_amount from fd_master_view where closed_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and account_no in (select renewal_no from fd_master where renewal_no is not null) group by branch) b on a1.branch=b.branch left join (select branch,case when count(*) is null then 0 else count(*) end as New_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_amount)end as New_amount from fd_master_view where open_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and  renewal_no is  null group by branch) c on a1.branch=c.branch left join (select branch,case when count(*)is null then 0 else count(*) end as Renewal_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_amount) end as Renewal_amount from fd_master_view where open_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and  renewal_no is  not null group by branch) d on a1.branch=d.branch)k order by k.branch ";
			//String sql="select k.* from (select a1.*,a.Closed_Count,a.total_closed_amount,case when b.Closed_Renewal_Count is null then 0 else b.closed_renewal_count end as closed_renewal_count,case when b.Closed_Renewal_amount is null then 0 else b.Closed_Renewal_amount end as Closed_renewal_Amount,case when c.New_Count is null then 0 else New_Count end as NewCount,case when c.New_amount is null then 0 else c.New_amount end As newAmount ,case when d.Renewal_Count is null then 0 else  d.Renewal_Count end as Renewalcount,case when d.Renewal_amount is null then 0 else d.Renewal_amount end as Renewal_amount from (select to_char(branch_code) as branch,branch_name from branch_master)a1 left join (select branch,case when count(*) is null then 0 else count(*) end  as Closed_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_amount)end as total_closed_amount from fd_master_view where closed_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no  not in  (select renewal_no from fd_master_view where renewal_no is not null)  group by branch) a on a1.branch=a.branch left join (select branch,case when count(*) is null then 0 else count(*) end as Closed_Renewal_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_Amount) end as Closed_Renewal_amount from fd_master_view where closed_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and account_no in (select renewal_no from fd_master_view where renewal_no is not null) group by branch) b on a1.branch=b.branch left join (select branch,case when count(*) is null then 0 else count(*) end as New_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_amount)end as New_amount from fd_master_view where open_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and  renewal_no is  null group by branch) c on a1.branch=c.branch left join (select branch,case when count(*)is null then 0 else count(*) end as Renewal_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_amount) end as Renewal_amount from fd_master_view where open_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and  renewal_no is  not null group by branch) d on a1.branch=d.branch)k order by k.branch ";
			//10-08-2023
			String sql="select k.* from (select a1.*,a.Closed_Count,a.total_closed_amount,case when b.Closed_Renewal_Count is null then 0 else b.closed_renewal_count end as closed_renewal_count,case when b.Closed_Renewal_amount is null then 0 else b.Closed_Renewal_amount end as Closed_renewal_Amount,case when c.New_Count is null then 0 else New_Count end as NewCount,case when c.New_amount is null then 0 else c.New_amount end As newAmount ,case when d.Renewal_Count is null then 0 else  d.Renewal_Count end as Renewalcount,case when d.Renewal_amount is null then 0 else d.Renewal_amount end as Renewal_amount from (select to_char(branch_code) as branch,branch_name from branch_master)a1 left join (select branch,case when count(*) is null then 0 else count(*) end  as Closed_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_amount)end as total_closed_amount from fd_master_view where closed_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no  not in  (select renewal_no from fd_master_view where renewal_no is not null)  group by branch) a on a1.branch=a.branch left join (select branch,nvl(count(*),0) as Closed_Renewal_Count,sum(nvl(transaction_amount,0)) as Closed_Renewal_amount from fd_master_view a left join (select Account_no,nvl(sum(transaction_amount),0) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Debit' and flag in ('AC','INT') group by Account_no,transaction_date)b on a.Account_no=b.Account_no and a.Closed_date=b.Transaction_date where closed_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and a.account_no in (select renewal_no from fd_master_view where renewal_no is not null) group by branch) b on a1.branch=b.branch left join (select branch,case when count(*) is null then 0 else count(*) end as New_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_amount)end as New_amount from fd_master_view where open_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and  renewal_no is  null group by branch) c on a1.branch=c.branch left join (select branch,case when count(*)is null then 0 else count(*) end as Renewal_Count,case when sum(deposit_amount)is null then 0 else sum(deposit_amount) end as Renewal_amount from fd_master_view where open_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and  renewal_no is  not null group by branch) d on a1.branch=d.branch)k order by k.branch";
			
			System.out.println("query-----------"+sql);
			return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
																					{  
			
																						SimpleBranch c=new SimpleBranch();
																						SimpleDateFormat sd=new SimpleDateFormat("dd-MM-yyyy");
																						c.setS2(rs.getString(2));//BRANCH_NAME
																						
																						System.out.println("rs.getString(1)------------------"+rs.getString(1));
																						c.setS151(rs.getDouble(3));//Scheme name
																						c.setS152(rs.getDouble(4));//Scheme name
																						c.setS153(rs.getDouble(5));//Scheme name

																						c.setS154(rs.getDouble(6));//Scheme name

																						c.setS155(rs.getDouble(7));//Scheme name

																						c.setS156(rs.getDouble(8));//Scheme name

																						c.setS157(rs.getDouble(9));//Scheme name

																						c.setS158(rs.getDouble(10));//Scheme name


																						return c;
																					}
		 																		 }     );
		}
	 
	 
	 
	 public List<Customer>getCustomerDetails2(int cid,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
			return template.query("select * from CUSTOMER where CUSTOMER_ID="+cid+"",new RowMapper<Customer>(){   public Customer mapRow(ResultSet rs, int row) throws SQLException
			{  

				Customer gl=new Customer();
				
				
				gl.setCustomer_Id(rs.getInt(3));
				gl.setCustomer_Name(rs.getString(5));
				gl.setAddress(rs.getString(11));
				gl.setCity(rs.getString(12));
				gl.setPincode(rs.getString(13));
				gl.setPermanent_Address(rs.getString(44));
				gl.setPermanent_City(rs.getString(45));
				gl.setPermanent_Pincode(rs.getString(46));
				gl.setFather_Name(rs.getString(9));
				gl.setMarital_Status(rs.getString(8));
				gl.setGender(rs.getString(7));
				gl.setDate_of_Birth(rs.getString(6));
				gl.setCustomer_Type(rs.getString(14));
				gl.setOccupation(rs.getString(10));
				gl.setPhone_No(rs.getString(19));
				gl.setMobile_No(rs.getString(25));
				gl.setMail(rs.getString(20));
				
				gl.setAnniversary_Date(rs.getString(16));
				
				gl.setId_Type(rs.getString(15));
				gl.setId_No(rs.getString(16));
				gl.setId_Type_2(rs.getString(39));
				gl.setId_No_2(rs.getString(40));
				gl.setPAN_No(rs.getString(41));
				
				gl.setIssue_Date(rs.getString(17));
				gl.setIssue_Place(rs.getString(18));
				gl.setIntroducer_Id(rs.getString(21));
				gl.setIntroducer_Name(rs.getString(22));
				gl.setNominee_Name(rs.getString(33));
				gl.setNominee_Relationship(rs.getString(34));
				gl.setNominee_Age(rs.getString(35));
				gl.setNominee_DOB(rs.getString(36));
				gl.setRemarks(rs.getString(23));
				gl.setCustomer_Status(rs.getString(38));
				gl.setSMS_Feature(rs.getString(42));
				
				gl.setDoor_No(rs.getString(48));
				gl.setStreet_Name(rs.getString(49)); 
				gl.setArea(rs.getString(50));
				gl.setState(rs.getString(51));
				
				gl.setStd(rs.getInt(52));
				
				
				
				/*
				 * DOOR_NO
	STREET_NAME
	AREA
	STATE
	STD
	PERMANENT_DOOR_NO
	PERMANENT_STREET_NAME
	PERMANENT_AREA
	PERMANENT_STATE
	PREMISES
	PERMANENT_PREMISES
				 * 
				 * 
				 */
				
				gl.setPermanent_Door_No(rs.getString(53));
				gl.setPermanent_Street_Name(rs.getString(54));
				gl.setPermanent_Area(rs.getString(55));
				gl.setPermanent_State(rs.getString(56));
				gl.setPremises(rs.getString(57));
				gl.setPermanent_Premises(rs.getString(58));
				
				
								
				return gl;
			}
			 }     );
		}
		

	 public List<SimpleBranch> getCustomer_Address(int Customer_Id,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
			return template.query("select Address,Mobile_No,DOOR_NO,STREET_NAME,City,STATE,PINCODE,PREMISES,NOMINEE_NAME,Area from Customer where Customer_id="+Customer_Id+"",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  

				SimpleBranch gl=new SimpleBranch();
				gl.setS2(rs.getString(1));	//CUSTOMER_Address
				gl.setS3(rs.getString(2));	//Mobile_No
				gl.setS31(rs.getString(3));	//Door No
				gl.setS32(rs.getString(4));	//Street Name
				gl.setS33(rs.getString(5));	//City
				gl.setS34(rs.getString(6));	//State
				gl.setS35(rs.getString(7));	//Pin Code
				gl.setS36(rs.getString(8));	//Premises
				gl.setS4(rs.getString(9));	//Nominee Name
				gl.setS37(rs.getString(10));	//Area
				
									
				return gl;
			}
			 }     );
		}	
						
	 public List<SimpleBranch> cus_info1(int Customer_Id,String date,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
			return template.query("select Cust_Acc_Link.Account_No,Cust_Acc_Link.Account_Type,Cust_Acc_Link.Account_Status,GET_SB_CB(Cust_Acc_Link.Account_No,'"+date+"') as Balance  from Customer,Cust_Acc_Link,dual  where Customer.Customer_Id=Cust_Acc_Link.customer_Id and Customer.Customer_Id="+Customer_Id+" and Cust_Acc_Link.Account_Type in ('SC','SD','RD','FD')",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  

				SimpleBranch gl=new SimpleBranch();
				gl.setS2(rs.getString(1));  //Account Number
				gl.setS3(rs.getString(2));   //ACCOUNT tYPE
				gl.setS14(rs.getFloat(4));    //Balance
			
				
								
				return gl;
			}
			 }     );
		}	
		
		
		
		public List<SimpleBranch> cus_info2(int Customer_Id,String date,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
			return template.query("select Cust_Acc_Link.Account_No,Cust_Acc_Link.Account_Type,Cust_Acc_Link.Account_Status,GET_SB_CB(Cust_Acc_Link.Account_No,'"+date+"') as Balance  from Customer,Cust_Acc_Link,dual  where Customer.Customer_Id=Cust_Acc_Link.customer_Id and Customer.Customer_Id="+Customer_Id+" and Cust_Acc_Link.Account_Type in ('JL','DL','PL','DL','SNSGL','SNVGL','SNFTGL','SNAGL')",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  

				SimpleBranch gl=new SimpleBranch();
				gl.setS2(rs.getString(1));  //Account Number
				gl.setS3(rs.getString(2));   //ACCOUNT tYPE
				gl.setS14(rs.getFloat(4));    //Balance
			
				
								
				return gl;
			}
			 }     );
		}	
		public List<SimpleBranch> cus_infoFD(String Account_No,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
						
						 System.out.println("Inside the dao"+Account_No);

			//-----------------------------------------------------
			return template.query("Select Open_Date,Period_Months,Period_Days,CLOSING_BALANCE,MATURITY_DATE from FD_Master where Account_No='"+Account_No+"' ",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  
	            SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");

				SimpleBranch gl=new SimpleBranch();
				gl.setS31(sd.format(rs.getDate(1)));  //Account Number
				
				System.out.println("Date"+rs.getDate(1));
				gl.setS32(rs.getString(2)+"M/"+rs.getString(3)+"D");   //Period
				gl.setS14(rs.getFloat(4));    //Balance
				gl.setS33(sd.format(rs.getDate(5)));//Maturity Date
				System.out.println("Maturity Date"+rs.getDate(5));

				//gl.setS33(rs.getString(3)+rs.getString(2));   //ACCOUNT tYPE
			
			
				
								
				return gl;
			}
			 }     );
		}	
	  
		public List<SimpleBranch> cus_infoSD(String Account_No,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
						
						 System.out.println("Inside the dao"+Account_No);

			//-----------------------------------------------------
			return template.query("Select Open_Date,CLOSING_BALANCE from SBCA_Master where Account_No='"+Account_No+"' ",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  
	            SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");

				SimpleBranch gl=new SimpleBranch();
				gl.setS31(sd.format(rs.getDate(1)));  //Account Number
				
				System.out.println("Date"+rs.getDate(1));
				//gl.setS32(rs.getString(2)+"M/"+rs.getString(3)+"D");   //ACCOUNT tYPE
				gl.setS14(rs.getFloat(2));    //Balance

				//gl.setS33(rs.getString(3)+rs.getString(2));   //ACCOUNT tYPE
			
			
				
								
				return gl;
			}
			 }     );
		}	
		
		public List<SimpleBranch> cus_infoSC(String Account_No,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
						
						 System.out.println("Inside the dao"+Account_No);

			//-----------------------------------------------------
			return template.query("Select Date1,Share_Amount from Share_Master where Account_No='"+Account_No+"' ",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  
	            SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");

				SimpleBranch gl=new SimpleBranch();
				gl.setS31(sd.format(rs.getDate(1)));  //Account Number
				
				gl.setS14(rs.getFloat(2));    //Balance

			
			
			
				
								
				return gl;
			}
			 }     );
		}	
	  	
		public List<SimpleBranch> cus_infoRD(String Account_No,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
						
						 System.out.println("Inside the dao"+Account_No);

			//-----------------------------------------------------
			return template.query("Select OPEN_DATE,PERIOD_MONTHS,CLOSING_BALANCE,MATURITY_DATE,deposit_amount from RD_Master where Account_No='"+Account_No+"' ",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  
	            SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");

				SimpleBranch gl=new SimpleBranch();
				gl.setS31(sd.format(rs.getDate(1)));  //Account Number
				
				gl.setS14(rs.getFloat(3));    //Balance
				gl.setS33(sd.format(rs.getDate(4)));
				gl.setS32(rs.getString(2));   //Open Date
				gl.setS17(rs.getFloat(5));    //deposit Amount
			
			
			
				
								
				return gl;
			}
			 }     );
		}
		public List<SimpleBranch> cus_infoJL(String Account_No,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
						
						 System.out.println("Inside the dao"+Account_No);

			//----------------------------------------------------
						 return template.query("Select OPEN_DATE,PERIOD_MONTHS,PERIOD_DAYS,DUE_DATE,CLOSING_BALANCE from JL_Master where Account_No='"+Account_No+"' ",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  
	            SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");

				SimpleBranch gl=new SimpleBranch();
				gl.setS31(sd.format(rs.getDate(1)));  //Account Number
				gl.setS32(rs.getString(2)+"M/"+rs.getString(3)+"D");   //Period
				gl.setS14(rs.getFloat(5));    //Balance
				gl.setS33(sd.format(rs.getDate(4)));
			
				 System.out.println("Date"+rs.getDate(1));

							
				return gl;
			}
			 }     );
		}
		
		public List<SimpleBranch> cus_infoDL(String Account_No,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
						
						 System.out.println("Inside the dao"+Account_No);

			//-----------------------------------------------------
			return template.query("Select OPEN_DATE,PERIOD_MONTHS,PERIOD_DAYS,DUE_DATE,CLOSING_BALANCE from OL_Master where Account_No='"+Account_No+"' ",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  
	            SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");

				SimpleBranch gl=new SimpleBranch();
				gl.setS31(sd.format(rs.getDate(1)));  //Account Number
				gl.setS32(rs.getString(2)+"M/"+rs.getString(3)+"D");   //Period
				gl.setS14(rs.getFloat(5));    //Balance
				gl.setS33(sd.format(rs.getDate(4)));
			
				 System.out.println("Date"+rs.getDate(1));

							
				return gl;
			}
			 }     );
		}
		public List<SimpleBranch> cus_infoCL(String Account_No,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
						
						 System.out.println("Inside the dao"+Account_No);

			//-----------------------------------------------------
			return template.query("Select OPEN_DATE,PERIOD_MONTHS,PERIOD_DAYS,DUE_DATE,CLOSING_BALANCE from OL_Master where Account_No='"+Account_No+"' ",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  
	            SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");

				SimpleBranch gl=new SimpleBranch();
				gl.setS31(sd.format(rs.getDate(1)));  //Account Number
				gl.setS32(rs.getString(2)+"M/"+rs.getString(3)+"D");   //Period
				gl.setS14(rs.getFloat(5));    //Balance
				gl.setS33(sd.format(rs.getDate(4)));
			
				 System.out.println("Date"+rs.getDate(1));

							
				return gl;
			}
			 }     );
		}
		
		public List<SimpleBranch> cus_infoPL(String Account_No,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
						
						 System.out.println("Inside the dao"+Account_No);

			//-----------------------------------------------------
			return template.query("Select OPEN_DATE,PERIOD_MONTHS,PERIOD_DAYS,DUE_DATE,CLOSING_BALANCE from OL_Master where Account_No='"+Account_No+"' ",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  
	            SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");

				SimpleBranch gl=new SimpleBranch();
				gl.setS31(sd.format(rs.getDate(1)));  //Account Number
				gl.setS32(rs.getInt(2)+"M/"+rs.getFloat(3)+"D");   //Period
				gl.setS14(rs.getFloat(5));    //Balance
				gl.setS33(sd.format(rs.getDate(4)));
			
				 System.out.println("Date"+rs.getDate(1));

							
				return gl;
			}
			 }     );
		}
		
		
		public List<SimpleBranch> getFirstSDAccNo(int Customer_Id,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
			return template.query("select Account_no from cust_Acc_Link where customer_id="+Customer_Id+" and account_status='A' and Account_type='SD' AND SCHEME_CODE='20010' AND ROWNUM=1",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  

				SimpleBranch gl=new SimpleBranch();
				gl.setS31(rs.getString(1));  //Account Number
				
				 System.out.println(rs.getString(1));
								
				return gl;
			}
			 }     );
		}	
		
		public List<SimpleBranch> getCustomerReport_Info(int Customer_Id,String Status,int Bcode){

			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
			return template.query("Select 'Equity Share Capital' as Account_Type,Customer_Id,Account_No,to_char(Date1,'dd/MM/yyyy') as Open_Date,Scheme_Code,'-' as Period,Closing_Balance,Account_Status,'-' as Due_Date from Share_Master where Customer_Id="+Customer_Id+" and Account_Status like '"+Status+"' union Select 'Fixed Deposit' as Account_Type,Customer_Id,Account_No,to_char(Open_Date,'dd/MM/yyyy') as Open_Date,Scheme_Code,(case when Period_Months>0 Then Period_Months ||' M' else '' End || case when Period_Days>0 Then Period_Days ||' D' Else '' End) as Period,Deposit_Amount as Closing_Balance,Account_Status,to_char(Maturity_Date,'dd/MM/yyyy') as Due_Date from FD_Master where Customer_Id="+Customer_Id+" and Account_Status like '%"+Status+"%' union Select 'Recurring Deposit' as Account_Type,Customer_Id,to_char(Account_No),to_char(Open_Date,'dd/MM/yyyy') as Open_Date,Scheme_Code,(case when Period_Months>0 Then Period_Months ||' M' else '-' End)as Period,Closing_Balance,Account_Status,to_char(Maturity_Date,'dd/MM/yyyy') as Due_Date from RD_Master where Customer_Id="+Customer_Id+" and Account_Status like '%"+Status+"%' union Select 'Loan' as Account_Type,Customer_Id,to_char(Account_No),to_char(Open_Date,'dd/MM/yyyy') as Open_Date,Scheme_Code,(case when Period_Months>0 Then Period_Months ||' M' else '-' End)as Period,-Closing_Balance,Account_Status,to_char(Due_Date,'dd/MM/yyyy') as Due_Date from OL_Master where Customer_Id="+Customer_Id+" and Account_Status like '"+Status+"' union Select 'Loan' as Account_Type,Customer_Id,Account_No,to_char(Open_Date,'dd/MM/yyyy') as Open_Date,Scheme_Code,(case when Period_Months>0 Then Period_Months ||' M' else '-' End)as Period,-Closing_Balance,Account_Status,to_char(Due_Date,'dd/MM/yyyy') as Due_Date from JL_Master where Customer_Id="+Customer_Id+" and Account_Status like '%"+Status+"%' union Select 'Savings Deposit' as Account_Type,Customer_Id,Account_No,to_char(Open_Date,'dd/MM/yyyy') as Open_Date,Scheme_Code,'-' as Period,Closing_Balance,Account_Status,'-' as Due_Date from SBCA_Master where Customer_Id="+Customer_Id+" and Account_Status like '%"+Status+"%' order by Account_No",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  

				SimpleBranch gl=new SimpleBranch();
				
				gl.setS31(rs.getString(1));   //Account_Type
				gl.setS1(rs.getInt(2));  //Customer_Id
				gl.setS32(rs.getString(3));   //Account_No
				gl.setS33(rs.getString(4));    //Open_Date
				gl.setS34(rs.getString(5));   //Scheme_Code
				gl.setS35(rs.getString(6));   //Period
				gl.setS51(rs.getFloat(7));   //Closing_Balance
				gl.setS36(rs.getString(8));   //Account_Status
				gl.setS37(rs.getString(9));   //Due_Date
				
							System.out.println("--"+rs.getString(1)+"--"+rs.getInt(2)+"--"+rs.getString(3)+"--"+rs.getString(4)+"--"+rs.getString(5)+"--"+rs.getString(6)+"--");
				return gl;
			}
			 }     );
		}
		public List<SimpleBranch> getno(int no,int Bcode){
			//--Set Connection----------------------------
			int j=Bcode;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			return template.query("Select MOBILE_NO from customer where CUSTOMER_ID="+no+"",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
		{  
	     
	      
	      SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");
			
			SimpleBranch gl=new SimpleBranch(); 
		    gl.setS2(rs.getString(1));	//Account_No
			
			
			return gl;
		}
		 }     ); 
	}		
		
		public List<SimpleBranch> getCustomerCertificate_Info(int Customer_Id,String From_Date,String To_Date){

			//--Set Connection------------------------------------
						int j=Binfo;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
						//String sql="select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) as Interest_Paid,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+To_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')+2) as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode from fd_master_View where DEDUCT_TDS in ('Y','Yes') and Customer_id="+Customer_Id+" order by customer_id)a)b  where b.Interest_Paid is not null order by b.branch";
           // System.out.println(sql);
			//05-05-2021
			//String sql="select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) as Interest_Paid,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode from fd_master_View where DEDUCT_TDS in ('Y','Yes') and Customer_id="+Customer_Id+" order by customer_id)a)b  where b.Interest_Paid is not null order by b.branch";
			
			
			 //25-05-2021
            //String sql="select main_qry.* from (select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) as Interest_Paid,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status from fd_master_View where DEDUCT_TDS in ('Y','Yes') and interest_payment_mode !='Reinvest' and Customer_id="+Customer_Id+" order by customer_id)a)b union select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021=0 then (select sum(interest) from fd_interest_view where Account_no=b.Account_no and to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) else (case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid) end as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,case when a.Account_status='C' then (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) else 0 end as Interest_Paid,case when a.Account_status='C' then (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) else 0 end  as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status from fd_master_View where DEDUCT_TDS in ('Y','Yes') and interest_payment_mode ='Reinvest' and Customer_id="+Customer_Id+" order by customer_id)a)b)main_qry  where main_qry.Interest_Paid is not null order by main_qry.Account_No";
            
            //26-05-2022
          // String sql="select main_qry.* from ( select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) as Interest_Paid,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where DEDUCT_TDS in ('Y','Yes') and interest_payment_mode !='Reinvest' and Customer_id="+Customer_Id+" order by customer_id)a)b union select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021=0 then (select sum(interest) from fd_interest_view where Account_no=b.Account_no and to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) else (case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid) end as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,case when a.Closed_status='Y' then (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) else 0 end as Interest_Paid,case when a.Closed_status='Y' then (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) else 0 end  as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where DEDUCT_TDS in ('Y','Yes') and interest_payment_mode ='Reinvest' and Customer_id="+Customer_Id+" order by customer_id)a)b)main_qry  where main_qry.Interest_Paid is not null order by main_qry.Account_No";

          //11-07-2022 local
          // String sql="select main_qry.* from ( select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) as Interest_Paid,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode !='Reinvest' and Customer_id="+Customer_Id+" order by customer_id)a)b union select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021=0 then (select sum(interest) from fd_interest_view where Account_no=b.Account_no and to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) else (case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid) end as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) as Interest_Paid,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode ='Reinvest' and Customer_id="+Customer_Id+" order by customer_id)a)b)main_qry  where main_qry.Total_interest is not null  order by main_qry.Account_No";

           //05-08-2022 All accounts
         //  String sql="select main_qry.* from ( select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) as Interest_Paid,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where  interest_payment_mode !='Reinvest' and Customer_id="+Customer_Id+" order by customer_id)a)b union select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021=0 then (select sum(interest) from fd_interest_view where Account_no=b.Account_no and to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) else (case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid) end as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,case when a.Closed_status='Y' then (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) else 0 end as Interest_Paid,case when a.Closed_status='Y' then (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) else 0 end  as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode ='Reinvest' and Customer_id="+Customer_Id+" order by customer_id)a)b)main_qry  where main_qry.Total_interest is not null order by main_qry.Account_No";

           //22-05-2023 WITH OUT SK
          /// String sql=" select main_qry.* from ( select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) as Interest_Paid,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where  interest_payment_mode !='Reinvest' and Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a)b union select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021=0 then (select sum(interest) from fd_interest_view where Account_no=b.Account_no and to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) else (case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid) end as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,case when a.Closed_status='Y' then (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) else 0 end as Interest_Paid,case when a.Closed_status='Y' then (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) else 0 end  as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode ='Reinvest' and Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a)b)main_qry  where main_qry.Total_interest is not null order by main_qry.Account_No";

           //temp update
        //  String sql="select qry.* from (select main_qry.* from (select a.Account_no,b.branch_name,case when a.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,a.Deposit_Amount,Interest_Paid.Int_Paid, case when Interest_Paid_31032021.Int_Paid_31032021 is null then 0 else Interest_Paid_31032021.Int_Paid_31032021 end  as interest_on_31_04_2021,  case when Interest_Paid_31032021.Int_Paid_31032021 is null then 0 else Interest_Paid_31032021.Int_Paid_31032021 end+Interest_Paid.Int_Paid as Total_Interest, tds_paid.tds,'"+To_Date+"' as Interest_On from ( select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode !='Reinvest' and Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a left join  (Select branch_code,Branch_Name from branch_master)b on a.branch=b.branch_code left join (Select Account_no,sum(transaction_amount) as Int_Paid from daily_transaction_Table where flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2 group by account_no) Interest_Paid on a.account_no=Interest_Paid.Account_no left join (Select Account_no, sum(transaction_amount) as Int_Paid_31032021  from daily_transaction_Table where flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2 group by account_no) Interest_Paid_31032021 on a.account_no=Interest_Paid_31032021.Account_no left join (Select Account_no,sum(transaction_amount) as tds from daily_transaction_Table where flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no) tds_paid on a.account_no=tds_paid.Account_no) main_qry  union  select main_qry.* from (select a.Account_no,b.branch_name,case when a.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,a.Deposit_Amount,case when a.Closed_status='Y' then Interest_Paid.Int_Paid else 0 end as Int_Paid,case when a.Closed_status='Y' then Interest_Paid_31032021.Int_Paid_31032021 else 0 end  as interest_on_31_04_2021,case when nvl(Interest_Paid_31032021.Int_Paid_31032021,0)=0 then FD_int.fd_int else case when a.Closed_status='Y' then  nvl(Interest_Paid_31032021.Int_Paid_31032021,0)+nvl(Interest_Paid.Int_Paid,0) else 0 end end as Total_Interest,tds_paid.tds,'"+To_Date+"' as Interest_On from ( select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode ='Reinvest' and Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a left join  (Select branch_code,Branch_Name from branch_master)b on a.branch=b.branch_code left join (Select Account_no, sum(transaction_amount) as Int_Paid from daily_transaction_Table where  flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2 group by Account_no) Interest_Paid on a.account_no=Interest_Paid.Account_no left join (Select Account_no,sum(transaction_amount) as Int_Paid_31032021 from daily_transaction_Table where flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2 group by account_no) Interest_Paid_31032021 on a.account_no=Interest_Paid_31032021.Account_no left join (Select Account_no,sum(transaction_amount) as tds from daily_transaction_Table where flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no) tds_paid on a.account_no=tds_paid.Account_no left join (select Account_no,sum(interest) as fd_int from fd_interest_view where  to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no)FD_int on a.account_no=FD_int.Account_no) main_qry )qry where qry.Total_interest is not null order by qry.Account_No";
        
			//Update Compound Interest 08-04-2024
         // String sql="select qry.* from (select main_qry.* from (select a.Account_no,b.branch_name,case when a.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,a.Deposit_Amount,Interest_Paid.Int_Paid, case when Interest_Paid_31032021.Int_Paid_31032021 is null then 0 else Interest_Paid_31032021.Int_Paid_31032021 end  as interest_on_31_04_2021,  nvl(Interest_Paid_31032021.Int_Paid_31032021,0)+nvl(Interest_Paid.Int_Paid,0) as Total_Interest, tds_paid.tds,'"+To_Date+"' as Interest_On from ( select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode !='Reinvest' and Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a left join  (Select branch_code,Branch_Name from branch_master)b on a.branch=b.branch_code left join (Select Account_no,sum(transaction_amount) as Int_Paid from DAILY_TRANSACTION_NOTGL_TABLE where flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2 group by account_no) Interest_Paid on a.account_no=Interest_Paid.Account_no left join (Select Account_no, sum(transaction_amount) as Int_Paid_31032021  from DAILY_TRANSACTION_NOTGL_TABLE where flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2 group by account_no) Interest_Paid_31032021 on a.account_no=Interest_Paid_31032021.Account_no left join (Select Account_no,sum(transaction_amount) as tds from DAILY_TRANSACTION_NOTGL_TABLE where flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no) tds_paid on a.account_no=tds_paid.Account_no) main_qry  union  select main_qry.* from (select a.Account_no,b.branch_name,case when a.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,a.Deposit_Amount,case when a.Closed_status='Y' then Interest_Paid.Int_Paid else Interest_Paid.Int_Paid end as Int_Paid,  nvl(Interest_Paid_31032021.Int_Paid_31032021,0)  as interest_on_31_04_2021,  nvl(Interest_Paid_31032021.Int_Paid_31032021,0)+nvl(Interest_Paid.Int_Paid,0) as Total_Interest,tds_paid.tds,'"+To_Date+"' as Interest_On from ( select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode ='Reinvest' and Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a left join  (Select branch_code,Branch_Name from branch_master)b on a.branch=b.branch_code left join (Select Account_no, sum(transaction_amount) as Int_Paid from DAILY_TRANSACTION_NOTGL_TABLE where  flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2 group by Account_no) Interest_Paid on a.account_no=Interest_Paid.Account_no left join (Select Account_no,sum(transaction_amount) as Int_Paid_31032021 from DAILY_TRANSACTION_NOTGL_TABLE where flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2 group by account_no) Interest_Paid_31032021 on a.account_no=Interest_Paid_31032021.Account_no left join (Select Account_no,sum(transaction_amount) as tds from DAILY_TRANSACTION_NOTGL_TABLE where flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no) tds_paid on a.account_no=tds_paid.Account_no left join (select Account_no,sum(interest) as fd_int from fd_interest_view where  to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no)FD_int on a.account_no=FD_int.Account_no) main_qry )qry where  qry.Total_interest !=0 order by qry.Account_No";

           //CD final month int paid added to int_paid
           //String sql="select qry.* from (select main_qry.* from (select a.Account_no,b.branch_name,case when a.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,a.Deposit_Amount,Interest_Paid.Int_Paid, case when Interest_Paid_31032021.Int_Paid_31032021 is null then 0 else Interest_Paid_31032021.Int_Paid_31032021 end  as interest_on_31_04_2021,  nvl(Interest_Paid_31032021.Int_Paid_31032021,0)+nvl(Interest_Paid.Int_Paid,0) as Total_Interest, tds_paid.tds,'"+To_Date+"' as Interest_On from ( select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode !='Reinvest' and Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a left join  (Select branch_code,Branch_Name from branch_master)b on a.branch=b.branch_code left join (Select Account_no,sum(transaction_amount) as Int_Paid from DAILY_TRANSACTION_NOTGL_TABLE where flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2 group by account_no) Interest_Paid on a.account_no=Interest_Paid.Account_no left join (Select Account_no, sum(transaction_amount) as Int_Paid_31032021  from DAILY_TRANSACTION_NOTGL_TABLE where flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2 group by account_no) Interest_Paid_31032021 on a.account_no=Interest_Paid_31032021.Account_no left join (Select Account_no,sum(transaction_amount) as tds from DAILY_TRANSACTION_NOTGL_TABLE where flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no) tds_paid on a.account_no=tds_paid.Account_no) main_qry  union  select main_qry.* from (select a.Account_no,b.branch_name,case when a.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,a.Deposit_Amount,Interest_Paid.Int_Paid+nvl(Interest_Paid_31032021.Int_Paid_31032021,0) as Int_Paid,  0  as interest_on_31_04_2021,  nvl(Interest_Paid_31032021.Int_Paid_31032021,0)+nvl(Interest_Paid.Int_Paid,0) as Total_Interest,tds_paid.tds,'"+To_Date+"' as Interest_On from ( select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode ='Reinvest' and Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a left join  (Select branch_code,Branch_Name from branch_master)b on a.branch=b.branch_code left join (Select Account_no, sum(transaction_amount) as Int_Paid from DAILY_TRANSACTION_NOTGL_TABLE where  flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2 group by Account_no) Interest_Paid on a.account_no=Interest_Paid.Account_no left join (Select Account_no,sum(transaction_amount) as Int_Paid_31032021 from DAILY_TRANSACTION_NOTGL_TABLE where flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2 group by account_no) Interest_Paid_31032021 on a.account_no=Interest_Paid_31032021.Account_no left join (Select Account_no,sum(transaction_amount) as tds from DAILY_TRANSACTION_NOTGL_TABLE where flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no) tds_paid on a.account_no=tds_paid.Account_no left join (select Account_no,sum(interest) as fd_int from fd_interest_view where  to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by Account_no)FD_int on a.account_no=FD_int.Account_no) main_qry )qry where  qry.Total_interest !=0 order by qry.Account_No";

         //Cd Compound 13-04-2024
           //String sql=" select main_qry.* from ( select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid as Total_Interest,b.tds_paid,'31/03/2024' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) as Interest_Paid,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where  interest_payment_mode !='Reinvest' and Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a)b  union  select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end  as interest_on_31_04_2021,case when b.Interest_paid_31032021=0 then (select sum(interest) from fd_interest_view where Account_no=b.Account_no and to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) else (case when b.Interest_paid_31032021 is null then 0 else b.Interest_paid_31032021 end+b.Interest_Paid) end as Total_Interest,b.tds_paid,'"+To_Date+"' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,case when a.Closed_status='Y' then (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) else (select sum(interest) from fd_interest_view where Account_no=a.Account_no and to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and  add_months (to_date('"+To_Date+"','dd/MM/yyyy'),-1)+2) end as Interest_Paid,case when a.Closed_status='Y' then (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) else (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='INT' and transaction_Type='Credit' and transaction_date between add_months(to_date('"+To_Date+"','dd/MM/yyyy'),-1)+1 and to_date('"+To_Date+"','dd/MM/yyyy')+2) end  as Interest_Paid_31032021,(Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from (select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status from fd_master_View where interest_payment_mode ='Reinvest' and Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a)b)main_qry  where main_qry.Total_interest is not null order by main_qry.Account_No";

         //New Logic 13-04-2024
           //String sql="select main_qry.* from (  select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,0  as interest_on_31_04_2021,b.Interest_Paid as Total_Interest,b.tds_paid,'31/03/2024' as Interest_On from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,  (select sum(interest) from fd_interest_view where Account_no=a.Account_no and to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and  case when a.closed_date < to_date('"+To_Date+"','dd/MM/yyyy') then a.closed_date else to_date('"+To_Date+"','dd/MM/yyyy') end) as Interest_Paid, 0 as Interest_Paid_31032021, (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from  ( select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status,nvl(closed_date,maturity_date) as closed_date,maturity_date from fd_master_View  where  Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a)b  )main_qry  where main_qry.Total_interest is not null order by main_qry.Account_No";
          //New Login updated with OS 15-04-2024
           String sql="select newm.*,nvl(c.Credit,0)-nvl(d.Debit,0) as Interest_On from (select main_qry.* from (  select b.Account_No,b.bname,case when b.interest_payment_mode='Reinvest' then 'CD'else 'FD' end as product_Type,b.Deposit_Amount,b.Interest_Paid,0  as interest_on_31_04_2021,b.Interest_Paid as Total_Interest,b.tds_paid from (select (Select Branch_Name from branch_master where branch_code=a.branch) as bname,a.*,  (select sum(interest) from fd_interest_view where Account_no=a.Account_no and to_date between  to_date('"+From_Date+"','dd/MM/yyyy') and  case when a.closed_date < to_date('"+To_Date+"','dd/MM/yyyy') then a.closed_date else to_date('"+To_Date+"','dd/MM/yyyy') end) as Interest_Paid, 0 as Interest_Paid_31032021, (Select sum(transaction_amount) from daily_transaction_Table where Account_No=a.Account_No and flag='TDS' and transaction_Type='Debit' and transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy')) as tds_paid from  ( select Branch,Account_No,Customer_id,Customer_Name,Deposit_Amount,INTEREST_PROJECTION,interest_payment_mode,Account_Status,case when closed_date !=null  then case when closed_date<=to_date('"+To_Date+"','dd/MM/yyyy') then 'Y' else 'N' end else 'N' end as Closed_Status,nvl(closed_date,maturity_date) as closed_date,maturity_date from fd_master_View  where  Customer_id="+Customer_Id+" AND SCHEME_CODE IN (SELECT SCHEME_CODE FROM SCHEME_MASTER WHERE DEP !='9' AND SCHEME_CATEGORY='FD') order by customer_id)a)b  )main_qry  where main_qry.Total_interest is not null order by main_qry.Account_No)newm left join (Select Account_No,nvl(sum(Transaction_Amount),0) as Credit from Daily_Transaction_NOTGL_TABLE 	where Transaction_Date<=to_date('"+To_Date+"','dd/MM/yyyy') and Transaction_Type='Credit'  group by Account_No) c 	on newm.Account_No=c.Account_No left join 	(Select Account_No, nvl(sum(Transaction_Amount),0) as Debit from Daily_Transaction_NOTGL_TABLE 	where Transaction_Date<=to_date('"+To_Date+"','dd/MM/yyyy') and Transaction_Type='Debit'  group by Account_No) d 	on newm.Account_No=d.Account_No" ;

           
           
           System.out.println(sql);
           
			return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  

				SimpleBranch gl=new SimpleBranch();
				
				gl.setS31(rs.getString(1));   //Account_N0
				gl.setS1(rs.getInt(4));  //Deposit Amt
				gl.setS32(rs.getString(2));   //Account_No
				gl.setS33(rs.getString(3));    //Open_Date
				gl.setS11(rs.getInt(5));   //Int Paid
				gl.setS12(rs.getInt(6));   //Int As on
				gl.setS51(rs.getFloat(7));   //Total Int
				gl.setS21(rs.getInt(8));   //TDS paid
				gl.setS36(rs.getString(9));   //As on Date
				
				return gl;
			}
			 }     );
		}
		
		
		
		
		
		public List<SimpleBranch> getCustomerList_Certificate(String Current,int Bcode){
			
			//--Set Connection------------------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
						
						//String sql="select * from Customer_View where customer_id in (select  distinct customer_id from fd_master_view where deduct_tds in ('Yes','Y')) and to_char(Customer_id) like '%"+Current+"%' ORDER BY Customer_Id desc";
						
						//String sql="select a.*, (Select Address from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as address,(Select pan_no from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as pan ,(Select branch from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as branch from (select  distinct customer_id,Customer_Name from fd_master_view where deduct_tds in ('Yes','Y'))a where to_char(a.Customer_id) like '%"+Current+"%' order by customer_id";
						
						//String sql="select a.*,(Select Customer_Name from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as Customer_Name, (Select Address from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as address,(Select pan_no from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as pan ,(Select branch from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as branch from (select distinct customer_id from fd_master_view where deduct_tds in ('Yes','Y'))a where to_char(a.Customer_id) like '%"+Current+"%' order by customer_id";
						//05-08-2022 all accounts
						String sql="select a.*,(Select Customer_Name from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as Customer_Name, (Select Address from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as address,(Select pan_no from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as pan ,(Select branch from Customer_view where Customer_id=a.Customer_Id and rownum=1 ) as branch from (select distinct customer_id from fd_master_view )a where to_char(a.Customer_id) like '%"+Current+"%' order by customer_id";

						
						System.out.println(sql);
						
						return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
						{  

							SimpleBranch gl=new SimpleBranch();
							gl.setS11(rs.getInt(5));   //Branch Code
							gl.setS1(rs.getInt(1));   //CUSTOMER_ID
							gl.setS2(rs.getString(2));  //CUSTOMER_NAME
							gl.setS5(rs.getString(3));   //ADDRESS
								gl.setS33(rs.getString(4));   //Verify
							
							
											
							return gl;
			}
			 }     );
		}
		
		
		
		 public List<SimpleBranch> getCustomer_Address_Certificate(int Customer_Id,int Bcode){

				//--Set Connection------------------------------------
							int j=Binfo;
							this.template=con.getCon2(j);
				//-----------------------------------------------------
				return template.query("select Address,Mobile_No,DOOR_NO,STREET_NAME,City,STATE,PINCODE,PREMISES,NOMINEE_NAME,Area from Customer_View where Customer_id="+Customer_Id+" and rownum=1",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
				{  

					SimpleBranch gl=new SimpleBranch();
					gl.setS2(rs.getString(1));	//CUSTOMER_Address
					gl.setS3(rs.getString(2));	//Mobile_No
					gl.setS31(rs.getString(3));	//Door No
					gl.setS32(rs.getString(4));	//Street Name
					gl.setS33(rs.getString(5));	//City
					gl.setS34(rs.getString(6));	//State
					gl.setS35(rs.getString(7));	//Pin Code
					gl.setS36(rs.getString(8));	//Premises
					gl.setS4(rs.getString(9));	//Nominee Name
					gl.setS37(rs.getString(10));	//Area
					
										
					return gl;
				}
				 }     );
			}	
				
			// FD Reports - Month
			public List<SimpleBranch> getFD_Monthly_Report_Closed(String Monthly_From_Date,
					String Monthly_To_Date, String Scheme_Code, int Bcode) {
				// --Set Connection------------------------------------
				int j = Bcode;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  not in  (select renewal_no from fd_master where renewal_no is not null)order by Account_No";
				
				//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
				//29-06-2022
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  not in  (select renewal_no from fd_master where renewal_no is not null)order by Account_No";
				//28-07-2022
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date,(select a.transaction_amount as closure_amt from (select transaction_amount from daily_transaction_table where transaction_type='Credit' and flag='AC' and account_no=FD_Master_View.Account_no order by transaction_date desc)a where rownum=1) as closure_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  not in  (select renewal_no from fd_master_View where renewal_no is not null)order by Branch,Account_No";

				//03-08-2022
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date,(select a.transaction_amount as closure_amt from (select transaction_amount from daily_transaction_table where transaction_type='Debit' and flag='AC' and account_no=FD_Master_View.Account_no order by transaction_date desc)a where rownum=1) as closure_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  not in  (select renewal_no from fd_master_View where renewal_no is not null)order by Branch,Account_No";

				//24-12-2022
				//String sql="select a.*,b.transaction_amount from (Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  not in  (select renewal_no from fd_master_View where renewal_no is not null)order by Branch,Account_No)a left join (select Account_no,nvl(sum(transaction_amount),0) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Debit' and flag in ('AC','INT') group by Account_no,transaction_date)b on a.Account_no=b.Account_no and a.Closed_date=b.Transaction_date";
				//04-05-2023
				//String sql="select a.* from (Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date,(select Total from (Select Principal+Interest+Penalty-Lien_Prin-Lien_Int as Total from Voucher_print_view where Account_No=cast(FD_Master_View.Account_No as varchar2(20)) order by Transaction_Date desc,to_number(substr(to_char(Transaction_Id),-5,5)) desc) a where ROWNUM=1)  as transaction_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  not in (select renewal_no from fd_master_View where renewal_no is not null)order by Branch,Account_No)a";
				//01-07-2023
				String sql="select a.* from (Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date,(Select sum(Principal+Interest+Penalty) from Voucher_print_view where Page_Source in ('FDC','FDR') and Account_No=cast(FD_Master_View.Account_No as varchar2(20)) and Transaction_Date=FD_Master_View.Closed_Date)  as transaction_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  not in (select renewal_no from fd_master_View where renewal_no is not null)order by Branch,Account_No)a";
				//rebecca
				//String sql="select a.* from (Select Customer_Id,s1.Account_No,Customer_Name,s1.Open_Date,Value_Date,Interest_Rate,s1.Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,s1.scheme_code,(Select scheme_name from scheme_Master where scheme_code=s1.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date,(Select sum(Principal+Interest+Penalty) from Voucher_print_view where Page_Source in ('FDC','FDR') and Account_No=cast(s1.Account_No as varchar2(20)) and Transaction_Date=s1.Closed_Date)  as transaction_amount,p1.Employee_Id, p1.Employee_Name from FD_Master_View s1 left join Employee_Target p1 on s1.Account_No=p1.Account_No where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and s1.Scheme_Code like '%"+Scheme_Code+"%' and s1.Account_no  not in (select renewal_no from fd_master_View a left join Employee_Target b on a.Account_no=b.Account_No where renewal_no is not null)order by Branch,s1.Account_No)a";
				
				System.out.println("Closed="+sql);
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(1));//customer id
										jm.setS31(rs.getString(2)); // Account No
										jm.setS32(rs.getString(3)); // Name

										jm.setS33(sd.format(rs.getDate(4))); // Open
																				// Date

										jm.setS121(rs.getDate(4)); //open date
										// jm.setS33(rs.getString(4)); //Open Date
										jm.setS122(rs.getDate(13)); //closed  date
										jm.setS37(sd.format(rs.getDate(13))); // Closed Date

										jm.setS42(rs.getInt(7)); // Deposit Amount
										jm.setS35(rs.getString(8)); // Period

										jm.setS36(rs.getString(12)); // Renewal No
										
										jm.setS123(rs.getDate(5)); // value date
										jm.setS38(sd.format(rs.getDate(5))); // Value date
										
										jm.setS39(rs.getString(14)); // Remarks
										
										
										//29-06-2022
										jm.setS40(rs.getString(17)); // Sc Name
										
										//28-07-2022
										jm.setS131(rs.getString(18)); // Sc Name
										jm.setS132(rs.getString(19)); // Sc Name
										jm.setS124(rs.getDate(20)); // Maturity date
										jm.setS20(rs.getFloat(21));//Closure_Amount
										jm.setS100(rs.getFloat(6)); // interest rate

										
									//	jm.setS135(rs.getString(22));
									//	jm.setS136(rs.getString(23));

										//05-02-2024
										jm.setS43(rs.getInt(10)); // Closing Balance


										return jm;
									}
								});
			}
			
			public List<SimpleBranch> getFD_Monthly_Report_Active(String Monthly_From_Date,
					String Monthly_To_Date, String Scheme_Code, int Bcode) {
				// --Set Connection------------------------------------
				int j = Bcode;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and renewal_no is null and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";
				
				//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
				//29-06-2022
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and renewal_no is null and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";

				//28-07-2022
				String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_Date,0.0 as closure_Amount from FD_Master_View where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and renewal_no is null and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Branch,Account_No";
				//Rebecca
				//String sql="Select Customer_Id,a.Account_No,Customer_Name,a.Open_Date,Value_Date,Interest_Rate,a.Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,a.scheme_code,(Select scheme_name from scheme_Master where scheme_code=a.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_Date,0.0 as closure_Amount,b.Employee_Id,b.Employee_Name from FD_Master_View a left join Employee_Target b on a.Account_No=b.Account_No where a.Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and renewal_no is null and Account_Status='A' and a.Scheme_Code like '%" + Scheme_Code + "%' order by Branch,a.Account_No";

				
				System.out.println("Active="+sql);
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(1));//customer id
										jm.setS31(rs.getString(2)); // Account No
										jm.setS32(rs.getString(3)); // Name

										jm.setS33(sd.format(rs.getDate(4))); // Open
																				// Date
										jm.setS121(rs.getDate(4)); //open date
										// jm.setS33(rs.getString(4)); //Open Date
										jm.setS37(rs.getString(13)); // Closed Date
										jm.setS122(rs.getDate(13)); //closed date
										
										jm.setS42(rs.getInt(7)); // Deposit Amount
										jm.setS35(rs.getString(8)); // Period

										jm.setS36(rs.getString(12)); // Renewal No
										
										jm.setS38(sd.format(rs.getDate(5))); // Value date
										jm.setS123(rs.getDate(5)); // value date
										
										jm.setS39(rs.getString(14)); // Remarks
										
										//29-06-2022
										jm.setS40(rs.getString(17)); // Sc Name
										
										
										//28-07-2022
										jm.setS131(rs.getString(18)); // Sc Name
										jm.setS132(rs.getString(19)); // Sc Name
										jm.setS124(rs.getDate(20)); // Maturity date
										jm.setS20(rs.getFloat(21));//Closure_Amount
										jm.setS100(rs.getFloat(6)); // interest rate

//jm.setS135(rs.getString(22));
//jm.setS136(rs.getString(23));

										//05-02-2024
										jm.setS43(rs.getInt(10)); // Closing Balance

										return jm;
									}
								});
			}
			
			public List<SimpleBranch> getFD_Monthly_Report_Renewal(String Monthly_From_Date,
					String Monthly_To_Date, String Scheme_Code, int Bcode) {
				// --Set Connection------------------------------------
				int j = Bcode;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy')  and to_number(renewal_no)>0 and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";
				//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
				//29-06-2022
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy')  and to_number(renewal_no)>0 and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";
				String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_Date,0.0 as closure_Amount from FD_Master_View where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy')  and renewal_no is not null and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Branch,Account_No";
				//28-07-2022
				//String sql="Select Customer_Id,p1.Account_No,Customer_Name,p1.Open_Date,Value_Date,Interest_Rate,p1.Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,p1.scheme_code,(Select scheme_name from scheme_Master where scheme_code=p1.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_Date,0.0 as closure_Amount,s1.Employee_Id, s1.Employee_Name from FD_Master_View p1 left join Employee_Target s1 on p1.Account_No=s1.Account_No where p1.Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and to_number(renewal_no)>0 and Account_Status='A' and p1.Scheme_Code like '%" + Scheme_Code + "%' order by Branch,p1.Account_No";

				System.out.println("Renewal="+sql);
				
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(1));//customer id
										jm.setS31(rs.getString(2)); // Account No
										jm.setS32(rs.getString(3)); // Name

										jm.setS33(sd.format(rs.getDate(4))); // Open
																				// Date
										jm.setS121(rs.getDate(4)); //open date
										// jm.setS33(rs.getString(4)); //Open Date
										jm.setS37(rs.getString(13)); // Closed Date
										jm.setS122(rs.getDate(13)); //closed date

										jm.setS42(rs.getInt(7)); // Deposit Amount
										jm.setS35(rs.getString(8)); // Period

										jm.setS36(rs.getString(12)); // Renewal No
										
										jm.setS38(sd.format(rs.getDate(5))); // Value date
										jm.setS123(rs.getDate(5)); //value date
										
										jm.setS39(rs.getString(14)); // Remarks
										
										//29-06-2022
										jm.setS40(rs.getString(17)); // Sc Name
										
										//28-07-2022
										jm.setS131(rs.getString(18)); // Sc Name
										jm.setS132(rs.getString(19)); // Sc Name
										jm.setS124(rs.getDate(20)); // Maturity date
										jm.setS20(rs.getFloat(21));//Closure_Amount
										jm.setS100(rs.getFloat(6)); // interest rate

										//jm.setS135(rs.getString(22));
										//jm.setS136(rs.getString(23));
										
										//05-02-2024
										jm.setS43(rs.getInt(10)); // Closing Balance


										return jm;
									}
								});
			}
			
			
			public List<SimpleBranch> getFD_Monthly_Report_Closed_Renewal(String Monthly_From_Date,
					String Monthly_To_Date, String Scheme_Code, int Bcode) {
				// --Set Connection------------------------------------
				int j = Bcode;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  in  (select renewal_no from fd_master where renewal_no is not null) order by Account_No";
				
				//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
				//29-06-2022
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  in  (select renewal_no from fd_master where renewal_no is not null) order by Account_No";

				//28-07-2022 New
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,nvl(Renewal_No,'0') as Renewal_No ,Closed_Date,nvl(Renewal_No,'0') as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname ,Maturity_date,(select a.transaction_amount as closure_amt from (select transaction_amount from daily_transaction_table where transaction_type='Credit' and flag='AC' and account_no=FD_Master_View.Account_no order by transaction_date desc)a where rownum=1) as closure_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  in  (select renewal_no from fd_master_View where renewal_no is not null) order by Branch,Account_No";

				//03-08-2022 debit AC
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,nvl(Renewal_No,'0') as Renewal_No ,Closed_Date,nvl(Renewal_No,'0') as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname ,Maturity_date,(select a.transaction_amount as closure_amt from (select transaction_amount from daily_transaction_table where transaction_type='Debit' and flag='AC' and account_no=FD_Master_View.Account_no order by transaction_date desc)a where rownum=1) as closure_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  in  (select renewal_no from fd_master_View where renewal_no is not null) order by Branch,Account_No";

				//24-12-2022
				String sql="select a.*,b.transaction_amount from (Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,nvl(Renewal_No,'0') as Renewal_No ,Closed_Date,nvl(Renewal_No,'0') as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname ,Maturity_date from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  in  (select renewal_no from fd_master_View where renewal_no is not null) order by Branch,Account_No)a left join (select Account_no,nvl(sum(transaction_amount),0) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Debit' and flag in ('AC','INT') group by Account_no,transaction_date)b on a.Account_no=b.Account_no and a.Closed_date=b.Transaction_date"; 
//Rebecca
				//String sql="select a.*,b.transaction_amount from (Select Customer_Id,p1.Account_No,Customer_Name,p1.Open_Date,Value_Date,Interest_Rate,p1.Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,nvl(Renewal_No,'0') as Renewal_No ,Closed_Date,nvl(Renewal_No,'0') as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,p1.scheme_code,(Select scheme_name from scheme_Master where scheme_code=p1.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname ,Maturity_date,s1.Employee_Id,s1.Employee_Name from FD_Master_View p1 left join Employee_Target s1 on p1.Account_No=s1.Account_No where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and p1.Scheme_Code like '%"+Scheme_Code+"%' and p1.Account_no  in (select renewal_no from fd_master_View where renewal_no is not null) order by Branch,Account_No)a left join (select Account_no,nvl(sum(transaction_amount),0) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Debit' and flag in ('AC','INT') group by Account_no,transaction_date)b on a.Account_no=b.Account_no and a.Closed_date=b.Transaction_date"; 

				System.out.println("Renewal closed="+sql);
				
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(1));//customer id
										jm.setS31(rs.getString(2)); // Account No
										jm.setS32(rs.getString(3)); // Name

										jm.setS33(sd.format(rs.getDate(4))); // Open
																				// Date
										jm.setS121(rs.getDate(4)); //open date

										// jm.setS33(rs.getString(4)); //Open Date
										jm.setS37(sd.format(rs.getDate(13))); // Closed Date
										jm.setS122(rs.getDate(13)); //closed date

										jm.setS42(rs.getInt(7)); // Deposit Amount
										jm.setS35(rs.getString(8)); // Period

										jm.setS36(rs.getString(12)); // Renewal No
										
										jm.setS38(sd.format(rs.getDate(5))); // Value date
										jm.setS123(rs.getDate(5)); // value date
										
										jm.setS39(rs.getString(14)); // Remarks
										
										//29-06-2022
										jm.setS40(rs.getString(17)); // Sc Name

										//28-07-2022
										jm.setS131(rs.getString(18)); // bcode
										jm.setS132(rs.getString(19)); // Name
										jm.setS124(rs.getDate(20)); // Maturity date
										jm.setS20(rs.getFloat(21));//Closure_Amount
										jm.setS100(rs.getFloat(6)); // interest rate
										
										//jm.setS135(rs.getString(21));
										//jm.setS136(rs.getString(22));

										//05-02-2024
										jm.setS43(rs.getInt(10)); // Closing Balance

										return jm;
									}
								});
			}



			public int UpdateJL_Type(String Account_No,String JL_Type,String Type_Account,int Bcode){  

				//--Set Connection------------------------------------
							int j=Bcode;
							this.template=con.getCon2(j);
				//-----------------------------------------------------
			    String sql="update JL_Master set JL_Type='"+JL_Type+"',Type_Account_No='"+Type_Account+"' where Account_No='"+Account_No+"'";
			    System.out.println("jl type updation.........");
			    return template.update(sql);  
			    
			}

			
			
			public List<SimpleBranch> getFD_Monthly_Report_Closed_xl(String Monthly_From_Date,
					String Monthly_To_Date, String Scheme_Code, int Bcode) {
				// --Set Connection------------------------------------
				int j = Bcode;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  not in  (select renewal_no from fd_master where renewal_no is not null)order by Account_No";
				
				//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
				//29-06-2022
				System.out.println("inside dao-----------");
				String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  not in  (select renewal_no from fd_master where renewal_no is not null)order by Account_No";
				
				System.out.println("Closed="+sql);
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(1));//customer id
										jm.setS31(rs.getString(2)); // Account No
										jm.setS32(rs.getString(3)); // Name

										jm.setS33(sd.format(rs.getDate(4))); // Open
																				// Date
										jm.setS100(rs.getFloat(6)); // interest rate
										jm.setS141(rs.getDouble(9)); // maturity amount
										jm.setS121(rs.getDate(4)); //open date
										// jm.setS33(rs.getString(4)); //Open Date
										jm.setS122(rs.getDate(13)); //closed  date
										jm.setS37(sd.format(rs.getDate(13))); // Closed Date

										jm.setS42(rs.getInt(7)); // Deposit Amount
										jm.setS35(rs.getString(8)); // Period

										jm.setS36(rs.getString(12)); // Renewal No
										
										jm.setS123(rs.getDate(5)); // value date
										jm.setS38(sd.format(rs.getDate(5))); // Value date
										
										jm.setS39(rs.getString(14)); // Remarks
										
										
										//29-06-2022
										jm.setS40(rs.getString(17)); // Sc Name


										return jm;
									}
								});
			}
			

			public List<SimpleBranch> getFD_Monthly_Report_Active_xl(String Monthly_From_Date,
					String Monthly_To_Date, String Scheme_Code, int Bcode) {
				// --Set Connection------------------------------------
				int j = Bcode;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and renewal_no is null and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";
				
				//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
				//29-06-2022
				String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and renewal_no is null and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";

				
				System.out.println("Active="+sql);
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(1));//customer id
										jm.setS31(rs.getString(2)); // Account No
										jm.setS32(rs.getString(3)); // Name

										jm.setS33(sd.format(rs.getDate(4))); // Open
																				// Date
										jm.setS121(rs.getDate(4)); //open date
										// jm.setS33(rs.getString(4)); //Open Date
										jm.setS37(rs.getString(13)); // Closed Date
										jm.setS122(rs.getDate(13)); //closed date
										jm.setS100(rs.getFloat(6)); // interest rate
										jm.setS141(rs.getDouble(9)); // maturity amount
										
										jm.setS42(rs.getInt(7)); // Deposit Amount
										jm.setS35(rs.getString(8)); // Period

										jm.setS36(rs.getString(12)); // Renewal No
										
										jm.setS38(sd.format(rs.getDate(5))); // Value date
										jm.setS123(rs.getDate(5)); // value date
										
										jm.setS39(rs.getString(14)); // Remarks
										
										//29-06-2022
										jm.setS40(rs.getString(17)); // Sc Name


										return jm;
									}
								});
			}
			
			public List<SimpleBranch> getFD_Monthly_Report_Renewal_xl(String Monthly_From_Date,
					String Monthly_To_Date, String Scheme_Code, int Bcode) {
				// --Set Connection------------------------------------
				int j = Bcode;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy')  and to_number(renewal_no)>0 and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";
				//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
				//29-06-2022
				String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy')  and to_number(renewal_no)>0 and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";


				System.out.println("Renewal="+sql);
				
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(1));//customer id
										jm.setS31(rs.getString(2)); // Account No
										jm.setS32(rs.getString(3)); // Name

										jm.setS33(sd.format(rs.getDate(4))); // Open
																				// Date
										jm.setS121(rs.getDate(4)); //open date
										// jm.setS33(rs.getString(4)); //Open Date
										jm.setS37(rs.getString(13)); // Closed Date
										jm.setS122(rs.getDate(13)); //closed date

										jm.setS42(rs.getInt(7)); // Deposit Amount
										jm.setS35(rs.getString(8)); // Period
										jm.setS100(rs.getFloat(6)); // interest rate
										jm.setS141(rs.getDouble(9)); // maturity amount
										
										jm.setS36(rs.getString(12)); // Renewal No
										
										jm.setS38(sd.format(rs.getDate(5))); // Value date
										jm.setS123(rs.getDate(5)); //value date
										
										jm.setS39(rs.getString(14)); // Remarks
										
										//29-06-2022
										jm.setS40(rs.getString(17)); // Sc Name

										return jm;
									}
								});
			}
			
			
			public List<SimpleBranch> getFD_Monthly_Report_Closed_Renewal_xl(String Monthly_From_Date,
					String Monthly_To_Date, String Scheme_Code, int Bcode) {
				// --Set Connection------------------------------------
				int j = Bcode;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  in  (select renewal_no from fd_master where renewal_no is not null) order by Account_No";
				
				//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
				//29-06-2022
				String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  in  (select renewal_no from fd_master where renewal_no is not null) order by Account_No";

				
				System.out.println("Renewal closed="+sql);
				
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(1));//customer id
										jm.setS31(rs.getString(2)); // Account No
										jm.setS32(rs.getString(3)); // Name

										jm.setS33(sd.format(rs.getDate(4))); // Open
																				// Date
										jm.setS121(rs.getDate(4)); //open date

										// jm.setS33(rs.getString(4)); //Open Date
										jm.setS37(sd.format(rs.getDate(13))); // Closed Date
										jm.setS122(rs.getDate(13)); //closed date

										jm.setS42(rs.getInt(7)); // Deposit Amount
										jm.setS35(rs.getString(8)); // Period

										jm.setS36(rs.getString(12)); // Renewal No
										jm.setS100(rs.getFloat(6)); // interest rate
										jm.setS141(rs.getDouble(9)); // maturity amount
										
										jm.setS38(sd.format(rs.getDate(5))); // Value date
										jm.setS123(rs.getDate(5)); // value date
										
										jm.setS39(rs.getString(14)); // Remarks
										
										//29-06-2022
										jm.setS40(rs.getString(17)); // Sc Name


										return jm;
									}
								});
			}
			
			
			
			
			public int Check_CustomerValidity(String Cus_Id)
			{

				//--Set Connection----------------------------
				int j=Binfo;
				this.template=con.getCon2(j);
				//-----------------------------------------------------


				int i=0;
				String query = "Select nvl(count(*),0) from Customer_View where to_char(Customer_Id)='"+Cus_Id+"'";
				PreparedStatement pstmt = null;
				try {
					pstmt = template.getDataSource().getConnection().prepareStatement(query);
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
				ResultSet resultSet = null;
				try {
					resultSet = pstmt.executeQuery();
					//resultSet.next();
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
				
				try {
					if (resultSet!= null) {
						  while (resultSet.next()) {
							  i=resultSet.getInt(1);
						  }
					}
					
					
					//i=resultSet.getInt(1);
					
					//i=resultSet.getRow();
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
				
				return i;
			}
			
			
			
			public List<SimpleBranch> getRD_Monthly_Report_Active(String Monthly_From_Date,
					String Monthly_To_Date,String Status, int Bcode) {
				// --Set Connection------------------------------------
				int j = Binfo;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				String sql="select rownum,x.* ,0 as closure_Amount from (select  main_qry.branch_code,br.Branch_name,main_qry.Account_No,sc.scheme_name,main_qry.Customer_Id,main_qry.Customer_name,main_qry.Open_date,main_qry.Value_date,main_qry.interest_Rate,main_qry.period_months,main_qry.Deposit_Amount,main_qry.maturity_date,main_qry.Closed_Date,main_qry.No_of_inst_Paid,main_qry.Account_Status from (select a.*,nvl(c.Credit,0) -nvl(d.Debit,0) as cb from(select branch_code, Account_No,Scheme_Code,Customer_Id,Customer_name,Open_date,Value_date,interest_Rate,period_months,Deposit_Amount,maturity_date,Closed_Date,No_of_inst_Paid,Account_Status from RD_View2 where  Open_Date between to_date( '"+Monthly_From_Date+"','dd/MM/yyyy') and to_date( '"+Monthly_To_Date+"' ,'dd/MM/yyyy') and  Account_Status like '%A%' and to_char(Branch_code) like '%"+Bcode+"%' ORDER BY branch_code,scheme_code,Account_No)a left join (Select Account_No,nvl(sum(Transaction_Amount),0) as Credit from Daily_Transaction_table 	where Transaction_Date<=to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Transaction_Type='Credit'  AND FLAG IN ('AC','INT') group by Account_No) c 	on a.Account_No=c.Account_No 	left join 	(Select Account_No, nvl(sum(Transaction_Amount),0) as Debit from Daily_Transaction_table 	where Transaction_Date<=to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' AND FLAG IN ('AC','INT') group by Account_No) d 	on a.Account_No=d.Account_No)main_qry left join (select scheme_code,scheme_name from scheme_master) sc on main_qry.scheme_code=sc.scheme_code left join (select Branch_code,Branch_name from Branch_master) br on main_qry.branch_code=br.branch_code ORDER BY main_qry.branch_code,main_qry.scheme_code,main_qry.Account_No)x";

				
				System.out.println("Active="+sql);
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(6));//customer id
										jm.setS31(rs.getString(4)); // Account No
										jm.setS32(rs.getString(7)); // Name

										jm.setS33(sd.format(rs.getDate(8))); // Open					// Date
										jm.setS121(rs.getDate(8)); //open date
										jm.setS37(rs.getString(14)); // Closed Date
										//jm.setS122(rs.getDate(14)); //closed date
										
										jm.setS42(rs.getInt(12)); // Deposit Amount
										jm.setS35(rs.getString(11)+ " Months"); // Period
										jm.setS38(sd.format(rs.getDate(9))); // Value date
										jm.setS123(rs.getDate(9)); // value date
										
										
										//jm.setS39(rs.getString(14)); // Remarks
										
										//29-06-2022
										jm.setS40(rs.getString(5)); // Sc Name
										
										
										//28-07-2022
										jm.setS124(rs.getDate(13)); // Maturity date
										//jm.setS20(rs.getFloat(16));//Closure_Amount
										jm.setS39(rs.getString(16)); // Account Status
										jm.setS20(rs.getFloat(17));//Closure_Amount
									
										jm.setS100(rs.getFloat(10)); // interest rate
										
										jm.setS131(rs.getString(2)); // Account No
										jm.setS132(rs.getString(3)); // Name


										


										return jm;
									}
								});
			}

			public List<SimpleBranch> getRD_Monthly_Report_Closed(String Monthly_From_Date,
					String Monthly_To_Date,String Status, int Bcode) {
				// --Set Connection------------------------------------
				int j = Binfo;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
			//	String sql="select rownum,x.*,closure.closure_amt as closure_Amount  from (select  main_qry.branch_code,br.Branch_name,main_qry.Account_No,sc.scheme_name,main_qry.Customer_Id,main_qry.Customer_name,main_qry.Open_date,main_qry.Value_date,main_qry.interest_Rate,main_qry.period_months,main_qry.Deposit_Amount,main_qry.maturity_date,main_qry.Closed_Date,main_qry.No_of_inst_Paid,main_qry.Account_Status from (select a.*,nvl(c.Credit,0) -nvl(d.Debit,0) as cb from(select branch_code, Account_No,Scheme_Code,Customer_Id,Customer_name,Open_date,Value_date,interest_Rate,period_months,Deposit_Amount,maturity_date,Closed_Date,No_of_inst_Paid,Account_Status from RD_View2 where  Closed_Date between to_date( '"+Monthly_From_Date+"','dd/MM/yyyy') and to_date( '"+Monthly_To_Date+"' ,'dd/MM/yyyy') and  Account_Status like '%"+Status+"%' and to_char(Branch_code) like '%"+Bcode+"%' ORDER BY branch_code,scheme_code,Account_No)a left join (Select Account_No,nvl(sum(Transaction_Amount),0) as Credit from Daily_Transaction_table 	where Transaction_Date<=to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Transaction_Type='Credit'  AND FLAG IN ('AC','INT') group by Account_No) c 	on a.Account_No=c.Account_No 	left join 	(Select Account_No, nvl(sum(Transaction_Amount),0) as Debit from Daily_Transaction_table 	where Transaction_Date<=to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' AND FLAG IN ('AC','INT') group by Account_No) d 	on a.Account_No=d.Account_No)main_qry left join (select scheme_code,scheme_name from scheme_master) sc on main_qry.scheme_code=sc.scheme_code left join (select Branch_code,Branch_name from Branch_master) br on main_qry.branch_code=br.branch_code ORDER BY main_qry.branch_code,main_qry.scheme_code,main_qry.Account_No)x  left join (select a1.Account_no ,a1.transaction_amount as closure_amt from (select Account_no,transaction_amount from daily_transaction_table where transaction_type='Debit' and flag='AC' order by transaction_date desc)a1 where rownum=1)closure on x.Account_no=closure.Account_no";
//23-12-2022
				String sql="select rownum,x.*,closure.transaction_amount as closure_Amount  from (select  main_qry.branch_code,br.Branch_name,main_qry.Account_No,sc.scheme_name,main_qry.Customer_Id,main_qry.Customer_name,main_qry.Open_date,main_qry.Value_date,main_qry.interest_Rate,main_qry.period_months,main_qry.Deposit_Amount,main_qry.maturity_date,main_qry.Closed_Date,main_qry.No_of_inst_Paid,main_qry.Account_Status from (select a.*,nvl(c.Credit,0) -nvl(d.Debit,0) as cb from(select branch_code, Account_No,Scheme_Code,Customer_Id,Customer_name,Open_date,Value_date,interest_Rate,period_months,Deposit_Amount,maturity_date,Closed_Date,No_of_inst_Paid,Account_Status from RD_View2 where  Closed_Date between to_date( '"+Monthly_From_Date+"','dd/MM/yyyy') and to_date( '"+Monthly_To_Date+"' ,'dd/MM/yyyy') and  Account_Status like '%"+Status+"%' and to_char(Branch_code) like '%"+Bcode+"%' ORDER BY branch_code,scheme_code,Account_No)a left join (Select Account_No,nvl(sum(Transaction_Amount),0) as Credit from Daily_Transaction_table 	where Transaction_Date<=to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Transaction_Type='Credit'  AND FLAG IN ('AC','INT') group by Account_No) c 	on a.Account_No=c.Account_No 	left join 	(Select Account_No, nvl(sum(Transaction_Amount),0) as Debit from Daily_Transaction_table 	where Transaction_Date<=to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' AND FLAG IN ('AC','INT') group by Account_No) d 	on a.Account_No=d.Account_No)main_qry left join (select scheme_code,scheme_name from scheme_master) sc on main_qry.scheme_code=sc.scheme_code left join (select Branch_code,Branch_name from Branch_master) br on main_qry.branch_code=br.branch_code ORDER BY main_qry.branch_code,main_qry.scheme_code,main_qry.Account_No)x  left join (select Account_no,sum(transaction_amount) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Debit' and flag in ('AC','INT') group by Account_no,transaction_date )closure on x.Account_no=closure.Account_no and x.Closed_date=closure.Transaction_date";

				
				System.out.println("Close="+sql);
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(6));//customer id
										jm.setS31(rs.getString(4)); // Account No
										jm.setS32(rs.getString(7)); // Name

										jm.setS33(sd.format(rs.getDate(8))); // Open					// Date
										jm.setS121(rs.getDate(8)); //open date
										jm.setS37(rs.getString(14)); // Closed Date
										jm.setS122(rs.getDate(14)); //closed date
										
										jm.setS42(rs.getInt(12)); // Deposit Amount
										jm.setS35(rs.getString(11)+ " Months"); // Period
										jm.setS38(sd.format(rs.getDate(9))); // Value date
										jm.setS123(rs.getDate(9)); // value date
										
										
										//jm.setS39(rs.getString(14)); // Remarks
										
										//29-06-2022
										jm.setS40(rs.getString(5)); // Sc Name
										
										
										//28-07-2022
										jm.setS124(rs.getDate(13)); // Maturity date
										jm.setS39(rs.getString(16)); // Account Status
										jm.setS20(rs.getFloat(17));//Closure_Amount
										jm.setS100(rs.getFloat(10)); // interest rate
										
										jm.setS131(rs.getString(2)); // Account No
										jm.setS132(rs.getString(3)); // Name


										


										return jm;
									}
								});
			}

			
			public List<SimpleBranch> getRD_Monthly_Report_Active_Closed(String Monthly_From_Date,
					String Monthly_To_Date,String Status, int Bcode) {
				// --Set Connection------------------------------------
				int j = Binfo;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				//String sql="select rownum,x.*,closure.closure_amt as closure_Amount  from (select  main_qry.branch_code,br.Branch_name,main_qry.Account_No,sc.scheme_name,main_qry.Customer_Id,main_qry.Customer_name,main_qry.Open_date,main_qry.Value_date,main_qry.interest_Rate,main_qry.period_months,main_qry.Deposit_Amount,main_qry.maturity_date,main_qry.Closed_Date,main_qry.No_of_inst_Paid,main_qry.Account_Status from (select a.*,nvl(c.Credit,0) -nvl(d.Debit,0) as cb from(select branch_code, Account_No,Scheme_Code,Customer_Id,Customer_name,Open_date,Value_date,interest_Rate,period_months,Deposit_Amount,maturity_date,Closed_Date,No_of_inst_Paid,Account_Status from RD_View2 where  (Open_Date between to_date( '"+Monthly_From_Date+"','dd/MM/yyyy') and to_date( '"+Monthly_To_Date+"' ,'dd/MM/yyyy') or Closed_Date between to_date( '"+Monthly_From_Date+"','dd/MM/yyyy') and to_date( '"+Monthly_To_Date+"' ,'dd/MM/yyyy')) and  Account_Status like '%"+Status+"%' and to_char(Branch_code) like '%"+Bcode+"%' ORDER BY branch_code,scheme_code,Account_No)a left join (Select Account_No,nvl(sum(Transaction_Amount),0) as Credit from Daily_Transaction_table 	where Transaction_Date<=to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Transaction_Type='Credit'  AND FLAG IN ('AC','INT') group by Account_No) c 	on a.Account_No=c.Account_No 	left join 	(Select Account_No, nvl(sum(Transaction_Amount),0) as Debit from Daily_Transaction_table 	where Transaction_Date<=to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' AND FLAG IN ('AC','INT') group by Account_No) d 	on a.Account_No=d.Account_No)main_qry left join (select scheme_code,scheme_name from scheme_master) sc on main_qry.scheme_code=sc.scheme_code left join (select Branch_code,Branch_name from Branch_master) br on main_qry.branch_code=br.branch_code ORDER BY main_qry.branch_code,main_qry.scheme_code,main_qry.Account_No)x  left join (select a1.Account_no ,a1.transaction_amount as closure_amt from (select Account_no,transaction_amount from daily_transaction_table where transaction_type='Debit' and flag='AC' order by transaction_date desc)a1 where rownum=1)closure on x.Account_no=closure.Account_no";
//23-12-2022
				String sql="select rownum,x.*,closure.Transaction_amount as closure_Amount  from (select  main_qry.branch_code,br.Branch_name,main_qry.Account_No,sc.scheme_name,main_qry.Customer_Id,main_qry.Customer_name,main_qry.Open_date,main_qry.Value_date,main_qry.interest_Rate,main_qry.period_months,main_qry.Deposit_Amount,main_qry.maturity_date,main_qry.Closed_Date,main_qry.No_of_inst_Paid,main_qry.Account_Status from (select a.*,nvl(c.Credit,0) -nvl(d.Debit,0) as cb from(select branch_code, Account_No,Scheme_Code,Customer_Id,Customer_name,Open_date,Value_date,interest_Rate,period_months,Deposit_Amount,maturity_date,Closed_Date,No_of_inst_Paid,Account_Status from RD_View2 where  (Open_Date between to_date( '"+Monthly_From_Date+"','dd/MM/yyyy') and to_date( '"+Monthly_To_Date+"' ,'dd/MM/yyyy') or Closed_Date between to_date( '"+Monthly_From_Date+"','dd/MM/yyyy') and to_date( '"+Monthly_To_Date+"' ,'dd/MM/yyyy')) and  Account_Status like '%"+Status+"%' and to_char(Branch_code) like '%"+Bcode+"%' ORDER BY branch_code,scheme_code,Account_No)a left join (Select Account_No,nvl(sum(Transaction_Amount),0) as Credit from Daily_Transaction_table 	where Transaction_Date<=to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Transaction_Type='Credit'  AND FLAG IN ('AC','INT') group by Account_No) c 	on a.Account_No=c.Account_No 	left join 	(Select Account_No, nvl(sum(Transaction_Amount),0) as Debit from Daily_Transaction_table 	where Transaction_Date<=to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' AND FLAG IN ('AC','INT') group by Account_No) d 	on a.Account_No=d.Account_No)main_qry left join (select scheme_code,scheme_name from scheme_master) sc on main_qry.scheme_code=sc.scheme_code left join (select Branch_code,Branch_name from Branch_master) br on main_qry.branch_code=br.branch_code ORDER BY main_qry.branch_code,main_qry.scheme_code,main_qry.Account_No)x  left join (select Account_no,sum(transaction_amount) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Debit' and flag in ('AC','INT') group by Account_no,transaction_date )closure on x.Account_no=closure.Account_no and x.Closed_date=closure.Transaction_date";

				
				System.out.println("Close="+sql);
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(6));//customer id
										jm.setS31(rs.getString(4)); // Account No
										jm.setS32(rs.getString(7)); // Name

										jm.setS33(sd.format(rs.getDate(8))); // Open					// Date
										jm.setS121(rs.getDate(8)); //open date
										jm.setS37(rs.getString(14)); // Closed Date
										jm.setS122(rs.getDate(14)); //closed date
										
										jm.setS42(rs.getInt(12)); // Deposit Amount
										jm.setS35(rs.getString(11)+ " Months"); // Period
										jm.setS38(sd.format(rs.getDate(9))); // Value date
										jm.setS123(rs.getDate(9)); // value date
										
										
										//jm.setS39(rs.getString(14)); // Remarks
										
										//29-06-2022
										jm.setS40(rs.getString(5)); // Sc Name
										
										
										//28-07-2022
										jm.setS124(rs.getDate(13)); // Maturity date
										jm.setS39(rs.getString(16)); // Account Status
										jm.setS20(rs.getFloat(17));//Closure_Amount
										jm.setS100(rs.getFloat(10)); // interest rate
										
										jm.setS131(rs.getString(2)); // Account No
										jm.setS132(rs.getString(3)); // Name


										


										return jm;
									}
								});
			}


			
			//23-11-2022
			public List<SimpleBranch> getJL_Monthly_ConsolidatedReport(String sql, int Bcode) {
				// --Set Connection------------------------------------
				int j = Binfo;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				
				System.out.println("Active New="+sql);
				return template
						.query(sql,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										/*jm.setS131(rs.getString(1)); // Account No
										jm.setS132(rs.getString(2)); // Name
										jm.setS31(rs.getString(3)); // Account No
										jm.setS40(rs.getString(4)); // Sc Name
										jm.setS36(rs.getString(5));//customer id
										jm.setS33(rs.getString(6)); // Name
										jm.setS121(rs.getDate(7)); //open date
										jm.setS100(rs.getFloat(8)); // interest rate
										jm.setS141(rs.getDouble(9));//Loan Amt
										jm.setS123(rs.getDate(10)); //Int Paid Upto
										jm.setS124(rs.getDate(11)); //Due date
										jm.setS142(rs.getDouble(12));//CB
										//jm.setS122(rs.getDate(14)); //Closed date
										jm.setS32(rs.getString(14)); // Name
										jm.setS34(rs.getString(13)); // Status
//									
										

										//24-12-2022
									      jm.setS143(rs.getDouble(15));//Closure_Amt
*/

										jm.setS131(rs.getString("Branch_Code")); // Account No
										jm.setS132(rs.getString("Bname")); // Name
										jm.setS31(rs.getString("Account_No")); // Account No
										jm.setS40(rs.getString("Sname")); // Sc Name
										jm.setS36(rs.getString("Customer_Id"));//customer id
										jm.setS33(rs.getString("Customer_Name")); // Name
										jm.setS121(rs.getDate("Open_Date")); //open date
										jm.setS100(rs.getFloat("Interest_Rate")); // interest rate
										jm.setS141(rs.getDouble("Loan_Amount"));//Loan Amt
										jm.setS123(rs.getDate("Interest_Paid_Upto")); //Int Paid Upto
										jm.setS124(rs.getDate("Due_Date")); //Due date
										jm.setS142(rs.getDouble("Closing_Balance"));//CB
										//jm.setS122(rs.getDate(14)); //Closed date
										jm.setS32(rs.getString("Closed_Date")); // Name
										jm.setS34(rs.getString("Account_Status")); // Status
//										//24-12-2022
									      jm.setS143(rs.getDouble("Closure_Amount"));//Closure_Amt
									      
									      //10-09-2024
									      jm.setS38(rs.getString("JL_PACKET_NO"));
										return jm;
									}
								});
			}

			public List<SimpleBranch> getLAD_Monthly_Report_Active_Closed(String Monthly_From_Date,
					String Monthly_To_Date,String Status, int Bcode) {
				// --Set Connection------------------------------------
				int j = Binfo;
				this.template = con.getCon2(j);
				// -----------------------------------------------------
				//String sql="select a.Branch,(select branch_name from branch_master where branch_code=a.branch) as bname,a.Account_No,(select scheme_name from scheme_master where scheme_code=a.scheme_code) as sname,a.Customer_name,Customer_id,a.open_date,a.interest_paid_upto,a.Due_date,a.interest_rate,a.Loan_Amount,(-1)*a.Closing_balance,a.Closed_date,'' as Closure_Amount,a.Account_Status,b.DEPOSIT_NO,b.DEPOSIT_TYPE,c.value_date,c.Deposit_Amount,c.interest_rate as Dep_Roi,c.MAturity_date from (select BRANCH,ACCOUNT_NO,ACCOUNT_STATUS,CUSTOMER_ID,OPEN_DATE,BRANCH_CODE,SCHEME_CODE,DUE_DATE,INTEREST_PAID_UPTO,CLOSING_BALANCE,LOAN_AMOUNT,CUSTOMER_NAME,INTEREST_RATE,CLOSED_DATE from ol_master_view3 where  scheme_code !='80001' and (open_date between to_date('"+Monthly_From_Date+"') and to_date('"+Monthly_To_Date+"') or open_date between to_date('"+Monthly_From_Date+"') and to_date('"+Monthly_To_Date+"'))  and Account_status like '%"+Status+"%' and Branch like '%"+Bcode+"')a  left join (select BNAME,LOAN_NO,DEPOSIT_NO,LOAN_STATUS,DEPOSIT_STATUS,DEPOSIT_TYPE from lien_view )b on a.Account_no=b.LOAN_NO left join (select Account_no,value_date,Deposit_Amount,interest_rate,MAturity_date from FD_Master_View union select to_char(Account_no) as account_no,value_date,Deposit_Amount,interest_rate,MAturity_date from RD_View union select Account_no,open_date,CLOSING_BALANCE,0,MAturity_date from SBCA_View )c on b.Deposit_no=c.account_no order by a.branch,a.account_no,b.deposit_no";
				//String Sql_Final="select a.*,nvl(b.transaction_amount,0) as Closure_Amount from ("+sql+")a left join (select Account_no,nvl(sum(transaction_amount),0) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Credit' and flag in ('AC','INT') group by Account_no,transaction_date)b on a.Account_no=b.Account_no and a.Closed_date=b.Transaction_date";
				String Sql_Final="select a.Branch,(select branch_name from branch_master where branch_code=a.branch) as bname,a.Account_No,(select scheme_name from scheme_master where scheme_code=a.scheme_code) as sname,a.Customer_name,Customer_id,a.open_date,a.interest_paid_upto,a.Due_date,a.interest_rate,a.Loan_Amount,(-1)*a.Closing_balance,a.Closed_date,c.transaction_amount as Closure_Amount,a.Account_Status,DEP_AMT,Dep_Details from ol_master_view3 a left join (SELECT LOAN_NO,sum(NVL(CURR_BALANCE,0)) as DEP_AMT,LISTAGG(Deposit_Type||'-'||Account_no||' dt '||Open_Date || ' - Rs.' || NVL(CURR_BALANCE,0) || ' @ '|| Interest_Rate||'%', CHR(10)) WITHIN GROUP (ORDER BY Account_no) as Dep_Details FROM lien_view left join (select Account_no,Open_Date,value_date,Deposit_Amount,interest_rate,Maturity_date from FD_Master_View union select to_char(Account_no) as account_no,Open_Date,value_date,Deposit_Amount,interest_rate,Maturity_date from RD_View union select Account_no,open_date,open_date as value_Date,CLOSING_BALANCE,0 as Interest_Rate,Maturity_date from SBCA_View) FD_Master on lien_view.Deposit_No=FD_Master.Account_No GROUP BY LOAN_NO) b on a.Account_No = b.Loan_No left join (select Account_no,nvl(sum(transaction_amount),0) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Credit' and flag in ('AC','INT') group by Account_no,transaction_date)c on a.Account_No = c.Account_No and a.Closed_Date=c.transaction_date where a.scheme_code !='80001' and (open_date between to_date('"+Monthly_From_Date+"') and to_date('"+Monthly_To_Date+"') or closed_date between to_date('"+Monthly_From_Date+"') and to_date('"+Monthly_To_Date+"')) and Account_status like '%"+Status+"%' and Branch like '%"+Bcode+"%'";

				////202411712  19-12-2024
				if(Status.equalsIgnoreCase(null) && Status.isEmpty() || Status.equalsIgnoreCase("") || Status.length()==0)
						Sql_Final="select a.Branch,(select branch_name from branch_master where branch_code=a.branch) as bname,a.Account_No,(select scheme_name from scheme_master where scheme_code=a.scheme_code) as sname,a.Customer_name,Customer_id,a.open_date,a.interest_paid_upto,a.Due_date,a.interest_rate,a.Loan_Amount,(-1)*a.Closing_balance,a.Closed_date,c.transaction_amount as Closure_Amount,a.Account_Status,DEP_AMT,Dep_Details from ol_master_view3 a left join (SELECT LOAN_NO,sum(NVL(CURR_BALANCE,0)) as DEP_AMT,LISTAGG(Deposit_Type||'-'||Account_no||' dt '||Open_Date || ' - Rs.' || NVL(CURR_BALANCE,0) || ' @ '|| Interest_Rate||'%', CHR(10)) WITHIN GROUP (ORDER BY Account_no) as Dep_Details FROM lien_view left join (select Account_no,Open_Date,value_date,Deposit_Amount,interest_rate,Maturity_date from FD_Master_View union select to_char(Account_no) as account_no,Open_Date,value_date,Deposit_Amount,interest_rate,Maturity_date from RD_View union select Account_no,open_date,open_date as value_Date,CLOSING_BALANCE,0 as Interest_Rate,Maturity_date from SBCA_View) FD_Master on lien_view.Deposit_No=FD_Master.Account_No GROUP BY LOAN_NO) b on a.Account_No = b.Loan_No left join (select Account_no,nvl(sum(transaction_amount),0) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Credit' and flag in ('AC','INT') group by Account_no,transaction_date)c on a.Account_No = c.Account_No and a.Closed_Date=c.transaction_date where a.scheme_code !='80001' and (open_date between to_date('"+Monthly_From_Date+"') and to_date('"+Monthly_To_Date+"') or closed_date between to_date('"+Monthly_From_Date+"') and to_date('"+Monthly_To_Date+"')) and Account_status !='R' and Branch like '%"+Bcode+"%'";
				
				System.out.println("LAD ="+Sql_Final);
				return template
						.query(Sql_Final,
								new RowMapper<SimpleBranch>() {
									public SimpleBranch mapRow(ResultSet rs, int row)
											throws SQLException {
										SimpleDateFormat sd = new SimpleDateFormat(
												"dd/MM/yyyy");

										SimpleBranch jm = new SimpleBranch();
										jm.setS1(rs.getInt(6));//customer id
										jm.setS31(rs.getString(3)); // Account No
										jm.setS32(rs.getString(5)); // Name

										jm.setS33(sd.format(rs.getDate(7))); // Open					// Date
										jm.setS121(rs.getDate(7)); //open date
										jm.setS37(rs.getString(13)); // Closed Date
										jm.setS122(rs.getDate(13)); //closed date
										
										jm.setS42(rs.getInt(11)); // Deposit Amount
										jm.setS35(rs.getString(12)); // CB
										jm.setS38(sd.format(rs.getDate(8))); // Value date
										jm.setS123(rs.getDate(8)); // value date
										
										
										//jm.setS39(rs.getString(14)); // Remarks
										
										//29-06-2022
										jm.setS40(rs.getString(4)); // Sc Name
										
										
										//28-07-2022
										jm.setS124(rs.getDate(9)); // Maturity date
										jm.setS39(rs.getString(15)); // Account Status
										jm.setS20(rs.getFloat(16));//DEp Amt
										jm.setS100(rs.getFloat(10)); // interest rate
										
										jm.setS131(rs.getString(1)); // Account No
										jm.setS132(rs.getString(2)); // Name

jm.setS71(rs.getString(17));//type
jm.setS52(rs.getFloat(14));//Closure Amt*
//jm.setS11(rs.getInt(16));//FD Deposit Amt
/*jm.setS125(rs.getDate(18)); // FD opendate 
jm.setS11(rs.getInt(19));//FD Deposit Amt
jm.setS51(rs.getFloat(20));//FD roi
jm.setS126(rs.getDate(21)); // FD Mat Date 
jm.setS52(rs.getFloat(22));//Closure Amt*/


										


										return jm;
									}
								});
			}
			
			
			
			//07-02-2023
			public List<SimpleBranch> getJLStock(String qry) {
		    					// --Set Connection------------------------------------
		    					int j = Binfo;
		    					this.template = con.getCon2(j);
		    					// -----------------------------------------------------
		    				//old	String qry="Select Jewel_Details.Account_No,Customer_Name,No_of_Items,JL_Master.Gross_Weight as Gross_Weight,JL_Master.Net_Weight as Net_Weight,Loan_Amount,-Closing_Balance as CB from (Select Account_No,sum(No_of_Items) as No_of_Items from Jewel_Details group by Account_No) Jewel_Details join JL_Master on JL_Master.Account_No=Jewel_Details.Account_No  where Account_Status='A'";
		    					//new 26-10-2021
		    					//String qry="select mq.Account_no,mq.Customer_name,mq.no_of_items,mq.gross_weight,mq.net_weight,mq.loan_amount,mq.cb from(select a.*,b.customer_name,b.loan_amount,b.CB from (Select Account_No,sum(No_of_Items) as No_of_Items,sum(gross_weight) as gross_weight,sum(net_weight) as net_weight from Jewel_Details where Account_no in (select account_no from jl_master where account_status='A') group by Account_No)a left join (select Account_no,customer_name,loan_amount,-Closing_Balance as CB from jl_master where account_status='A')b on a.account_no=b.account_no)mq";

		    					
		    					
		    					return template	.query(qry,
		    									new RowMapper<SimpleBranch>() {
		    										public SimpleBranch mapRow(ResultSet rs, int row)
		    												throws SQLException {
		    											SimpleBranch gl = new SimpleBranch();
		    											
		    										/*	gl.setS2(rs.getString(3)); // ACCOUNT NO
		    											gl.setS3(rs.getString(8)); // CUSTOMER NAME
		    											gl.setS1(rs.getInt(9)); // No of Items
		    											gl.setS13(rs.getFloat(10)); // Gross Weight
		    											gl.setS14(rs.getFloat(11)); // Net Weight
		    											gl.setS11(rs.getInt(12)); // Loan Amount
		    											gl.setS12(rs.getInt(13)); // Loan O/s
		    											
		    											gl.setS31(rs.getString(1)); // Branch
		    											gl.setS32(rs.getString(2)); // Branch Name
		    											gl.setS33(rs.getString(4)); // Scheme_Name
		    											gl.setS34(rs.getString(5)); // Scheme Code
		    											gl.setS35(rs.getString(16)); // Customer Id
		    											
		    											gl.setS36(rs.getString(17)); // rpg List
		    											gl.setS37(rs.getString(18)); // Purity List
		    											gl.setS121(rs.getDate(6));  //open date
*/
		    											
		    											gl.setS2(rs.getString("Account_No")); // ACCOUNT NO
		    											gl.setS3(rs.getString("Customer_Name")); // CUSTOMER NAME
		    											gl.setS1(rs.getInt("No_Of_Items")); // No of Items
		    											gl.setS13(rs.getFloat("Gross_Weight")); // Gross Weight
		    											gl.setS14(rs.getFloat("Net_Weight")); // Net Weight
		    											gl.setS11(rs.getInt("Loan_Amount")); // Loan Amount
		    											gl.setS12(rs.getInt("CB")); // Loan O/s
		    											
		    											gl.setS31(rs.getString("Branch")); // Branch
		    											gl.setS32(rs.getString("Bname")); // Branch Name
		    											gl.setS33(rs.getString("Scheme_Name")); // Scheme_Name
		    											gl.setS34(rs.getString("Scheme_Code")); // Scheme Code
		    											gl.setS35(rs.getString("Customer_Id")); // Customer Id
		    											
		    											gl.setS36(rs.getString("RPG_List")); // rpg List
		    											gl.setS37(rs.getString("Purity_List")); // Purity List
		    											gl.setS121(rs.getDate("Open_Date"));  //open date
		    											//12-09-2024
		    											gl.setS39(rs.getString("JL_Packet_No")); // Purity List



		    											return gl;
		    										}
		    									});
		    				}

		    				//31.Get Branch_Code
		    				public List<Simple> getScheme_List(String type){
		    					//--Set Connection------------------------------------
		    					int j=Binfo;
		    					this.template=con.getCon2(j);
		    		//-----------------------------------------------------
		    					return template.query("select to_char(Scheme_Code||'-'||Scheme_Name) from Scheme_Master where Scheme_Category='"+type+"' and Status='A'",new RowMapper<Simple>(){   public Simple mapRow(ResultSet rs, int row) throws SQLException
		    					{  

		    						Simple gl=new Simple();
		    						gl.setS2(rs.getString(1));
		    						
		    									//System.out.println("Branch List from db"+rs.getInt(1));	
		    						return gl;
		    					}
		    					 }     );
		    				}



		    	 public int UpdateDATA(String sql,int BCode)
		    											{  
		    												//--Set Connection----------------------------
		    												int j=BCode;
		    												this.template=con.getCon2(j);
		    												//-----------------------------------------------------
		    												
		    												 template.update(sql);
		    												 
		    												return 1;
		    											}
		    	 
		    	 
		    	 
		    	 
		    	 //03-10-2023
		    	//07-02-2023
					public List<SimpleBranch> getJL_OS(String qry) {
				    					// --Set Connection------------------------------------
				    					int j = Binfo;
				    					this.template = con.getCon2(j);
				    					// -----------------------------------------------------
				    			
				    					
				    					
				    					return template	.query(qry,
				    									new RowMapper<SimpleBranch>() {
				    										public SimpleBranch mapRow(ResultSet rs, int row)
				    												throws SQLException {
				    											SimpleBranch gl = new SimpleBranch();
				    											
				    											gl.setS2(rs.getString(3)); // ACCOUNT NO
				    											gl.setS3(rs.getString(8)); // CUSTOMER NAME
				    											gl.setS1(rs.getInt(9)); // No of Items
				    											gl.setS13(rs.getFloat(10)); // Gross Weight
				    											gl.setS14(rs.getFloat(11)); // Net Weight
				    											gl.setS11(rs.getInt(12)); // Loan Amount
				    											gl.setS12(rs.getInt(13)); // Loan O/s
				    											
				    											gl.setS31(rs.getString(1)); // Branch
				    											gl.setS32(rs.getString(2)); // Branch Name
				    											gl.setS33(rs.getString(4)); // Scheme_Name
				    											gl.setS34(rs.getString(5)); // Scheme Code
				    											gl.setS35(rs.getString(16)); // Customer Id
				    											
				    											gl.setS36(rs.getString(17)); // rpg List
				    											gl.setS37(rs.getString(18)); // Purity List
				    											gl.setS38(rs.getString(19)); // ROI

				    											return gl;
				    										}
				    									});
				    				}
					
					public List<SimpleBranch> getFD_Monthly_Report_Closed_new(String Monthly_From_Date,
							String Monthly_To_Date, String Scheme_Code, int Bcode) {
						// --Set Connection------------------------------------
						int j = Bcode;
						this.template = con.getCon2(j);
						// -----------------------------------------------------
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  not in  (select renewal_no from fd_master where renewal_no is not null)order by Account_No";
						
						//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
						//29-06-2022
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  not in  (select renewal_no from fd_master where renewal_no is not null)order by Account_No";
						//28-07-2022
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date,(select a.transaction_amount as closure_amt from (select transaction_amount from daily_transaction_table where transaction_type='Credit' and flag='AC' and account_no=FD_Master_View.Account_no order by transaction_date desc)a where rownum=1) as closure_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  not in  (select renewal_no from fd_master_View where renewal_no is not null)order by Branch,Account_No";

						//03-08-2022
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date,(select a.transaction_amount as closure_amt from (select transaction_amount from daily_transaction_table where transaction_type='Debit' and flag='AC' and account_no=FD_Master_View.Account_no order by transaction_date desc)a where rownum=1) as closure_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  not in  (select renewal_no from fd_master_View where renewal_no is not null)order by Branch,Account_No";

						//24-12-2022
						//String sql="select a.*,b.transaction_amount from (Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  not in  (select renewal_no from fd_master_View where renewal_no is not null)order by Branch,Account_No)a left join (select Account_no,nvl(sum(transaction_amount),0) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Debit' and flag in ('AC','INT') group by Account_no,transaction_date)b on a.Account_no=b.Account_no and a.Closed_date=b.Transaction_date";
						//04-05-2023
						//String sql="select a.* from (Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date,(select Total from (Select Principal+Interest+Penalty-Lien_Prin-Lien_Int as Total from Voucher_print_view where Account_No=cast(FD_Master_View.Account_No as varchar2(20)) order by Transaction_Date desc,to_number(substr(to_char(Transaction_Id),-5,5)) desc) a where ROWNUM=1)  as transaction_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  not in (select renewal_no from fd_master_View where renewal_no is not null)order by Branch,Account_No)a";
						//01-07-2023
						//String sql="select a.* from (Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date,(Select sum(Principal+Interest+Penalty) from Voucher_print_view where Page_Source in ('FDC','FDR') and Account_No=cast(FD_Master_View.Account_No as varchar2(20)) and Transaction_Date=FD_Master_View.Closed_Date)  as transaction_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  not in (select renewal_no from fd_master_View where renewal_no is not null)order by Branch,Account_No)a";
						//rebecca
						String sql="select a.* from (Select Customer_Id,s1.Account_No,Customer_Name,s1.Open_Date,Value_Date,Interest_Rate,s1.Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,s1.scheme_code,(Select scheme_name from scheme_Master where scheme_code=s1.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_date,(Select sum(Principal+Interest+Penalty) from Voucher_print_view where Page_Source in ('FDC','FDR') and Account_No=cast(s1.Account_No as varchar2(20)) and Transaction_Date=s1.Closed_Date)  as transaction_amount,p1.Employee_Id, p1.Employee_Name from FD_Master_View s1 left join Employee_Target p1 on s1.Account_No=p1.Account_No where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and s1.Scheme_Code like '%"+Scheme_Code+"%' and s1.Account_no  not in (select renewal_no from fd_master_View a left join Employee_Target b on a.Account_no=b.Account_No where renewal_no is not null)order by Branch,s1.Account_No)a";
						
						System.out.println("Closed="+sql);
						return template
								.query(sql,
										new RowMapper<SimpleBranch>() {
											public SimpleBranch mapRow(ResultSet rs, int row)
													throws SQLException {
												SimpleDateFormat sd = new SimpleDateFormat(
														"dd/MM/yyyy");

												SimpleBranch jm = new SimpleBranch();
												jm.setS1(rs.getInt(1));//customer id
												jm.setS31(rs.getString(2)); // Account No
												jm.setS32(rs.getString(3)); // Name

												jm.setS33(sd.format(rs.getDate(4))); // Open
																						// Date

												jm.setS121(rs.getDate(4)); //open date
												// jm.setS33(rs.getString(4)); //Open Date
												jm.setS122(rs.getDate(13)); //closed  date
												jm.setS37(sd.format(rs.getDate(13))); // Closed Date

												jm.setS42(rs.getInt(7)); // Deposit Amount
												jm.setS35(rs.getString(8)); // Period

												jm.setS36(rs.getString(12)); // Renewal No
												
												jm.setS123(rs.getDate(5)); // value date
												jm.setS38(sd.format(rs.getDate(5))); // Value date
												
												jm.setS39(rs.getString(14)); // Remarks
												
												
												//29-06-2022
												jm.setS40(rs.getString(17)); // Sc Name
												
												//28-07-2022
												jm.setS131(rs.getString(18)); // Sc Name
												jm.setS132(rs.getString(19)); // Sc Name
												jm.setS124(rs.getDate(20)); // Maturity date
												jm.setS20(rs.getFloat(21));//Closure_Amount
												jm.setS100(rs.getFloat(6)); // interest rate

												
												jm.setS135(rs.getString(22));
												jm.setS136(rs.getString(23));



												return jm;
											}
										});
					}
					
					public List<SimpleBranch> getFD_Monthly_Report_Active_new(String Monthly_From_Date,
							String Monthly_To_Date, String Scheme_Code, int Bcode) {
						// --Set Connection------------------------------------
						int j = Bcode;
						this.template = con.getCon2(j);
						// -----------------------------------------------------
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and renewal_no is null and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";
						
						//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
						//29-06-2022
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and renewal_no is null and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";

						//28-07-2022
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_Date,0.0 as closure_Amount,(select Employee_Id from Employee_Target where Account_No=FD_Master_View.Account_No) as Emp_Id,(select Employee_Name from Employee_Target where Account_No=FD_Master_View.Account_No) as Emp_Name from FD_Master_View where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and renewal_no is null and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Branch,Account_No";
						//Rebecca
						String sql="Select Customer_Id,a.Account_No,Customer_Name,a.Open_Date,Value_Date,Interest_Rate,a.Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,a.scheme_code,(Select scheme_name from scheme_Master where scheme_code=a.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_Date,0.0 as closure_Amount,b.Employee_Id,b.Employee_Name from FD_Master_View a left join Employee_Target b on a.Account_No=b.Account_No where a.Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and renewal_no is null and Account_Status='A' and a.Scheme_Code like '%" + Scheme_Code + "%' order by Branch,a.Account_No";

						
						System.out.println("Active="+sql);
						return template
								.query(sql,
										new RowMapper<SimpleBranch>() {
											public SimpleBranch mapRow(ResultSet rs, int row)
													throws SQLException {
												SimpleDateFormat sd = new SimpleDateFormat(
														"dd/MM/yyyy");

												SimpleBranch jm = new SimpleBranch();
												jm.setS1(rs.getInt(1));//customer id
												jm.setS31(rs.getString(2)); // Account No
												jm.setS32(rs.getString(3)); // Name

												jm.setS33(sd.format(rs.getDate(4))); // Open
																						// Date
												jm.setS121(rs.getDate(4)); //open date
												// jm.setS33(rs.getString(4)); //Open Date
												jm.setS37(rs.getString(13)); // Closed Date
												jm.setS122(rs.getDate(13)); //closed date
												
												jm.setS42(rs.getInt(7)); // Deposit Amount
												jm.setS35(rs.getString(8)); // Period

												jm.setS36(rs.getString(12)); // Renewal No
												
												jm.setS38(sd.format(rs.getDate(5))); // Value date
												jm.setS123(rs.getDate(5)); // value date
												
												jm.setS39(rs.getString(14)); // Remarks
												
												//29-06-2022
												jm.setS40(rs.getString(17)); // Sc Name
												
												
												//28-07-2022
												jm.setS131(rs.getString(18)); // Sc Name
												jm.setS132(rs.getString(19)); // Sc Name
												jm.setS124(rs.getDate(20)); // Maturity date
												jm.setS20(rs.getFloat(21));//Closure_Amount
												jm.setS100(rs.getFloat(6)); // interest rate

		jm.setS135(rs.getString(22));
		jm.setS136(rs.getString(23));


												return jm;
											}
										});
					}
					
					public List<SimpleBranch> getFD_Monthly_Report_Renewal_new(String Monthly_From_Date,
							String Monthly_To_Date, String Scheme_Code, int Bcode) {
						// --Set Connection------------------------------------
						int j = Bcode;
						this.template = con.getCon2(j);
						// -----------------------------------------------------
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy')  and to_number(renewal_no)>0 and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";
						//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
						//29-06-2022
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy')  and to_number(renewal_no)>0 and Account_Status='A' and Scheme_Code like '%" + Scheme_Code + "%' order by Account_No";

						//28-07-2022
						String sql="Select Customer_Id,p1.Account_No,Customer_Name,p1.Open_Date,Value_Date,Interest_Rate,p1.Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,p1.scheme_code,(Select scheme_name from scheme_Master where scheme_code=p1.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname,Maturity_Date,0.0 as closure_Amount,s1.Employee_Id, s1.Employee_Name from FD_Master_View p1 left join Employee_Target s1 on p1.Account_No=s1.Account_No where p1.Open_Date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and to_number(renewal_no)>0 and Account_Status='A' and p1.Scheme_Code like '%" + Scheme_Code + "%' order by Branch,p1.Account_No";

						System.out.println("Renewal="+sql);
						
						return template
								.query(sql,
										new RowMapper<SimpleBranch>() {
											public SimpleBranch mapRow(ResultSet rs, int row)
													throws SQLException {
												SimpleDateFormat sd = new SimpleDateFormat(
														"dd/MM/yyyy");

												SimpleBranch jm = new SimpleBranch();
												jm.setS1(rs.getInt(1));//customer id
												jm.setS31(rs.getString(2)); // Account No
												jm.setS32(rs.getString(3)); // Name

												jm.setS33(sd.format(rs.getDate(4))); // Open
																						// Date
												jm.setS121(rs.getDate(4)); //open date
												// jm.setS33(rs.getString(4)); //Open Date
												jm.setS37(rs.getString(13)); // Closed Date
												jm.setS122(rs.getDate(13)); //closed date

												jm.setS42(rs.getInt(7)); // Deposit Amount
												jm.setS35(rs.getString(8)); // Period

												jm.setS36(rs.getString(12)); // Renewal No
												
												jm.setS38(sd.format(rs.getDate(5))); // Value date
												jm.setS123(rs.getDate(5)); //value date
												
												jm.setS39(rs.getString(14)); // Remarks
												
												//29-06-2022
												jm.setS40(rs.getString(17)); // Sc Name
												
												//28-07-2022
												jm.setS131(rs.getString(18)); // Sc Name
												jm.setS132(rs.getString(19)); // Sc Name
												jm.setS124(rs.getDate(20)); // Maturity date
												jm.setS20(rs.getFloat(21));//Closure_Amount
												jm.setS100(rs.getFloat(6)); // interest rate

												jm.setS135(rs.getString(22));
												jm.setS136(rs.getString(23));

												return jm;
											}
										});
					}
					
					
					public List<SimpleBranch> getFD_Monthly_Report_Closed_Renewal_new(String Monthly_From_Date,
							String Monthly_To_Date, String Scheme_Code, int Bcode) {
						// --Set Connection------------------------------------
						int j = Bcode;
						this.template = con.getCon2(j);
						// -----------------------------------------------------
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  in  (select renewal_no from fd_master where renewal_no is not null) order by Account_No";
						
						//scheme_code,(Select scheme_name from scheme_Master where scheme_code=fd_master.scheme_code)as sname
						//29-06-2022
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,Renewal_No,Closed_Date,Renewal_No as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master.scheme_code)as sname from FD_Master where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%" + Scheme_Code + "%' and Account_no  in  (select renewal_no from fd_master where renewal_no is not null) order by Account_No";

						//28-07-2022 New
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,nvl(Renewal_No,'0') as Renewal_No ,Closed_Date,nvl(Renewal_No,'0') as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname ,Maturity_date,(select a.transaction_amount as closure_amt from (select transaction_amount from daily_transaction_table where transaction_type='Credit' and flag='AC' and account_no=FD_Master_View.Account_no order by transaction_date desc)a where rownum=1) as closure_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  in  (select renewal_no from fd_master_View where renewal_no is not null) order by Branch,Account_No";

						//03-08-2022 debit AC
						//String sql="Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,nvl(Renewal_No,'0') as Renewal_No ,Closed_Date,nvl(Renewal_No,'0') as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname ,Maturity_date,(select a.transaction_amount as closure_amt from (select transaction_amount from daily_transaction_table where transaction_type='Debit' and flag='AC' and account_no=FD_Master_View.Account_no order by transaction_date desc)a where rownum=1) as closure_amount from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  in  (select renewal_no from fd_master_View where renewal_no is not null) order by Branch,Account_No";

						//24-12-2022
						//String sql="select a.*,b.transaction_amount from (Select Customer_Id,Account_No,Customer_Name,Open_Date,Value_Date,Interest_Rate,Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,nvl(Renewal_No,'0') as Renewal_No ,Closed_Date,nvl(Renewal_No,'0') as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,scheme_code,(Select scheme_name from scheme_Master where scheme_code=FD_Master_View.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname ,Maturity_date from FD_Master_View where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and Scheme_Code like '%"+Scheme_Code+"%' and Account_no  in  (select renewal_no from fd_master_View where renewal_no is not null) order by Branch,Account_No)a left join (select Account_no,nvl(sum(transaction_amount),0) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Debit' and flag in ('AC','INT') group by Account_no,transaction_date)b on a.Account_no=b.Account_no and a.Closed_date=b.Transaction_date"; 
		//Rebecca
						String sql="select a.*,b.transaction_amount from (Select Customer_Id,p1.Account_No,Customer_Name,p1.Open_Date,Value_Date,Interest_Rate,p1.Deposit_Amount,Period_Months || ' M ' || Period_Days || ' D ' as Period,Maturity_Amount,Closing_Balance,Account_Status,nvl(Renewal_No,'0') as Renewal_No ,Closed_Date,nvl(Renewal_No,'0') as bcode,case when (Renewal_No is NULL or Renewal_No='') then case when closed_date!='' then 'Closed' else 'New' End else 'Renewal' End as Remarks,p1.scheme_code,(Select scheme_name from scheme_Master where scheme_code=p1.scheme_code)as sname,branch,(Select branch_name from branch_master where branch_code=branch) as bname ,Maturity_date,s1.Employee_Id,s1.Employee_Name from FD_Master_View p1 left join Employee_Target s1 on p1.Account_No=s1.Account_No where closed_date between to_date('"+Monthly_From_Date+"','dd/MM/yyyy') and to_date('"+Monthly_To_Date+"','dd/MM/yyyy') and Account_Status='C' and p1.Scheme_Code like '%"+Scheme_Code+"%' and p1.Account_no  in (select renewal_no from fd_master_View where renewal_no is not null) order by Branch,Account_No)a left join (select Account_no,nvl(sum(transaction_amount),0) as transaction_amount,transaction_date from daily_transaction_table where transaction_type='Debit' and flag in ('AC','INT') group by Account_no,transaction_date)b on a.Account_no=b.Account_no and a.Closed_date=b.Transaction_date"; 

						System.out.println("Renewal closed="+sql);
						
						return template
								.query(sql,
										new RowMapper<SimpleBranch>() {
											public SimpleBranch mapRow(ResultSet rs, int row)
													throws SQLException {
												SimpleDateFormat sd = new SimpleDateFormat(
														"dd/MM/yyyy");

												SimpleBranch jm = new SimpleBranch();
												jm.setS1(rs.getInt(1));//customer id
												jm.setS31(rs.getString(2)); // Account No
												jm.setS32(rs.getString(3)); // Name

												jm.setS33(sd.format(rs.getDate(4))); // Open
																						// Date
												jm.setS121(rs.getDate(4)); //open date

												// jm.setS33(rs.getString(4)); //Open Date
												jm.setS37(sd.format(rs.getDate(13))); // Closed Date
												jm.setS122(rs.getDate(13)); //closed date

												jm.setS42(rs.getInt(7)); // Deposit Amount
												jm.setS35(rs.getString(8)); // Period

												jm.setS36(rs.getString(12)); // Renewal No
												
												jm.setS38(sd.format(rs.getDate(5))); // Value date
												jm.setS123(rs.getDate(5)); // value date
												
												jm.setS39(rs.getString(14)); // Remarks
												
												//29-06-2022
												jm.setS40(rs.getString(17)); // Sc Name

												//28-07-2022
												jm.setS131(rs.getString(18)); // bcode
												jm.setS132(rs.getString(19)); // Name
												jm.setS124(rs.getDate(20)); // Maturity date
												jm.setS20(rs.getFloat(23));//Closure_Amount
												jm.setS100(rs.getFloat(6)); // interest rate
												
												jm.setS135(rs.getString(21));
												jm.setS136(rs.getString(22));

												return jm;
											}
										});
					}

					
					public List<SimpleBranch> get_Fin_Year(int Bcode) {

						// --Set Connection------------------------------------
						int j = Bcode;
						this.template = con.getCon2(j);
						// -----------------------------------------------------
						return template
								.query("SELECT  EXTRACT (YEAR FROM ADD_MONTHS (calendar_date, -3)) || '-' || EXTRACT (YEAR FROM ADD_MONTHS (calendar_date, 9)) as FY FROM calendar1 where to_char(calendar_date,'dd/MM/yyyy') like '31/03/202%' and calendar_date between to_char(add_months(CURRENT_DATE,-60),'dd/MM/yyyy') and to_char(add_months(CURRENT_DATE,12),'dd/MM/yyyy') order by calendar_date desc",
										new RowMapper<SimpleBranch>() {
											public SimpleBranch mapRow(ResultSet rs, int row)
													throws SQLException {

												SimpleBranch gl = new SimpleBranch();

												gl.setS2(rs.getString(1));
												return gl;
											}
										});
					}	
					

}
