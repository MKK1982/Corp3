package com.Pisquare.Dao;


import java.io.BufferedWriter;
import java.io.FileWriter;
import java.io.IOException;
import java.sql.CallableStatement;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.SQLException;
import java.text.DecimalFormat;
import java.text.NumberFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.List;
import java.util.List.*;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.web.context.request.RequestContextHolder;

import com.Pisquare.Beans.Change_Password;
import com.Pisquare.Beans.Cus;
import com.Pisquare.Beans.Customer;
import com.Pisquare.Beans.GL_Master;
import com.Pisquare.Beans.Login;
import com.Pisquare.Beans.Branch_Master;
import com.Pisquare.Beans.Simple;
import com.Pisquare.Beans.SimpleBranch;
import com.Pisquare.Beans.UserDetails;
import com.Pisquare.Controllers.Configuration_Controller;


public class Audit_ReportDao {
	
	int Binfo=201;
	
	@Autowired
	private Configuration_Controller con;
JdbcTemplate template;
	
	public void setTemplate(JdbcTemplate template)
	{
		this.template=template;
		
	}
	
	public static String newline = System.getProperty("line.separator");
	
	
	 public List<SimpleBranch> verifyforSanction(String user,int Bcode){
			//--Set Connection----------------------------
			int j=Bcode;
			this.template=con.getCon2(j);
//-----------------------------------------------------


			return template.query("select * from Login_Details where USERNAME='"+user+"'",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
			{  

				SimpleBranch gl=new SimpleBranch();
			
				
				gl.setS2(rs.getString(7));   //Level
           	return gl;
			}
			 }     );
		}
	 
	 public String AddDays_ToDate(String Date1,int n) {
			//--Set Connection------------------------------------
			int j=Binfo;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			
			
			String i=null;
			PreparedStatement pstmt = null;
			try {
				pstmt = template.getDataSource().getConnection().prepareStatement("select to_char((to_date(?,'dd/MM/yyyy')+?),'dd/MM/yyyy') from dual");
				pstmt.setString(1, Date1);
				pstmt.setInt(2, n);
				
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			ResultSet resultSet = null;
			try {
				resultSet = pstmt.executeQuery();
				resultSet.next();
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			
			try {
				i=resultSet.getString(1);
				
				//i=resultSet.getRow();
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
				
			return i;
		}
	
	 public List<SimpleBranch> getProfitLoss(String Select_Date,int Bcode){

			//--Set Connection----------------------------
		           int j=Bcode;
			this.template=con.getCon2(j);
			//String sql="select k.* from (WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule)k";
			//04.03.2024
			String sql = "Select a.GL_Code as Account_Code,a.GL_Name as Account_Name,Category,Schedule,CB as OP_BALANCE from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where Category in ('Income','Expenditure') and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";
			
			//-----------------------------------------------------
			return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
				
				SimpleBranch gl=new SimpleBranch();
				
				gl.setS41(rs.getInt(1));  // Account Code
				gl.setS31(rs.getString(2));   // Account Name
			 	gl.setS32(rs.getString(3));   // Category
			 	gl.setS33(rs.getString(4));   // Schedule
			 	gl.setS51(rs.getFloat(5));   // OP Balance
			 	
			 	
			 	
			 	
				return gl;
			}
						 }     );
					}
	 
	 public List<SimpleBranch>useBranch_Code2(int code)
		{
			//--Set Connection----------------------------
		 int j=Binfo;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			return template.query("select * from Branch_Master where Branch_Code="+code+"",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException
																					{  
			
																						SimpleBranch c=new SimpleBranch();
																						c.setS1(rs.getInt(1));//BRANCH_CODE
																						c.setS2(rs.getString(10));//BRANCH_NAME
																						c.setS3(rs.getString(3));//BRANCH_ADDRESS
																						c.setS4(rs.getString(4));//BRANCH_CITY
																						c.setS5(rs.getString(5));//BRANCH_PINCODE
																						c.setS6(rs.getString(6));//BRANCH_PHONE
																						c.setS7(rs.getLong(7));//
																						c.setS8(rs.getLong(8));//
																						
																						return c;
																					}
		 																		 }     );
		}
		
	 public String SubtractDays_ToDate(String Date1,int n) 
		{
			//--Set Connection------------------------------------
			int j=Binfo;
			this.template=con.getCon2(j);
			//-----------------------------------------------------
			//Changed query 28-01-2020
			
			
			String i=null;
			PreparedStatement pstmt = null;
			try {
				pstmt = template.getDataSource().getConnection().prepareStatement("select to_char((to_date(?,'dd/MM/yyyy')-?),'dd/MM/yyyy') from dual");
				pstmt.setString(1, Date1);
				pstmt.setInt(2, n);
				
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			ResultSet resultSet = null;
			try {
				resultSet = pstmt.executeQuery();
				resultSet.next();
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			
			try {
				i=resultSet.getString(1);
				
				//i=resultSet.getRow();
			} catch (SQLException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
				
			return i;
		} 
		
		
	 public List<SimpleBranch> getBalanceSheet(String Select_Date,int Bcode){

			//--Set Connection----------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
				//String sql="Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'C%' or Schedule like 'D%' order by GL_Master.Schedule";
						//04.03.2024
				String sql = "Select a.GL_Code as Account_Code,a.GL_Name as Account_Name,Category,Schedule,CB as OP_BALANCE from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where Category in ('Asset','Liability') and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";
				System.out.println(sql);
				return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
				
				SimpleBranch gl=new SimpleBranch();
				
				gl.setS41(rs.getInt(1));  // Account Code
				gl.setS31(rs.getString(2));   // Account Name
				gl.setS32(rs.getString(3)); // Category
				gl.setS33(rs.getString(4)); // Schedule
				//gl.setS42(rs.getInt(5)); // Op_Balance
				
				gl.setS142(rs.getDouble(5)); // Op_Balance
				
				return gl;
			}
						 }     );
					}
		


	 public List<SimpleBranch> getTrialBalance(String Select_Date,int Bcode){

			//--Set Connection----------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
						//return template.query("Select d.Schedule || '-' || Schedule_Name as Schedule_Details,d.GL_Code,d.GL_Name,d.Debit,d.Credit from(Select GL_Code,GL_Name,Schedule,case when Get_GL_CB2(GL_Code,'"+Select_Date+"') > 0 Then Get_GL_CB2(GL_Code,'"+Select_Date+"') else 0 End as Credit,case when Get_GL_CB2(GL_Code,'"+Select_Date+"') > 0 Then 0 else Abs(Get_GL_CB2(GL_Code,'"+Select_Date+"')) End as Debit from GL_Master where GL_Code!=0 order by Schedule,GL_Code) d, Schedule_Master1 where Schedule_Master1.Schedule_Code=D.Schedule and (d.Credit>0 OR d.Debit>0)",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
						//23-08-2022	
						String sql = "Select a.Schedule || '-' || Schedule_Name as Schedule_Details,a.GL_Code,a.GL_Name,case when CB > 0 Then CB else 0 End as Credit,case when CB > 0 Then 0 else Abs(CB) End as Debit from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where a.GL_Code!=0 and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";
						return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
							
			
				SimpleBranch gl=new SimpleBranch();
				
				gl.setS31(rs.getString(1));  // Schedule Details
				gl.setS41(rs.getInt(2));   // GL Code
			 	gl.setS32(rs.getString(3));   // GL Name
			 	gl.setS141(rs.getDouble(5));   // Debit
			 	gl.setS142(rs.getDouble(4));   // Credit
			 	
				return gl;
			}
						 }     );
					}
	 
	 
	 public List<SimpleBranch> getTrialBalance2(String Select_Date,int Bcode){

			//--Set Connection----------------------------
						int j=Bcode;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
						//return template.query("Select d.Schedule || '-' || Schedule_Name as Schedule_Details,d.GL_Code,d.GL_Name,d.Debit,d.Credit from(Select GL_Code,GL_Name,Schedule,case when Get_GL_CB2(GL_Code,'"+Select_Date+"') > 0 Then Get_GL_CB2(GL_Code,'"+Select_Date+"') else 0 End as Credit,case when Get_GL_CB2(GL_Code,'"+Select_Date+"') > 0 Then 0 else Abs(Get_GL_CB2(GL_Code,'"+Select_Date+"')) End as Debit from GL_Master where GL_Code!=0 order by Schedule,GL_Code) d, Schedule_Master1 where Schedule_Master1.Schedule_Code=D.Schedule and (d.Credit>0 OR d.Debit>0)",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
						//23-08-2022	
						//String sql = "Select a.Schedule || '-' || Schedule_Name as Schedule_Details,a.GL_Code,a.GL_Name,case when CB > 0 Then CB else 0 End as Credit,case when CB > 0 Then 0 else Abs(CB) End as Debit from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' and Flag2 is NULL and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452')) group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where a.GL_Code!=0 and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";
						
						//26-04-2023	// JL 60028,60029 :  '30452','30451','30414','20068'
					//	String sql = "Select a.Schedule || '-' || Schedule_Name as Schedule_Details,a.GL_Code,a.GL_Name,case when CB > 0 Then CB else 0 End as Credit,case when CB > 0 Then 0 else Abs(CB) End as Debit from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' and Flag2 is NULL and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','30451','30414','20068')) group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where a.GL_Code!=0 and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";

//02-05-2023 //'10373','40851','10374','10375','40852','10376'
//String sql = "Select a.Schedule || '-' || Schedule_Name as Schedule_Details,a.GL_Code,a.GL_Name,case when CB > 0 Then CB else 0 End as Credit,case when CB > 0 Then 0 else Abs(CB) End as Debit from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' and Flag2 is NULL and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','30451','30414','20068','10373','40851','10374','10375','40852','10376')) group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where a.GL_Code!=0 and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";

//04-08-2023 //'10376','10385','40857','10386','10394','40861','10395','10396','40862','10397','10400','40864','10401'
//String sql = "Select a.Schedule || '-' || Schedule_Name as Schedule_Details,a.GL_Code,a.GL_Name,case when CB > 0 Then CB else 0 End as Credit,case when CB > 0 Then 0 else Abs(CB) End as Debit from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' and Flag2 is NULL and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','30451','30414','20068','10373','40851','10374','10375','40852','10376','10385','40857','10386','10394','40861','10395','10396','40862','10397','10400','40864','10401','10404','40866','10405')) group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where a.GL_Code!=0 and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";

//30-09-2023 //'10410','40869','10411','10412','40870','10413''  //02-11-2023 '10418','40873','10419','10420','40874','10421'  03-02-2024 '10431','40879','10432','10433','40880','10434'
//04.03.2024
						String sql = "Select a.Schedule || '-' || Schedule_Name as Schedule_Details,a.GL_Code,a.GL_Name,case when CB > 0 Then CB else 0 End as Credit,case when CB > 0 Then 0 else Abs(CB) End as Debit from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' and Flag2 is NULL and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in (Select GL_Code from dbuser1.SK_GL)) group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where a.GL_Code!=0 and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";
System.out.println(sql);
						return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
							
			
				SimpleBranch gl=new SimpleBranch();
				
				gl.setS31(rs.getString(1));  // Schedule Details
				gl.setS41(rs.getInt(2));   // GL Code
			 	gl.setS32(rs.getString(3));   // GL Name
			 	gl.setS141(rs.getDouble(5));   // Debit
			 	gl.setS142(rs.getDouble(4));   // Credit
			 	
				return gl;
			}
						 }     );
					}

		 public List<SimpleBranch> getConsolidated_TrialBalance(String to_date1,int Bcode){

			//--Set Connection----------------------------
		 int j=Binfo;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
//														select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name , Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 ) order by k.SCHEDULE
						//with erode select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name , Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,Case when t14.credit is not null then t14.credit else 0 end as c214,Case when t14.Debit is not null then t14.Debit else 0 end as d214,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='214' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))t14 on (GL.GL_Code=t14.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 or c214!=0 or d214!=0)order by k.SCHEDULE;
						//select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name , Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,Case when t14.credit is not null then t14.credit else 0 end as c214,Case when t14.Debit is not null then t14.Debit else 0 end as d214,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='214' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t14 on (GL.GL_Code=t14.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 or c214!=0 or d214!=0)order by k.SCHEDULE;
//up to 217 select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name , Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,Case when t14.credit is not null then t14.credit else 0 end as c214,Case when t14.Debit is not null then t14.Debit else 0 end as d214,Case when t15.credit is not null then t15.credit else 0 end as c215,Case when t15.Debit is not null then t15.Debit else 0 end as d215,Case when t16.credit is not null then t16.credit else 0 end as c216,Case when t16.Debit is not null then t16.Debit else 0 end as d216,Case when t17.credit is not null then t17.credit else 0 end as c217,Case when t17.Debit is not null then t17.Debit else 0 end as d217,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='214' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t14 on (GL.GL_Code=t14.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='215' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t15 on (GL.GL_Code=t15.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='216' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t16 on (GL.GL_Code=t16.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='217' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t17 on (GL.GL_Code=t17.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 or c214!=0 or d214!=0   or c215!=0 or d215!=0  or c216!=0 or d216!=0 or  c217!=0 or d217!=0)order by k.SCHEDULE;
			//old String sql="select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name , Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,Case when t14.credit is not null then t14.credit else 0 end as c214,Case when t14.Debit is not null then t14.Debit else 0 end as d214,Case when t15.credit is not null then t15.credit else 0 end as c215,Case when t15.Debit is not null then t15.Debit else 0 end as d215,Case when t16.credit is not null then t16.credit else 0 end as c216,Case when t16.Debit is not null then t16.Debit else 0 end as d216,Case when t17.credit is not null then t17.credit else 0 end as c217,Case when t17.Debit is not null then t17.Debit else 0 end as d217,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='214' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t14 on (GL.GL_Code=t14.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='215' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t15 on (GL.GL_Code=t15.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='216' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t16 on (GL.GL_Code=t16.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='217' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t17 on (GL.GL_Code=t17.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 or c214!=0 or d214!=0   or c215!=0 or d215!=0  or c216!=0 or d216!=0 or  c217!=0 or d217!=0)order by k.SCHEDULE";
			//new
	//			String sql="select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217+c218-d218+c219-d219+c220-d220+c221-d221+c222-d222+c223-d223)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217+c218-d218+c219-d219+c220-d220+c221-d221+c222-d222+c223-d223)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name ,Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,Case when t14.credit is not null then t14.credit else 0 end as c214,Case when t14.Debit is not null then t14.Debit else 0 end as d214,Case when t15.credit is not null then t15.credit else 0 end as c215,Case when t15.Debit is not null then t15.Debit else 0 end as d215,Case when t16.credit is not null then t16.credit else 0 end as c216,Case when t16.Debit is not null then t16.Debit else 0 end as d216,Case when t17.credit is not null then t17.credit else 0 end as c217,Case when t17.Debit is not null then t17.Debit else 0 end as d217,Case when t18.credit is not null then t18.credit else 0 end as c218,Case when t18.Debit is not null then t18.Debit else 0 end as d218,Case when t19.credit is not null then t19.credit else 0 end as c219,Case when t19.Debit is not null then t19.Debit else 0 end as d219,Case when t20.credit is not null then t20.credit else 0 end as c220,Case when t20.Debit is not null then t20.Debit else 0 end as d220,Case when t21.credit is not null then t21.credit else 0 end as c221,Case when t21.Debit is not null then t21.Debit else 0 end as d221,Case when t22.credit is not null then t22.credit else 0 end as c222,Case when t22.Debit is not null then t22.Debit else 0 end as d222,Case when t23.credit is not null then t23.credit else 0 end as c223,Case when t23.Debit is not null then t23.Debit else 0 end as d223,gl.SCHEDULE   from ( Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='214' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t14 on (GL.GL_Code=t14.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='215' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t15 on (GL.GL_Code=t15.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='216' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t16 on (GL.GL_Code=t16.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='217' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t17 on (GL.GL_Code=t17.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='218' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t18 on (GL.GL_Code=t18.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='219' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t19 on (GL.GL_Code=t19.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='220' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t20 on (GL.GL_Code=t20.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='221' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t21 on (GL.GL_Code=t21.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='222' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t22 on (GL.GL_Code=t22.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='223' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t23 on (GL.GL_Code=t23.GL_Code) )k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 or c214!=0 or d214!=0   or c215!=0 or d215!=0  or c216!=0 or d216!=0 or  c217!=0 or d217!=0 or  c218!=0 or d218!=0 or  c219!=0 or d219!=0 or  c220!=0 or d220!=0 or  c221!=0 or d221!=0 or  c222!=0 or d222!=0 or  c223!=0 or d223!=0)order by k.SCHEDULE";
			//new2
				String sql="select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217+c218-d218+c219-d219+c220-d220+c221-d221+c222-d222+c223-d223)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217+c218-d218+c219-d219+c220-d220+c221-d221+c222-d222+c223-d223)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name ,Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,Case when t14.credit is not null then t14.credit else 0 end as c214,Case when t14.Debit is not null then t14.Debit else 0 end as d214,Case when t15.credit is not null then t15.credit else 0 end as c215,Case when t15.Debit is not null then t15.Debit else 0 end as d215,Case when t16.credit is not null then t16.credit else 0 end as c216,Case when t16.Debit is not null then t16.Debit else 0 end as d216,Case when t17.credit is not null then t17.credit else 0 end as c217,Case when t17.Debit is not null then t17.Debit else 0 end as d217,Case when t18.credit is not null then t18.credit else 0 end as c218,Case when t18.Debit is not null then t18.Debit else 0 end as d218,Case when t19.credit is not null then t19.credit else 0 end as c219,Case when t19.Debit is not null then t19.Debit else 0 end as d219,Case when t20.credit is not null then t20.credit else 0 end as c220,Case when t20.Debit is not null then t20.Debit else 0 end as d220,Case when t21.credit is not null then t21.credit else 0 end as c221,Case when t21.Debit is not null then t21.Debit else 0 end as d221,Case when t22.credit is not null then t22.credit else 0 end as c222,Case when t22.Debit is not null then t22.Debit else 0 end as d222,Case when t23.credit is not null then t23.credit else 0 end as c223,Case when t23.Debit is not null then t23.Debit else 0 end as d223,gl.SCHEDULE   from ( select gl_code,(select gl_name from dbuser1.new_gl_view2 where gl_code=mainqry.gl_code and rownum=1) as gl_name,schedule from (select distinct (gl_code)as gl_code,schedule from dbuser1.new_gl_view2)mainqry)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='214' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t14 on (GL.GL_Code=t14.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='215' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t15 on (GL.GL_Code=t15.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='216' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t16 on (GL.GL_Code=t16.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='217' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t17 on (GL.GL_Code=t17.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='218' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t18 on (GL.GL_Code=t18.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='219' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t19 on (GL.GL_Code=t19.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='220' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t20 on (GL.GL_Code=t20.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='221' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t21 on (GL.GL_Code=t21.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='222' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t22 on (GL.GL_Code=t22.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='223' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t23 on (GL.GL_Code=t23.GL_Code) )k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 or c214!=0 or d214!=0   or c215!=0 or d215!=0  or c216!=0 or d216!=0 or  c217!=0 or d217!=0 or  c218!=0 or d218!=0 or  c219!=0 or d219!=0 or  c220!=0 or d220!=0 or  c221!=0 or d221!=0 or  c222!=0 or d222!=0 or  c223!=0 or d223!=0)order by k.SCHEDULE";

			return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
				
			
				SimpleBranch gl=new SimpleBranch();
				
				
				gl.setS41(rs.getInt(1));   // GL Code
				
				gl.setS2(rs.getString(2));   // GL Name
				
			  	gl.setS141(rs.getDouble(3));   // c201
			 	gl.setS142(rs.getDouble(4));   // d201
			 	
			 	gl.setS143(rs.getDouble(5));   // c202
			 	gl.setS144(rs.getDouble(6));   // d202
			 	
			 	gl.setS145(rs.getDouble(7));   // c203
			 	gl.setS146(rs.getDouble(8));   // d203
			 	
			 	gl.setS147(rs.getDouble(9));   // c204
			 	gl.setS148(rs.getDouble(10));   // d204
			 	
			 	gl.setS149(rs.getDouble(11));   // c205
			 	gl.setS150(rs.getDouble(12));   // d205
			 	
			 	gl.setS151(rs.getDouble(13));   // c206
			 	gl.setS152(rs.getDouble(14));   // d206
			 	
			 	gl.setS153(rs.getDouble(15));   // c207
			 	gl.setS154(rs.getDouble(16));   // d207
			 	
			 	gl.setS155(rs.getDouble(17));   // c208
			 	gl.setS156(rs.getDouble(18));   // d208
			 	
			 	gl.setS157(rs.getDouble(19));   // c209
			 	gl.setS158(rs.getDouble(20));   // d209
			 	
			 	gl.setS159(rs.getDouble(21));   // c210
			 	gl.setS160(rs.getDouble(22));   // d210
			 	
			 	
			 	gl.setS161(rs.getDouble(23));   // c211
			 	gl.setS162(rs.getDouble(24));   // d211
			 	
			 	gl.setS163(rs.getDouble(25));   // c212
			 	gl.setS164(rs.getDouble(26));   // d212
			 	
			 	gl.setS165(rs.getDouble(27));   // c213
			 	gl.setS166(rs.getDouble(28));   // d213
			 	
			 	gl.setS167(rs.getDouble(29));   // c214
			 	gl.setS168(rs.getDouble(30));   // d214
			 	
			 	
			 	
			 	gl.setS169(rs.getDouble(31));   // c215
			 	gl.setS170(rs.getDouble(32));   // d215
			 	
			 	gl.setS171(rs.getDouble(33));   // c216
			 	gl.setS172(rs.getDouble(34));   // d216
			 	
			 	gl.setS173(rs.getDouble(35));   // c217
			 	gl.setS174(rs.getDouble(36));   // d217
			 	
			 	
			 	gl.setS175(rs.getDouble(37));   // c218
			 	gl.setS176(rs.getDouble(38));   // d218
			 	
			 	gl.setS177(rs.getDouble(39));   // c219
			 	gl.setS178(rs.getDouble(40));   // d219
			 	
			 	gl.setS179(rs.getDouble(41));   // c220
			 	gl.setS180(rs.getDouble(42));   // d220
			 	
			 	
			 	
			 	gl.setS181(rs.getDouble(43));   // c221
			 	gl.setS182(rs.getDouble(44));   // d221
			 	
			 	gl.setS183(rs.getDouble(45));   // c222
			 	gl.setS184(rs.getDouble(46));   // d222
			 	
			 	gl.setS185(rs.getDouble(47));   // c223
			 	gl.setS186(rs.getDouble(48));   // d223
			 	
			 	
			 	gl.setS3(rs.getString(49));   // Schedule
			 	gl.setS4(rs.getString(50));   // Total
			 	
				return gl;
			}
						 }     );
					}
		
	 public List<SimpleBranch> getConsolidated_TrialBalance_1(String to_date1,int Bcode){

			//--Set Connection----------------------------
						int j=Binfo;
						this.template=con.getCon2(j);
			//-----------------------------------------------------
	//select * from (select GL.GL_Code,GL.GL_Name ,Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when b.credit is not null then b.credit else 0 end as c202,Case when b.Debit is not null then b.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Credit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Credit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Credit else 0 end as d205 from (Select gl_code,gl_name from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from dbuser1.Trialbalance where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from dbuser2.Trialbalance where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))b on (GL.GL_Code=b.GL_Code) left join (select GL_Code,Credit,Debit from dbuser3.Trialbalance where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code) left join (select GL_Code,Credit,Debit from dbuser4.Trialbalance where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from dbuser5.Trialbalance where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0  )
	//select * from (select GL.GL_Code,GL.GL_Name ,Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when b.credit is not null then b.credit else 0 end as c202,Case when b.Debit is not null then b.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Credit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Credit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Credit else 0 end as d205 from (Select gl_code,gl_name from GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))b on (GL.GL_Code=b.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0  )
	//select * from (select GL.GL_Code,GL.GL_Name ,    Case when a.credit is not null then a.credit else 0 end as c201,  Case when a.Debit is not null then a.Debit else 0 end as d201,  Case when m.credit is not null then m.credit else 0 end as c202,  Case when m.Debit is not null then m.Debit else 0 end as d202,  Case when c.credit is not null then c.credit else 0 end as c203,  Case when c.Debit is not null then c.Debit else 0 end as d203 ,  Case when d.credit is not null then d.credit else 0 end as c204,  Case when d.Debit is not null then d.Debit else 0 end as d204,  Case when e.credit is not null then e.credit else 0 end as c205,  Case when e.Debit is not null then e.Debit else 0 end as d205   from (Select gl_code,gl_name from GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0  )
			return template.query("select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name ,    Case when a.credit is not null then a.credit else 0 end as c201,  Case when a.Debit is not null then a.Debit else 0 end as d201,  Case when m.credit is not null then m.credit else 0 end as c202,  Case when m.Debit is not null then m.Debit else 0 end as d202,  Case when c.credit is not null then c.credit else 0 end as c203,  Case when c.Debit is not null then c.Debit else 0 end as d203 ,  Case when d.credit is not null then d.credit else 0 end as c204,  Case when d.Debit is not null then d.Debit else 0 end as d204,  Case when e.credit is not null then e.credit else 0 end as c205,  Case when e.Debit is not null then e.Debit else 0 end as d205,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0  ) order by k.SCHEDULE",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
				
			
				SimpleBranch gl=new SimpleBranch();
				
				
				gl.setS41(rs.getInt(1));   // GL Code
				gl.setS2(rs.getString(2));   // GL Name
			  	gl.setS141(rs.getDouble(3));   // c201
			 	gl.setS142(rs.getDouble(4));   // d201
			 	
			 	gl.setS143(rs.getDouble(5));   // c202
			 	gl.setS144(rs.getDouble(6));   // d202
			 	
			 	gl.setS145(rs.getDouble(7));   // c203
			 	gl.setS146(rs.getDouble(8));   // d203
			 	
			 	gl.setS147(rs.getDouble(9));   // c204
			 	gl.setS148(rs.getDouble(10));   // d204
			 	
			 	gl.setS149(rs.getDouble(11));   // c205
			 	gl.setS150(rs.getDouble(12));   // d205
			 	
			 	gl.setS3(rs.getString(13));   // Schedule
			 	gl.setS4(rs.getString(14));   // Total
			 	
	
			 	
				return gl;
			}
						 }     );
					}
		
		
		
		
		
		// Consolidated Trial Balance 2
			
			public List<SimpleBranch> getConsolidated_TrialBalance_2(String to_date1,int Bcode){

				//--Set Connection----------------------------
							int j=Binfo;
							this.template=con.getCon2(j);
				//-----------------------------------------------------
				//select * from (select GL.GL_Code,GL.GL_Name ,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Credit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Credit else 0 end as d209,Case when j.credit is not null then j.credit else 0 end as c210,Case when j.Debit is not null then j.Credit else 0 end as d210 from (Select gl_code,gl_name from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from Trialbalance where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from Trialbalance where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on (GL.GL_Code=g.GL_Code)left join (select GL_Code,Credit,Debit from Trialbalance where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code) left join (select GL_Code,Credit,Debit from Trialbalance where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from Trialbalance where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))j on (GL.GL_Code=j.GL_Code))k  where ( c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0)
				return template.query("select k.*,case when (c206-d206+c207-d207+c208-d208+c209-d209+c210-d210)<0 then (c206-d206+c207-d207+c208-d208+c209-d209+c210-d210)|| ' Dr.' else (c206-d206+c207-d207+c208-d208+c209-d209+c210-d210)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name ,    Case when a.credit is not null then a.credit else 0 end as c206,  Case when a.Debit is not null then a.Debit else 0 end as d206,  Case when m.credit is not null then m.credit else 0 end as c207,  Case when m.Debit is not null then m.Debit else 0 end as d207,  Case when c.credit is not null then c.credit else 0 end as c208,  Case when c.Debit is not null then c.Debit else 0 end as d208 ,  Case when d.credit is not null then d.credit else 0 end as c209,  Case when d.Debit is not null then d.Debit else 0 end as d209,  Case when e.credit is not null then e.credit else 0 end as c210,  Case when e.Debit is not null then e.Debit else 0 end as d210,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code))k where (c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0  )order by k.SCHEDULE",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
					
				
					SimpleBranch gl=new SimpleBranch();
					
					
					gl.setS41(rs.getInt(1));   // GL Code
					gl.setS2(rs.getString(2));   // GL Name
				
				 	
				 	gl.setS151(rs.getDouble(3));   // c206
				 	gl.setS152(rs.getDouble(4));   // d206
				 	
				 	gl.setS153(rs.getDouble(5));   // c207
				 	gl.setS154(rs.getDouble(6));   // d207
				 	
				 	gl.setS155(rs.getDouble(7));   // c208
				 	gl.setS156(rs.getDouble(8));   // d208
				 	
				 	gl.setS157(rs.getDouble(9));   // c209
				 	gl.setS158(rs.getDouble(10));   // d209
				 	
				 	gl.setS159(rs.getDouble(11));   // c210
				 	gl.setS160(rs.getDouble(12));   // d210
				 	
				 	gl.setS3(rs.getString(13));   // Schedule
				 	gl.setS4(rs.getString(14));   // Total
				 	
					return gl;
				}
							 }     );
						}

		
			
			
// Consolidated Trial Balance 2
			
			public List<SimpleBranch> getConsolidated_TrialBalance_3(String to_date1,int Bcode){

				//--Set Connection----------------------------
							int j=Binfo;
							this.template=con.getCon2(j);
				//-----------------------------------------------------
				//select * from (select GL.GL_Code,GL.GL_Name ,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Credit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Credit else 0 end as d209,Case when j.credit is not null then j.credit else 0 end as c210,Case when j.Debit is not null then j.Credit else 0 end as d210 from (Select gl_code,gl_name from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from Trialbalance where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from Trialbalance where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on (GL.GL_Code=g.GL_Code)left join (select GL_Code,Credit,Debit from Trialbalance where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code) left join (select GL_Code,Credit,Debit from Trialbalance where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from Trialbalance where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))j on (GL.GL_Code=j.GL_Code))k  where ( c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0)
				return template.query("select k.*,case when (c211-d211+c212-d212+c213-d213)<0 then (c211-d211+c212-d212+c213-d213)|| ' Dr.' else (c211-d211+c212-d212+c213-d213)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name ,    Case when a.credit is not null then a.credit else 0 end as c211,  Case when a.Debit is not null then a.Debit else 0 end as d211,  Case when m.credit is not null then m.credit else 0 end as c212,  Case when m.Debit is not null then m.Debit else 0 end as d212,  Case when c.credit is not null then c.credit else 0 end as c213,  Case when c.Debit is not null then c.Debit else 0 end as d213 ,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on GL.GL_Code=c.GL_Code )k where (c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0  )order by k.SCHEDULE",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
					
				
					SimpleBranch gl=new SimpleBranch();
					
					
					gl.setS41(rs.getInt(1));   // GL Code
					gl.setS2(rs.getString(2));   // GL Name
				
				 	
				 	gl.setS151(rs.getDouble(3));   // c211
				 	gl.setS152(rs.getDouble(4));   // d211
				 	
				 	gl.setS153(rs.getDouble(5));   // c212
				 	gl.setS154(rs.getDouble(6));   // d212
				 	
				 	gl.setS155(rs.getDouble(7));   // c213
				 	gl.setS156(rs.getDouble(8));   // d213
				 	
				 	
				 	gl.setS3(rs.getString(9));   // Schedule
				 	gl.setS4(rs.getString(10));   // Total
				 	
					return gl;
				}
							 }     );
						}
			

			public List<SimpleBranch> getTrialBalanceOS_List55(String Select_Date,int Bcode){

				//--Set Connection----------------------------
							int j=Bcode;
							this.template=con.getCon2(j);
				//-----------------------------------------------------
				// sample select one.Scheme_Code,two.GL_CODE,two.GL_NAME,one.OSCREDIT,two.Credit,(one.OSCREDIT-two.Credit)as Cre_Diff,one.OSDEBIT ,two.DEBIT,(one.OSDEBIT+two.DEBIT)as Deb_Diff from (select k.Scheme_code,sum(k.credit)as oscredit,sum(k.debit) as osdebit from (select Scheme_Code,Account_no,case when Get_Outstanding_Balance(Account_No,'22/07/2019')>0 then Get_Outstanding_Balance(Account_No,'22/07/2019') else 0 end as Credit,case when Get_Outstanding_Balance(Account_No,'22/07/2019')<0 then (-1)*Get_Outstanding_Balance(Account_No,'22/07/2019') else 0 end as Debit from Cust_Acc_Link where Scheme_code in (select Scheme_code from scheme_master left join (select gl_code,schedule_master1.SCHEDULE_CODE from gl_master left join schedule_master1 on to_char(gl_master.Schedule)=schedule_master1.SCHEDULE_CODE where schedule_master1.SCHEDULE_CODE in ('C30','D50'))a on scheme_master.GL_GENERAL=a.gl_code) and Account_Status in ('A','I'))k group by scheme_code order by scheme_code)one inner join (select k1.* from(select k.*,(Select Scheme_code from Scheme_Master where gl_general=k.gl_Code and rownum=1)as scheme_code from (Select d.Schedule || '-' || Schedule_Name as Schedule_Details,d.GL_Code,d.GL_Name,d.Debit,d.Credit from(Select GL_Code,GL_Name,Schedule,case when Get_GL_CB2(GL_Code,'22/07/2019') > 0 Then Get_GL_CB2(GL_Code,'22/07/2019') else 0 End as Credit,case when Get_GL_CB2(GL_Code,'22/07/2019') > 0 Then 0 else Abs(Get_GL_CB2(GL_Code,'22/07/2019')) End as Debit from GL_Master where GL_Code!=0 order by Schedule,GL_Code) d, Schedule_Master1 where Schedule_Master1.Schedule_Code=D.Schedule and (d.Credit>0 OR d.Debit>0) and d.Schedule in ('C30','D50'))k)k1 order by scheme_code)two on one.Scheme_code=two.scheme_code;
				//sample 2  select k2.Scheme_Code,k2.GL_Code,k2.GL_Name,k2.Debit,k2.debit_OS,k2.Credit,k2.Credit_OS from (select k1.*,case when OS_Report_Scheme1('24/07/2019',k1.scheme_code)>0 then OS_Report_Scheme1('24/07/2019',k1.scheme_code) else 0 end as Credit_OS,case when OS_Report_Scheme1('24/07/2019',k1.scheme_code)<0 then (-1)*OS_Report_Scheme1('24/07/2019',k1.scheme_code) else 0 end as debit_OS from(select k.*,(Select Scheme_code from Scheme_Master where gl_general=k.gl_Code and rownum=1)as scheme_code from (Select d.Schedule || '-' || Schedule_Name as Schedule_Details,d.GL_Code,d.GL_Name,d.Debit,d.Credit from(Select GL_Code,GL_Name,Schedule,case when Get_GL_CB2(GL_Code,'24/07/2019') > 0 Then Get_GL_CB2(GL_Code,'24/07/2019') else 0 End as Credit,case when Get_GL_CB2(GL_Code,'24/07/2019') > 0 Then 0 else Abs(Get_GL_CB2(GL_Code,'24/07/2019')) End as Debit from GL_Master where GL_Code!=0 order by Schedule,GL_Code) d, Schedule_Master1 where Schedule_Master1.Schedule_Code=D.Schedule and (d.Credit>0 OR d.Debit>0) and d.Schedule in ('C30','D50'))k)k1 order by scheme_code)k2;

				return template.query("select k2.Scheme_Code,k2.GL_Code,k2.GL_Name,k2.Debit,k2.debit_OS,'-',k2.Credit,k2.Credit_OS,'-' from (select k1.*,case when OS_Report_Scheme1('"+Select_Date+"',k1.scheme_code)>0 then OS_Report_Scheme1('"+Select_Date+"',k1.scheme_code) else 0 end as Credit_OS,case when OS_Report_Scheme1('"+Select_Date+"',k1.scheme_code)<0 then (-1)*OS_Report_Scheme1('"+Select_Date+"',k1.scheme_code) else 0 end as debit_OS from(select k.*,(Select Scheme_code from Scheme_Master where gl_general=k.gl_Code and rownum=1)as scheme_code from (Select d.Schedule || '-' || Schedule_Name as Schedule_Details,d.GL_Code,d.GL_Name,d.Debit,d.Credit from(Select GL_Code,GL_Name,Schedule,case when Get_GL_CB2(GL_Code,'"+Select_Date+"') > 0 Then Get_GL_CB2(GL_Code,'"+Select_Date+"') else 0 End as Credit,case when Get_GL_CB2(GL_Code,'"+Select_Date+"') > 0 Then 0 else Abs(Get_GL_CB2(GL_Code,'"+Select_Date+"')) End as Debit from GL_Master where GL_Code!=0 order by Schedule,GL_Code) d, Schedule_Master1 where Schedule_Master1.Schedule_Code=D.Schedule and (d.Credit>0 OR d.Debit>0) and d.Schedule in ('C30','D50'))k)k1 order by scheme_code)k2",new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
					
				
					SimpleBranch gl=new SimpleBranch();
					
					gl.setS31(rs.getString(1));  // Schedule Details
					gl.setS32(rs.getString(2));   // GL Code
				 	gl.setS33(rs.getString(3));   // GL Name
				 	gl.setS34(rs.getString(4));   // TB Debit																										 	gl.setS35(rs.getString(5));   // Credit
				 	gl.setS35(rs.getString(5));   // OS debit
				 	gl.setS36(rs.getString(6));   // Debit Diff
				 	gl.setS37(rs.getString(7));   // TB Credit
				 	gl.setS38(rs.getString(8));   // OS Credit
					gl.setS39(rs.getString(9));   // Credit Diff
				 	
				 	
					return gl;
				}
							 }     );
						}
			
			public List<SimpleBranch> getTrialBalanceWithoutEsc(String Select_Date,int Bcode){

				//--Set Connection----------------------------
							int j=Bcode;
							this.template=con.getCon2(j);
				//-----------------------------------------------------
				
							
							//old
							//String sql="select * from (Select d.Schedule || '-' || Schedule_Name as Schedule_Details,d.GL_Code,d.GL_Name,d.Debit,d.Credit from(Select GL_Code,GL_Name,Schedule,case when Get_GL_CB2(GL_Code,'"+Select_Date+"') > 0 Then Get_GL_CB2(GL_Code,'"+Select_Date+"') else 0 End as Credit,case when Get_GL_CB2(GL_Code,'"+Select_Date+"') > 0 Then 0 else Abs(Get_GL_CB2(GL_Code,'"+Select_Date+"')) End as Debit from GL_Master where GL_Code!=0 order by Schedule,GL_Code) d, Schedule_Master1 where Schedule_Master1.Schedule_Code=D.Schedule and (d.Credit>0 OR d.Debit>0))k where k.GL_Code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814')";
				//new 29-06-2021
				 //String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No='29006') group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No='29006') group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No='29006') group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No='29006') group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry";			
				
				 
				//new 29-06-2021 updated
	//						 String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0";			
				
							 //new 30-06-2021
							 //String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0";	

							 //30-06-2021 updated
  	//						 String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0";	

  							//19-08-2021 updated
  							// String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0";	

  							//13-09-2021 updated
  							 //String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0";	

  							//14-09-2021 updated '45018','45019','45020','45045'
 							 //String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0";	

 							 //14-09-2021 (with new list)
 	//						String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102'))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0";
 							
 							 //09-11-2021 (with new branch sk)45103,45104,45105,45106,45107	
 	//						String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107'))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

 							
 							//09-12-2021 (with new FD)'10327','40829','10328','10329','40830','10330'	
 	//						String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107'))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

 							//01-04-2022 (with new SK CD)'10335','40833','10336'	
 	//						String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336'))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

 							//13-04-2022 '45112','41007'
 	//						String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007'))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

 							
 							//10-05-2022 '45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111' trial balance
 	//						String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111'))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

 							 //09-08-2022 New SK JL & FD '10341','40835','10342','20066','30413','20067'
 							 // String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067'))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 
 							
 							//16-08-2022 New SK CD FD '10347','40838','10348','10349','40839','10350'
 							 // String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350' ))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350' ))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350' )) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350' )) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

 							  //14-09-2022 newbranches sk '45115','45116','45117','45118'
 							 //  String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118' ))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118' ))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118' )) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118' )) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

 							  //03-11-2022 new  sk fd '10355','40842','10356','10357','40843','10358'
 	//						  String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358' ))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358' ))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358' )) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358' )) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

 							//05-12-2022 '45113','45115','45116','45117','45118','45119','45120','45121','45122' sk branch
 	//						 String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122' ))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122' ))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122' )) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122' )) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 
 							//21-01-2023 '10367','40848','10368','10369','40849','10370' sk branch
 							//String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370' ))									 group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370' ))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370' )) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370' )) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

							//02-03-2023 '20201','20202','20203','30415','30416','30452'
							 //String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

							//17-04-2023 New SK FD,CD '10373','40851','10374','10375','40852','10376','10373','40851','10374','10375','40852','10376'
							 //String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

							//24-08-2023 New SK CD '10385','40857','10386'
	//						 String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376','10385','40857','10386')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376','10385','40857','10386'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376','10385','40857','10386')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376','10385','40857','10386')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0"; 

							//31-08-2023 New SK FD CD '10394','40861','10395','10396','40862','10397' 04-09-2023 SK FD '10397','10400','40864','10401' //02-11-2023 '10418','40873','10419','10420','40874','10421'   //03-02-2024 '10431','40879','10432','10433','40880','10434'
							 //String sql="select (select to_char(schedule_code||'-'||schedule_name ) from schedule_master1 where schedule_code=main_qry.schedule) as Schedule_details,main_qry.gl_code,main_qry.gl_name,main_qry.Debit,main_qry.Credit from (Select GL_Code,GL_Name,Category,1 AS flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0)  > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10327','40829','10328','10329','40830','10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45101','45102','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376','10385','40857','10386','10394','40861','10395','10396','40862','10397','10400','40864','10401','10418','40873','10419','10420','40874','10421','10431','40879','10432','10433','40880','10434')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=To_Date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376','10385','40857','10386','10394','40861','10395','10396','40862','10397','10400','40864','10401','10418','40873','10419','10420','40874','10421','10431','40879','10432','10433','40880','10434'))group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Liability','Asset')union Select GL_Code,GL_Name,Category,2 as flag,Schedule,case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then nvl(Opening_Balance.Opening_Balance,0) else 0 End as Credit, case when nvl(Opening_Balance.Opening_Balance,0) > 0 Then 0 else Abs(nvl(Opening_Balance.Opening_Balance,0)) End as Debit from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id || Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','40825','40826','10319','10320','10321','10322','45018','45019','45020','45045',									'20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376','10385','40857','10386','10394','40861','10395','10396','40862','10397','10400','40864','10401','10418','40873','10419','10420','40874','10421','10431','40879','10432','10433','40880','10434')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<=to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id || Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','40821','40822','10319','10320','10321','10322','40825','40826','45018','45019','45020','45045','20024','20091','20093','20096','30441','30443','30446','45012','45014','45015','45016','45017','45021','45023','45024','45027','45028','45030','45031','45034','45036','45038','45040','45041','45042','45043','45044','45046','45047','45048','45049','45050','45051','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','10373','40851','10374','10375','40852','10376','10385','40857','10386','10394','40861','10395','10396','40862','10397','10400','40864','10401','10418','40873','10419','10420','40874','10421','10431','40879','10432','10433','40880','10434')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where GL_Code!=0 and Category in ('Income','Expenditure') order by Schedule,GL_Code)main_qry where main_qry.Debit!=0 or main_qry.Credit!=0";
							//04.03.2024
							String sql = "Select a.Schedule || '-' || Schedule_Name as Schedule_Details,a.GL_Code,a.GL_Name,case when CB > 0 Then CB else 0 End as Credit,case when CB > 0 Then 0 else Abs(CB) End as Debit from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in (Select GL_Code from dbuser1.SK_GL)) group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where a.GL_Code!=0 and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";

							System.out.println(sql);
				 return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
					
				
					SimpleBranch gl=new SimpleBranch();
					
					gl.setS31(rs.getString(1));  // Schedule Details
					gl.setS41(rs.getInt(2));   // GL Code
				 	gl.setS32(rs.getString(3));   // GL Name
				 	gl.setS141(rs.getDouble(5));   // Debit
				 	gl.setS142(rs.getDouble(4));   // Credit
				 					 	
				 	return gl;
				}
							 }     );
						}
			
			
			 public int Save_Trial_Balance(String user,String Curren,int Bcode)
				
				{
				//--Set Connection----------------------------
				int j=Bcode;
				this.template=con.getCon2(j);
			//-----------------------------------------------------


					
					int flag=0;
					try{
						
						CallableStatement stmt=template.getDataSource().getConnection().prepareCall("{call Trial_Balace_Save(?,?,?)}");
						stmt.setString(1,user);
						stmt.setString(2,Curren);
						stmt.setInt(3,Bcode);
				
						
						stmt.executeQuery();
						flag=1;
						
					}											catch(Exception e)
				 	 {
					System.out.println(e);
				 	 }
					
					return  flag;
				}  



			 public List<SimpleBranch> getConsolidated_TrialBalance_224_233(String to_date1,int Bcode){

					//--Set Connection----------------------------
				 int j=Binfo;
								this.template=con.getCon2(j);
					//-----------------------------------------------------
//																select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name , Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code) left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 ) order by k.SCHEDULE
								//with erode select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name , Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,Case when t14.credit is not null then t14.credit else 0 end as c214,Case when t14.Debit is not null then t14.Debit else 0 end as d214,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='214' and DATE1=to_date('14/02/2019','dd/MM/yyyy'))t14 on (GL.GL_Code=t14.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 or c214!=0 or d214!=0)order by k.SCHEDULE;
								//select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name , Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,Case when t14.credit is not null then t14.credit else 0 end as c214,Case when t14.Debit is not null then t14.Debit else 0 end as d214,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='214' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t14 on (GL.GL_Code=t14.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 or c214!=0 or d214!=0)order by k.SCHEDULE;
		//up to 217 select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name , Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,Case when t14.credit is not null then t14.credit else 0 end as c214,Case when t14.Debit is not null then t14.Debit else 0 end as d214,Case when t15.credit is not null then t15.credit else 0 end as c215,Case when t15.Debit is not null then t15.Debit else 0 end as d215,Case when t16.credit is not null then t16.credit else 0 end as c216,Case when t16.Debit is not null then t16.Debit else 0 end as d216,Case when t17.credit is not null then t17.credit else 0 end as c217,Case when t17.Debit is not null then t17.Debit else 0 end as d217,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='214' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t14 on (GL.GL_Code=t14.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='215' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t15 on (GL.GL_Code=t15.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='216' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t16 on (GL.GL_Code=t16.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='217' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t17 on (GL.GL_Code=t17.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 or c214!=0 or d214!=0   or c215!=0 or d215!=0  or c216!=0 or d216!=0 or  c217!=0 or d217!=0)order by k.SCHEDULE;
					//old String sql="select k.*,case when (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)<0 then (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)|| ' Dr.' else (c201-d201+c202-d202+c203-d203+c204-d204+c205-d205+c206-d206+c207-d207+c208-d208+c209-d209+c210-d210+c211-d211+c212-d212+c213-d213+c214-d214+c215-d215+c216-d216+c217-d217)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name , Case when a.credit is not null then a.credit else 0 end as c201,Case when a.Debit is not null then a.Debit else 0 end as d201,Case when m.credit is not null then m.credit else 0 end as c202,Case when m.Debit is not null then m.Debit else 0 end as d202,Case when c.credit is not null then c.credit else 0 end as c203,Case when c.Debit is not null then c.Debit else 0 end as d203 ,Case when d.credit is not null then d.credit else 0 end as c204,Case when d.Debit is not null then d.Debit else 0 end as d204,Case when e.credit is not null then e.credit else 0 end as c205,Case when e.Debit is not null then e.Debit else 0 end as d205,Case when f.credit is not null then f.credit else 0 end as c206,Case when f.Debit is not null then f.Debit else 0 end as d206,Case when g.credit is not null then g.credit else 0 end as c207,Case when g.Debit is not null then g.Debit else 0 end as d207,Case when h.credit is not null then h.credit else 0 end as c208,Case when h.Debit is not null then h.Debit else 0 end as d208 ,Case when i.credit is not null then i.credit else 0 end as c209,Case when i.Debit is not null then i.Debit else 0 end as d209,Case when n.credit is not null then n.credit else 0 end as c210,Case when n.Debit is not null then n.Debit else 0 end as d210,Case when p.credit is not null then p.credit else 0 end as c211,Case when p.Debit is not null then p.Debit else 0 end as d211,Case when r.credit is not null then r.credit else 0 end as c212,Case when r.Debit is not null then r.Debit else 0 end as d212,Case when t.credit is not null then t.credit else 0 end as c213,Case when t.Debit is not null then t.Debit else 0 end as d213,Case when t14.credit is not null then t14.credit else 0 end as c214,Case when t14.Debit is not null then t14.Debit else 0 end as d214,Case when t15.credit is not null then t15.credit else 0 end as c215,Case when t15.Debit is not null then t15.Debit else 0 end as d215,Case when t16.credit is not null then t16.credit else 0 end as c216,Case when t16.Debit is not null then t16.Debit else 0 end as d216,Case when t17.credit is not null then t17.credit else 0 end as c217,Case when t17.Debit is not null then t17.Debit else 0 end as d217,gl.SCHEDULE   from (Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='201' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a on GL.GL_Code=a.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='202' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m on GL.GL_Code=m.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='203' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c on (GL.GL_Code=c.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='204' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d on (GL.GL_Code=d.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='205' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e  on (GL.GL_Code=e.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='206' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f on GL.GL_Code=f.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='207' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g on GL.GL_Code=g.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='208' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h on (GL.GL_Code=h.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='209' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i on (GL.GL_Code=i.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='210' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n  on (GL.GL_Code=n.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='211' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))p on GL.GL_Code=p.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='212' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))r on GL.GL_Code=r.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='213' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t on (GL.GL_Code=t.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='214' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t14 on (GL.GL_Code=t14.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='215' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t15 on (GL.GL_Code=t15.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='216' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t16 on (GL.GL_Code=t16.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='217' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))t17 on (GL.GL_Code=t17.GL_Code))k where (c201!=0 or d201!=0 or c202!=0 or d202!=0 or c203!=0 or d203!=0 or c204!=0 or d204!=0 or c205!=0 or d205!=0 or c206!=0 or d206!=0 or c207!=0 or d207!=0 or c208!=0 or d208!=0 or c209!=0 or d209!=0 or c210!=0 or d210!=0 or c211!=0 or d211!=0 or c212!=0 or d212!=0 or c213!=0 or d213!=0 or c214!=0 or d214!=0   or c215!=0 or d215!=0  or c216!=0 or d216!=0 or  c217!=0 or d217!=0)order by k.SCHEDULE";
					//new
	//							String sql="select k.*, case when (c224-d224+c225-d225+c226-d226+c227-d227+c228-d228+c229-d229+c230-d230+c231-d231+c232-d232+c233-d233)<0 then (c224-d224+c225-d225+c226-d226+c227-d227+c228-d228+c229-d229+c230-d230+c231-d231+c232-d232+c233-d233)|| ' Dr.' else (c224-d224+c225-d225+c226-d226+c227-d227+c228-d228+c229-d229+c230-d230+c231-d231+c232-d232+c233-d233)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name ,Case when a1.credit is not null then a1.credit else 0 end as c224,Case when a1.Debit is not null then a1.Debit else 0 end as d224,Case when m1.credit is not null then m1.credit else 0 end as c225,Case when m1.Debit is not null then m1.Debit else 0 end as d225,Case when c1.credit is not null then c1.credit else 0 end as c226,Case when c1.Debit is not null then c1.Debit else 0 end as d226 ,Case when d1.credit is not null then d1.credit else 0 end as c227,Case when d1.Debit is not null then d1.Debit else 0 end as d227,Case when e1.credit is not null then e1.credit else 0 end as c228,Case when e1.Debit is not null then e1.Debit else 0 end as d228,Case when f1.credit is not null then f1.credit else 0 end as c229,Case when f1.Debit is not null then f1.Debit else 0 end as d229,Case when g1.credit is not null then g1.credit else 0 end as c230,Case when g1.Debit is not null then g1.Debit else 0 end as d230,Case when h1.credit is not null then h1.credit else 0 end as c231,Case when h1.Debit is not null then h1.Debit else 0 end as d231 ,Case when i1.credit is not null then i1.credit else 0 end as c232,Case when i1.Debit is not null then i1.Debit else 0 end as d232,Case when n1.credit is not null then n1.credit else 0 end as c233,Case when n1.Debit is not null then n1.Debit else 0 end as d233,gl.SCHEDULE from ( Select gl_code,gl_name,SCHEDULE from dbuser1.GL_MASTER)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='224' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a1 on GL.GL_Code=a1.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='225' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m1 on GL.GL_Code=m1.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='226' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c1 on (GL.GL_Code=c1.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='227' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d1 on (GL.GL_Code=d1.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='228' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e1  on (GL.GL_Code=e1.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='229' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f1 on GL.GL_Code=f1.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='230' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g1 on GL.GL_Code=g1.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='231' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h1 on (GL.GL_Code=h1.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='232' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i1 on (GL.GL_Code=i1.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='233' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n1  on (GL.GL_Code=n1.GL_Code) ) k where (c224!=0 or d224!=0 or c225!=0 or d225!=0 or c226!=0 or d226!=0 or c227!=0 or d227!=0 or c228!=0 or d228!=0 or c229!=0 or d229!=0 or c230!=0 or d230!=0 or c231!=0 or d231!=0 or c232!=0 or d232!=0 or c233!=0 or d233!=0 )order by k.SCHEDULE";
//new2
								String sql="select k.*, case when (c224-d224+c225-d225+c226-d226+c227-d227+c228-d228+c229-d229+c230-d230+c231-d231+c232-d232+c233-d233)<0 then (c224-d224+c225-d225+c226-d226+c227-d227+c228-d228+c229-d229+c230-d230+c231-d231+c232-d232+c233-d233)|| ' Dr.' else (c224-d224+c225-d225+c226-d226+c227-d227+c228-d228+c229-d229+c230-d230+c231-d231+c232-d232+c233-d233)||' Cr.' end as total from (select GL.GL_Code,GL.GL_Name ,Case when a1.credit is not null then a1.credit else 0 end as c224,Case when a1.Debit is not null then a1.Debit else 0 end as d224,Case when m1.credit is not null then m1.credit else 0 end as c225,Case when m1.Debit is not null then m1.Debit else 0 end as d225,Case when c1.credit is not null then c1.credit else 0 end as c226,Case when c1.Debit is not null then c1.Debit else 0 end as d226 ,Case when d1.credit is not null then d1.credit else 0 end as c227,Case when d1.Debit is not null then d1.Debit else 0 end as d227,Case when e1.credit is not null then e1.credit else 0 end as c228,Case when e1.Debit is not null then e1.Debit else 0 end as d228,Case when f1.credit is not null then f1.credit else 0 end as c229,Case when f1.Debit is not null then f1.Debit else 0 end as d229,Case when g1.credit is not null then g1.credit else 0 end as c230,Case when g1.Debit is not null then g1.Debit else 0 end as d230,Case when h1.credit is not null then h1.credit else 0 end as c231,Case when h1.Debit is not null then h1.Debit else 0 end as d231 ,Case when i1.credit is not null then i1.credit else 0 end as c232,Case when i1.Debit is not null then i1.Debit else 0 end as d232,Case when n1.credit is not null then n1.credit else 0 end as c233,Case when n1.Debit is not null then n1.Debit else 0 end as d233,gl.SCHEDULE from ( select gl_code,(select gl_name from dbuser1.new_gl_view2 where gl_code=mainqry.gl_code and rownum=1) as gl_name,schedule from (select distinct (gl_code)as gl_code,schedule from dbuser1.new_gl_view2)mainqry)gl left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='224' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))a1 on GL.GL_Code=a1.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='225' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))m1 on GL.GL_Code=m1.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='226' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))c1 on (GL.GL_Code=c1.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='227' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))d1 on (GL.GL_Code=d1.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='228' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))e1  on (GL.GL_Code=e1.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='229' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))f1 on GL.GL_Code=f1.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='230' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))g1 on GL.GL_Code=g1.GL_Code left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='231' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))h1 on (GL.GL_Code=h1.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='232' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))i1 on (GL.GL_Code=i1.GL_Code)left join (select GL_Code,Credit,Debit from TRIAL_BALANCE_CONSOLIDATED where BCODE='233' and DATE1=to_date('"+to_date1+"','dd/MM/yyyy'))n1  on (GL.GL_Code=n1.GL_Code) ) k where (c224!=0 or d224!=0 or c225!=0 or d225!=0 or c226!=0 or d226!=0 or c227!=0 or d227!=0 or c228!=0 or d228!=0 or c229!=0 or d229!=0 or c230!=0 or d230!=0 or c231!=0 or d231!=0 or c232!=0 or d232!=0 or c233!=0 or d233!=0 )order by k.SCHEDULE";

					return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
						
					
						SimpleBranch gl=new SimpleBranch();
						
						
						gl.setS41(rs.getInt(1));   // GL Code
						
						gl.setS2(rs.getString(2));   // GL Name
						
					  	gl.setS141(rs.getDouble(3));   // c201
					 	gl.setS142(rs.getDouble(4));   // d201
					 	
					 	gl.setS143(rs.getDouble(5));   // c202
					 	gl.setS144(rs.getDouble(6));   // d202
					 	
					 	gl.setS145(rs.getDouble(7));   // c203
					 	gl.setS146(rs.getDouble(8));   // d203
					 	
					 	gl.setS147(rs.getDouble(9));   // c204
					 	gl.setS148(rs.getDouble(10));   // d204
					 	
					 	gl.setS149(rs.getDouble(11));   // c205
					 	gl.setS150(rs.getDouble(12));   // d205
					 	
					 	gl.setS151(rs.getDouble(13));   // c206
					 	gl.setS152(rs.getDouble(14));   // d206
					 	
					 	gl.setS153(rs.getDouble(15));   // c207
					 	gl.setS154(rs.getDouble(16));   // d207
					 	
					 	gl.setS155(rs.getDouble(17));   // c208
					 	gl.setS156(rs.getDouble(18));   // d208
					 	
					 	gl.setS157(rs.getDouble(19));   // c209
					 	gl.setS158(rs.getDouble(20));   // d209
					 	
					 	gl.setS159(rs.getDouble(21));   // c210
					 	gl.setS160(rs.getDouble(22));   // d210
					 	
					 	
					  	
					 	
					 	gl.setS3(rs.getString(23));   // Schedule
					 	gl.setS4(rs.getString(24));   // Total
					 	
						return gl;
					}
								 }     );
							}
			 
			 
			 
			 public List<SimpleBranch> getForm15GH_CD (String From_Date,String To_Date,String Type1,int Bcode){

					//--Set Connection----------------------------
				           int j=Bcode;
					this.template=con.getCon2(j);
					//-----------------------------------------------------
					//String sql="select Customer_id,Customer_name,Account_No,Pan_No,interest,Period,Compounding,to_char(int_date,'dd/MM/yyyy'),type1 from (select c.customer_id,c.customer_name,a.account_no,c.pan_no,c.date_of_birth,sum(a.interest) as interest,a.period,b.compounding,case when b.closed_date is null then to_date('"+To_Date+"','dd/MM/yyyy') else case when b.closed_date>=to_date('"+To_Date+"','dd/MM/yyyy') then to_date('"+To_Date+"','dd/MM/yyyy') else b.closed_date end  end  as int_date,case when c.date_of_birth>to_date('31/03/1960','dd/MM/yyyy')then 'G' else 'H' end as type1,b.DEDUCT_TDS from (select fd_interest.account_no,sum(interest) as interest,to_char(to_date,'MM-YYYY') as Period from fd_interest left join fd_master on  fd_interest.account_no=fd_master.account_no where fd_interest.To_Date<=nvl(FD_Master.Closed_Date,Maturity_Date) and to_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by fd_interest.account_no,to_char(to_date,'MM-YYYY')) a left join fd_master b on a.account_no=b.account_no left join customer c on b.customer_id=c.customer_id group by c.customer_id,c.customer_name,a.account_no,c.pan_no,c.date_of_birth,a.period,b.compounding,b.closed_date,b.DEDUCT_TDS  order by c.customer_id,a.period)main_qry where main_qry.type1='"+Type1+"' and main_qry.interest>0  and main_qry.DEDUCT_TDS in ('N','No','NO')and main_qry.compounding ='Y'";
						//dob  07-07-2021
					String sql="select new_main.*,(select date_of_birth from customer where customer_id=new_main.customer_id) as dob from (select Customer_id,Customer_name,Account_No,Pan_No,interest,Period,Compounding,to_char(int_date,'dd/MM/yyyy'),type1 from (select c.customer_id,c.customer_name,a.account_no,c.pan_no,c.date_of_birth,sum(a.interest) as interest,a.period,b.compounding,case when b.closed_date is null then to_date('"+To_Date+"','dd/MM/yyyy') else case when b.closed_date>=to_date('"+To_Date+"','dd/MM/yyyy') then to_date('"+To_Date+"','dd/MM/yyyy') else b.closed_date end  end  as int_date,case when c.date_of_birth>to_date('01/04/1960','dd/MM/yyyy')then 'G' else 'H' end as type1,b.DEDUCT_TDS from (select fd_interest.account_no,sum(interest) as interest,to_char(to_date,'MM-YYYY') as Period from fd_interest left join fd_master on  fd_interest.account_no=fd_master.account_no where fd_interest.To_Date<=nvl(FD_Master.Closed_Date,Maturity_Date) and to_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by fd_interest.account_no,to_char(to_date,'MM-YYYY')) a left join fd_master b on a.account_no=b.account_no left join customer c on b.customer_id=c.customer_id group by c.customer_id,c.customer_name,a.account_no,c.pan_no,c.date_of_birth,a.period,b.compounding,b.closed_date,b.DEDUCT_TDS  order by c.customer_id,a.period)main_qry where main_qry.type1='"+Type1+"' and main_qry.interest>0  and main_qry.DEDUCT_TDS in ('N','No','NO')and main_qry.compounding ='Y')new_main";
					System.out.println(sql);
					return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
						
						SimpleBranch gl=new SimpleBranch();
						
						gl.setS31(rs.getString(1));   // Cusid
					 	gl.setS32(rs.getString(2));   // Name
					 	gl.setS33(rs.getString(3));   // Acc No
					 	gl.setS34(rs.getString(4));   // Pan 
					 	gl.setS141(rs.getDouble(5));   // int
					 	gl.setS35(rs.getString(6));   // Period
					 	gl.setS36(rs.getString(7));   // comp		
					 	gl.setS37(rs.getString(8));   // Date
					 	gl.setS3(rs.getString(9));   	// type
					 	gl.setS4("TN");   // Residencial status	
					 	
					 	//new
						gl.setS38(rs.getString(10));   // Dob
					 	
					 	
						return gl;
					}
								 }     );
							}
			 
			 public List<SimpleBranch> getForm15GH_FD (String From_Date,String To_Date,String Type1,int Bcode){

					//--Set Connection----------------------------
				           int j=Bcode;
					this.template=con.getCon2(j);
					//-----------------------------------------------------
					//String sql="select Customer_id,Customer_name,Account_No,Pan_No,interest,Period,Compounding,to_char(int_date,'dd/MM/yyyy'),type1 from (select c.customer_id,c.customer_name,a.account_no,c.pan_no,c.date_of_birth,sum(a.interest) as interest,a.period,b.compounding,case when b.closed_date is null then to_date('"+To_Date+"','dd/MM/yyyy') else case when b.closed_date>=to_date('"+To_Date+"','dd/MM/yyyy') then to_date('"+To_Date+"','dd/MM/yyyy') else b.closed_date end  end  as int_date,case when c.date_of_birth>to_date('31/03/1960','dd/MM/yyyy')then 'G' else 'H' end as type1,b.DEDUCT_TDS from (select fd_interest.account_no,sum(interest) as interest,to_char(to_date,'MM-YYYY') as Period from fd_interest left join fd_master on  fd_interest.account_no=fd_master.account_no where fd_interest.To_Date<=nvl(FD_Master.Closed_Date,Maturity_Date) and to_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by fd_interest.account_no,to_char(to_date,'MM-YYYY')) a left join fd_master b on a.account_no=b.account_no left join customer c on b.customer_id=c.customer_id group by c.customer_id,c.customer_name,a.account_no,c.pan_no,c.date_of_birth,a.period,b.compounding,b.closed_date,b.DEDUCT_TDS  order by c.customer_id,a.period)main_qry where main_qry.type1='"+Type1+"' and main_qry.interest>0  and main_qry.DEDUCT_TDS in ('N','No','NO')and main_qry.compounding !='Y'";
					//07-07-2021 dob
					String sql="select new_main.*,(select date_of_birth from customer where customer_id=new_main.customer_id) as dob from (select Customer_id,Customer_name,Account_No,Pan_No,interest,Period,Compounding,to_char(int_date,'dd/MM/yyyy'),type1 from (select c.customer_id,c.customer_name,a.account_no,c.pan_no,c.date_of_birth,sum(a.interest) as interest,a.period,b.compounding,case when b.closed_date is null then to_date('"+To_Date+"','dd/MM/yyyy') else case when b.closed_date>=to_date('"+To_Date+"','dd/MM/yyyy') then to_date('"+To_Date+"','dd/MM/yyyy') else b.closed_date end  end  as int_date,case when c.date_of_birth>to_date('01/04/1960','dd/MM/yyyy')then 'G' else 'H' end as type1,b.DEDUCT_TDS from (select fd_interest.account_no,sum(interest) as interest,to_char(to_date,'MM-YYYY') as Period from fd_interest left join fd_master on  fd_interest.account_no=fd_master.account_no where fd_interest.To_Date<=nvl(FD_Master.Closed_Date,Maturity_Date) and to_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') group by fd_interest.account_no,to_char(to_date,'MM-YYYY')) a left join fd_master b on a.account_no=b.account_no left join customer c on b.customer_id=c.customer_id group by c.customer_id,c.customer_name,a.account_no,c.pan_no,c.date_of_birth,a.period,b.compounding,b.closed_date,b.DEDUCT_TDS  order by c.customer_id,a.period)main_qry where main_qry.type1='"+Type1+"' and main_qry.interest>0  and main_qry.DEDUCT_TDS in ('N','No','NO')and main_qry.compounding !='Y')new_main";
					System.out.println(sql);
					return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
						
						SimpleBranch gl=new SimpleBranch();
						
						gl.setS31(rs.getString(1));   // Cusid
					 	gl.setS32(rs.getString(2));   // Name
					 	gl.setS33(rs.getString(3));   // Acc No
					 	gl.setS34(rs.getString(4));   // Pan 
					 	gl.setS141(rs.getDouble(5));   // int
					 	gl.setS35(rs.getString(6));   // Period
					 	gl.setS36(rs.getString(7));   // comp		
					 	gl.setS37(rs.getString(8));   // Date
					 	gl.setS3(rs.getString(9));   	// type
					 	gl.setS4("TN");   // Residencial status					 	
					 	
					 	//new
						gl.setS38(rs.getString(10));   // Dob
					 		
						return gl;
					}
								 }     );
							}
			 
			 
			 public List<SimpleBranch> getForm15GH_SD (String From_Date,String To_Date,String branch,String Type1,int Bcode){

					//--Set Connection----------------------------
				           int j=Binfo;
					this.template=con.getCon2(j);
					//-----------------------------------------------------
					//String sql="select customer_id,customer_name,account_no,amt1 from (select b.*,ROUND((b.prod * b.roi / 36500))as amt1 from (select Account_No,"+branch+".sb_product2225(Account_No,'"+From_Date+"','"+To_Date+"') as prod, (select a.interest_rate from (SELECT interest_rate FROM "+branch+".INTEREST_RATE_MASTER where scheme_code=sbca_master.scheme_code order by effect_date desc)a where rownum=1) as roi,customer_id,customer_name  from "+branch+".sbca_master where Account_Status in ('A','I') )b and order by customer_id) where amt1>0";
//String sql="select substr(a.account_no,0,3) as branch,a.Account_no,c.Customer_id,c.customer_name,c.open_date,c.closing_balance ,a.paid_interest,to_char(b.paid_date,'dd/MM/yyyy') from (select Account_No, sum(transaction_amount)as paid_interest from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from sbca_master_view_c)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)a left join (select Account_No, max(transaction_date)as paid_date from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from sbca_master_view_c)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)b on a.Account_no=b.Account_No left join (select Customer_id,customer_name,Account_no,open_date,closing_balance from sbca_master_view_c) c on a.Account_no=c.Account_no where a.Account_no like '"+Bcode+"%' order by a.Account_no ";


//09-03-2021
String sql="select qry3.* from (select qry2.*,case when qry2.dob>to_date('01/04/1960','dd/MM/yyyy')then 'G' else 'H' end as type1 from (select qry.*,(select pan_no from customer_view where Customer_id=qry.Customer_id and rownum=1) as panno,(select date_of_birth from customer_view where Customer_id=qry.Customer_id and rownum=1) as dob from  (select substr(a.account_no,0,3) as branch,a.Account_no,c.Customer_id,c.customer_name,c.open_date,c.closing_balance ,a.paid_interest,to_char(b.paid_date,'dd/MM/yyyy') from (select Account_No, sum(transaction_amount)as paid_interest from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from sbca_master_view_c)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)a left join (select Account_No, max(transaction_date)as paid_date from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from sbca_master_view_c)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)b on a.Account_no=b.Account_No left join (select Customer_id,customer_name,Account_no,open_date,closing_balance from sbca_master_view_c) c on a.Account_no=c.Account_no where a.Account_no like '"+Bcode+"%' order by a.Account_no)qry)qry2)qry3 where qry3.type1='"+Type1+"'";


System.out.println(sql);				
return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
						
						SimpleBranch gl=new SimpleBranch();
						
						gl.setS31(rs.getString(3));   // Cusid
					 	gl.setS32(rs.getString(4));   // Name
					 	gl.setS33(rs.getString(2));   // Acc No
					 	
					 	gl.setS34(rs.getString(9));   // Pan 
					 	//gl.setS34("");   // Pan 
					 	gl.setS141(rs.getDouble(7));   // int
					 	gl.setS35(rs.getString(5));   // Period
					 	gl.setS36(rs.getString(1));   // comp		
					 	gl.setS37(rs.getString(8));   // Date
					 	//gl.setS3(branch);   	// type
					 	gl.setS3(rs.getString(11));   	// type

					 	gl.setS4("TN");   // Residencial status					 	
					 	
					 	//new
						gl.setS38(rs.getString(10));   // Dob
					 	
					 	
						return gl;
					}
								 }     );
							}


			 public List<SimpleBranch> sowbhagya_DDS_Report(String sql)
			 {

					//--Set Connection----------------------------
								int j=Binfo;
								this.template=con.getCon2(j);
					//-----------------------------------------------------

						System.out.println(sql);
						
						return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException					{  

						SimpleBranch gl=new SimpleBranch();
						SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");
						 DecimalFormat df = new DecimalFormat("#.00");   
						
						gl.setS31(rs.getString(1));  //BNAME
						gl.setS41(rs.getInt(3));  //New_DDS_count
						gl.setS42(rs.getInt(5));  //Active_DDS_COUNT
						gl.setS43(rs.getInt(7));  //Closed_DDS_COUNT
						
						
						
						
						gl.setS32(df.format(rs.getFloat(4)));  //New_DDS_BALANCE
						gl.setS33(df.format(rs.getFloat(6)));  //Active_DDS_BALANCE
						gl.setS34(df.format(rs.getFloat(8)));  //Closed_DDS_BALANCE
						gl.setS135(df.format(rs.getFloat(9))); //Total amount
						
						
						
						
						gl.setS164(rs.getFloat(4));  //New_DDS_BALANCE
						gl.setS143(rs.getFloat(6));  //Active_DDS_BALANCE
						gl.setS144(rs.getFloat(8));  //Closed_DDS_BALANCE
						gl.setS145(rs.getFloat(9)); // Total Amount
						
						return gl;
					}
					 }     );
				}

			 public String getBranchdb(int Date1,int n) {
					//--Set Connection------------------------------------
					int j=Binfo;
					this.template=con.getCon2(j);
					//-----------------------------------------------------
					
					
					String i=null;
					PreparedStatement pstmt = null;
					try {
						pstmt = template.getDataSource().getConnection().prepareStatement("select uname from hh where bcode=? and rownum=1");
						pstmt.setInt(1, Date1);
						
						
					} catch (SQLException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
					ResultSet resultSet = null;
					try {
						resultSet = pstmt.executeQuery();
						resultSet.next();
					} catch (SQLException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
					
					try {
						i=resultSet.getString(1);
						
						//i=resultSet.getRow();
					} catch (SQLException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
						
					return i;
				}
			 
			 
			 public List<SimpleBranch> getForm15GH_RD (String From_Date,String To_Date,String Type,int Bcode){

					//--Set Connection----------------------------
				           int j=Binfo;
					this.template=con.getCon2(j);
					//-----------------------------------------------------
					//String sql="select customer_id,customer_name,account_no,amt1 from (select b.*,ROUND((b.prod * b.roi / 36500))as amt1 from (select Account_No,"+branch+".sb_product2225(Account_No,'"+From_Date+"','"+To_Date+"') as prod, (select a.interest_rate from (SELECT interest_rate FROM "+branch+".INTEREST_RATE_MASTER where scheme_code=sbca_master.scheme_code order by effect_date desc)a where rownum=1) as roi,customer_id,customer_name  from "+branch+".sbca_master where Account_Status in ('A','I') )b and order by customer_id) where amt1>0";
//String sql="select substr(a.account_no,0,3) as branch,a.Account_no,c.Customer_id,c.customer_name,to_char(c.open_date,'dd/MM/yyyy'),c.maturity_date ,a.paid_interest,to_char(b.paid_date,'dd/MM/yyyy') from (select Account_No, sum(transaction_amount)as paid_interest from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from rd_view)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)a left join (select Account_No, max(transaction_date)as paid_date from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from rd_view)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)b on a.Account_no=b.Account_No left join (select Customer_id,customer_name,Account_no,open_date,maturity_date from rd_view) c on a.Account_no=c.Account_no where a.Account_no like '"+Bcode+"%' order by a.Account_no";
//String sql="select old_qry.* from (select substr(a.account_no,0,3) as branch,a.Account_no,c.Customer_id,c.customer_name,to_char(c.open_date,'dd/MM/yyyy'),c.maturity_date ,a.paid_interest,to_char(b.paid_date,'dd/MM/yyyy'),(select pan_no from dbuser1.customer_view where customer_id=c.customer_id and rownum=1) as pan_no,(select case when date_of_birth>to_date('01/04/1960','dd/MM/yyyy') then 'H' else 'G' end from dbuser1.customer_view where customer_id=c.customer_id and rownum=1) as dob  from (select Account_No, sum(transaction_amount)as paid_interest from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from rd_view)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)a left join (select Account_No, max(transaction_date)as paid_date from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from rd_view)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)b on a.Account_no=b.Account_No left join (select Customer_id,customer_name,Account_no,open_date,maturity_date from rd_view) c on a.Account_no=c.Account_no where a.Account_no like '"+Bcode+"%' order by a.Account_no)old_qry where old_qry.DOB like '"+Type+"%'";
//String sql="select k.* from (select old_qry.*,(select substr(uin,0,1) from dbuser1.form_15g where customer_id=old_qry.Customer_id and rownum=1) as type2 from (select substr(a.account_no,0,3) as branch,a.Account_no,c.Customer_id,c.customer_name,to_char(c.open_date,'dd/MM/yyyy'),c.maturity_date ,a.paid_interest,to_char(b.paid_date,'dd/MM/yyyy'),(select pan_no from dbuser1.customer_view where customer_id=c.customer_id and rownum=1) as pan_no,(select case when date_of_birth>to_date('01/04/1960','dd/MM/yyyy') then 'H' else 'G' end from dbuser1.customer_view where customer_id=c.customer_id and rownum=1) as dob  from (select Account_No, sum(transaction_amount)as paid_interest from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from rd_view)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)a left join (select Account_No, max(transaction_date)as paid_date from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from rd_view)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)b on a.Account_no=b.Account_No left join (select Customer_id,customer_name,Account_no,open_date,maturity_date from rd_view) c on a.Account_no=c.Account_no where a.Account_no like '"+Bcode+"%' order by a.Account_no)old_qry)k where k.type2 like '"+Type+"%'";
//select new_main.*,(select date_of_birth from customer where customer_id=new_main.customer_id) as dob from (
// new dob 07-07-2021
String sql="select new_main.*,(select date_of_birth from dbuser1.customer_view where customer_id=new_main.customer_id and rownum=1) as dob from (select k.* from (select old_qry.*,(select substr(uin,0,1) from dbuser1.form_15g where customer_id=old_qry.Customer_id and rownum=1) as type2 from (select substr(a.account_no,0,3) as branch,a.Account_no,c.Customer_id,c.customer_name,to_char(c.open_date,'dd/MM/yyyy'),c.maturity_date ,a.paid_interest,to_char(b.paid_date,'dd/MM/yyyy'),(select pan_no from dbuser1.customer_view where customer_id=c.customer_id and rownum=1) as pan_no,(select case when date_of_birth>to_date('01/04/1960','dd/MM/yyyy') then 'G' else 'H' end from dbuser1.customer_view where customer_id=c.customer_id and rownum=1) as dob  from (select Account_No, sum(transaction_amount)as paid_interest from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from rd_view)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)a left join (select Account_No, max(transaction_date)as paid_date from daily_transaction_table where transaction_date between to_date('"+From_Date+"','dd/MM/yyyy') and to_date('"+To_Date+"','dd/MM/yyyy') and Account_no in (select distinct account_no from rd_view)and transaction_type='Credit' and flag='INT' group by account_No order by Account_no)b on a.Account_no=b.Account_No left join (select Customer_id,customer_name,Account_no,open_date,maturity_date from rd_view) c on a.Account_no=c.Account_no where a.Account_no like '"+Bcode+"%' order by a.Account_no)old_qry)k where k.type2 like '"+Type+"%')new_main";

System.out.println(sql);
return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
						
						SimpleBranch gl=new SimpleBranch();
						
						gl.setS31(rs.getString(3));   // Cusid
					 	gl.setS32(rs.getString(4));   // Name
					 	gl.setS33(rs.getString(2));   // Acc No
					 	gl.setS34(rs.getString(9));   // Pan 
					 	gl.setS141(rs.getDouble(7));   // int
					 	gl.setS35(rs.getString(5));   // Period
					 	gl.setS36(rs.getString(1));   // comp		
					 	gl.setS37(rs.getString(8));   // Date
					 	gl.setS3(rs.getString(11));   	// type
					 	gl.setS4("Y");   // Residencial status					 	
					 	
					 	//new
						gl.setS38(rs.getString(12));   // Dob
					 	
						return gl;
					}
								 }     );
							}


			 public String AddMonths_ToDate(String Date1,int n) {
					//--Set Connection------------------------------------
					int j=Binfo;
					this.template=con.getCon2(j);
					//-----------------------------------------------------
					//Changed quer 28-01-2020
					
				/*	String i=null;
					String query = "select to_char(Add_months(to_date('"+Date1+"','dd/MM/yyyy'),"+n+"),'dd/MM/yyyy') from dual";

					PreparedStatement pstmt = null;
					try {
						pstmt = template.getDataSource().getConnection().prepareStatement(query);
					} catch (SQLException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
					ResultSet resultSet = null;
					try {
						resultSet = pstmt.executeQuery();
						resultSet.next();
					} catch (SQLException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
					
					try {
						i=resultSet.getString(1);
						
						//i=resultSet.getRow();
					} catch (SQLException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
						
					return i;*/
					
					String i=null;
					PreparedStatement pstmt = null;
					try {
						pstmt = template.getDataSource().getConnection().prepareStatement("select to_char(Add_months(to_date(?,'dd/MM/yyyy'),?),'dd/MM/yyyy') from dual");
						pstmt.setString(1, Date1);
						pstmt.setInt(2, n);
						
					} catch (SQLException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
					ResultSet resultSet = null;
					try {
						resultSet = pstmt.executeQuery();
						resultSet.next();
					} catch (SQLException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
					
					try {
						i=resultSet.getString(1);
						
						//i=resultSet.getRow();
					} catch (SQLException e) {
						// TODO Auto-generated catch block
						e.printStackTrace();
					}
						
					return i;
				} 
			 
			 public List<SimpleBranch> DDS_Report_View(String sql)
			 {
					//--Set Connection----------------------------
								int j=Binfo;
								this.template=con.getCon2(j);
					//-----------------------------------------------------
						System.out.println(sql);
						
						return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException					{  

						SimpleBranch gl=new SimpleBranch();
						SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");
						 DecimalFormat df = new DecimalFormat("#.00");   
						
						gl.setS31(rs.getString(1));  //BNAME
						gl.setS41(rs.getInt(2));  //BCODE
						gl.setS35(rs.getString(3)); //account no
						gl.setS36(rs.getString(4)); //account no
						gl.setS37(rs.getString(5)); //open date
						
						gl.setS38(sd.format(rs.getDate(5)));
						
						gl.setS32(df.format(rs.getFloat(6)));  //closing balance
						gl.setS33(df.format(rs.getFloat(7)));  //trans amount
						
						
						gl.setS144(rs.getFloat(6));  //Closed_DDS_BALANCE
						gl.setS145(rs.getFloat(7)); // Total Amount
						
						return gl;
					}
					 }     );
				}
			 public List<SimpleBranch> DDS_Portfolio_Growth(String sql)
			 {
					//--Set Connection----------------------------
								int j=Binfo;
								this.template=con.getCon2(j);
					//-----------------------------------------------------
						System.out.println(sql);
						
						return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException					{  

						SimpleBranch gl=new SimpleBranch();
						SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");
						 DecimalFormat df = new DecimalFormat("#.00");   
						
						gl.setS31(rs.getString(1));  //BNAME
						gl.setS41(rs.getInt(2));  //BCODE
					
						gl.setS11(rs.getInt(3)); //daily active
						gl.setS12(rs.getInt(6)); //sow active
						gl.setS47(rs.getInt(9)); // sow 1500active
						gl.setS48(rs.getInt(12)); // subakalyan 1500
						
						
						gl.setS32(df.format(rs.getFloat(4)));  //daily balance
						gl.setS33(df.format(rs.getFloat(5)));  // daily amount
						gl.setS34(df.format(rs.getFloat(7))); // sow balance
						gl.setS35(df.format(rs.getFloat(8))); // sow amount
						gl.setS36(df.format(rs.getFloat(10))); //sow 1500 balance
						gl.setS37(df.format(rs.getFloat(11))); // sow 1500 amount
						gl.setS38(df.format(rs.getFloat(13))); // subakalyan balance
						gl.setS39(df.format(rs.getFloat(14))); // subakalyan amount
						
						
						
						
						gl.setS144(rs.getFloat(4));  
						gl.setS145(rs.getFloat(5));
						gl.setS146(rs.getFloat(7));
						gl.setS147(rs.getFloat(8));
						gl.setS148(rs.getFloat(10));
						gl.setS149(rs.getFloat(11));
						gl.setS150(rs.getFloat(13));
						gl.setS151(rs.getFloat(14));
						
						
						
						
						return gl;
					}
					 }     );
				}


			 public List<SimpleBranch> getProfitLossWithoutEsc(String Select_Date,int Bcode){

					//--Set Connection----------------------------
				           int j=Bcode;
					this.template=con.getCon2(j);
					//-----------------------------------------------------
					//String sql="WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule";
					//new  30-06-2021
					// String sql="select k.* from ( WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No='29006') group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No='29006') group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule )k where k.account_code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814')and k.Op_Balance!=0"; 

					 //30-06-2021 updated
					//String sql="select k.* from ( WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule )k where k.account_code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814')and k.Op_Balance!=0"; 

					 //19-08-2021 updated
				//	String sql="select k.* from ( WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule )k where k.account_code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053')and k.Op_Balance!=0"; 
 
					//09-11-2021 45103,45104,45105,45106,45107 
					//String sql="select k.* from ( WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107')) group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107')) group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule )k where k.account_code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','45103','45104','45105','45106','45107')and k.Op_Balance!=0"; 

					
					//09-12-2021 '29006','10327','40829','10328','10329','40830','10330'
					//String sql="select k.* from ( WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107')) group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','10327','40829','10328','10329','40830','10330','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107')) group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule )k where k.account_code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10327','40829','10328','10329','40830','10330','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','45103','45104','45105','45106','45107')and k.Op_Balance!=0"; 

					//01-04-2022 NEW SK CD''10335','40833','10336'
					//String sql="select k.* from ( WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107','10335','40833','10336')) group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','10327','40829','10328','10329','40830','10330','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107','10335','40833','10336')) group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule )k where k.account_code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10327','40829','10328','10329','40830','10330','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','45103','45104','45105','45106','45107','10335','40833','10336')and k.Op_Balance!=0"; 

					//13-04-2022 '45112','41007'
					//String sql="select k.* from ( WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007')) group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','10327','40829','10328','10329','40830','10330','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007')) group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule )k where k.account_code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10327','40829','10328','10329','40830','10330','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007')and k.Op_Balance!=0"; 

			//not used		//10-05-2022 '45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111' profit and loss
			//not used		//String sql="select k.* from ( WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111')) group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','10327','40829','10328','10329','40830','10330','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111')) group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule )k where k.account_code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10327','40829','10328','10329','40830','10330','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111')and k.Op_Balance!=0"; 

					//09-08-2022 New SK JL & FD '10341','40835','10342','20066','30413','20067'
					 // String sql="select k.* from ( WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','10341','40835','10342','20066','30413','20067')) group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','10327','40829','10328','10329','40830','10330','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','10341','40835','10342','20066','30413','20067')) group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule )k where k.account_code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10327','40829','10328','10329','40830','10330','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','10341','40835','10342','20066','30413','20067')and k.Op_Balance!=0"; 

					//16-08-2022 New SK CD & FD '10347','40838','10348','10349','40839','10350'
					  //String sql="select k.* from ( WITH cte AS(SELECT Account_Code,Opening_Balance,ROW_NUMBER() OVER (PARTITION BY Account_Code ORDER BY OB_DATE DESC) AS rn FROM GL_Opening_Balance  where OB_DATE<to_date('"+Select_Date+"','dd/MM/yyyy')) Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master Left JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance  End  + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,Opening_Balance as Opening_Balance from cte where rn=1) Opening_Balance full join (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Credit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350' )) group by Account_No) Receipts on Opening_Balance.Account_Code=Receipts.Account_No full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and  Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','10327','40829','10328','10329','40830','10330','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350' )) group by Account_No) Payments on Opening_Balance.Account_Code=Payments.Account_No) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'A%' or Schedule like 'B%' order by GL_Master.Schedule )k where k.account_code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10327','40829','10328','10329','40830','10330','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350' )and k.Op_Balance!=0"; 

					//04.03.2024
						String sql = "Select a.GL_Code as Account_Code,a.GL_Name as Account_Name,Category,Schedule,CB as OP_BALANCE from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in (Select GL_Code from dbuser1.SK_GL)) group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where Category in ('Income','Expenditure') and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";
						
					return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
						
						SimpleBranch gl=new SimpleBranch();
						
						gl.setS41(rs.getInt(1));  // Account Code
						gl.setS31(rs.getString(2));   // Account Name
					 	gl.setS32(rs.getString(3));   // Category
					 	gl.setS33(rs.getString(4));   // Schedule
					 	gl.setS51(rs.getFloat(5));   // OP Balance
					 	
					 	
						return gl;
					}
								 }     );
							}
			 

			 
			 public List<SimpleBranch> getBalanceSheetWithoutEscro(String Select_Date,int Bcode){

					//--Set Connection----------------------------
								int j=Bcode;
								this.template=con.getCon2(j);
					//-----------------------------------------------------
								//String sql="select k.* from (Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date(' "+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL' group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date(' "+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'C%' or Schedule like 'D%' order by GL_Master.Schedule)k where k.Account_Code not in (29006,10245,10246,40803,10247,10248,40804,10249,10250,40805)";
					//30-06-2021
							//	String sql="select k.* from (Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL'and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No='29006') group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No='29006') group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'C%' or Schedule like 'D%' order by GL_Master.Schedule)k where k.Account_Code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814') and k.Op_Balance!=0";
	
						//30-06-2021 updated
							//	String sql="select k.* from (Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL'and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'C%' or Schedule like 'D%' order by GL_Master.Schedule)k where k.Account_Code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814') and k.Op_Balance!=0";

								//19-08-2021 updated 
								
								//String sql="select k.* from (Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL'and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'C%' or Schedule like 'D%' order by GL_Master.Schedule)k where k.Account_Code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814') and k.Op_Balance!=0";
//'29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053'
								//01-09-2021
								//String sql="select k.* from (Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL'and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'C%' or Schedule like 'D%' order by GL_Master.Schedule)k where k.Account_Code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814') and k.Op_Balance!=0";

								//09-11-2021 45103,45104,45105,45106,45107	 new branch sk
								//String sql="select k.* from (Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL'and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','45103','45104','45105','45106','45107')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'C%' or Schedule like 'D%' order by GL_Master.Schedule)k where k.Account_Code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','45103','45104','45105','45106','45107') and k.Op_Balance!=0";

								//09-12-2021 '29006','10327','40829','10328','10329','40830','10330' new fd
							//	String sql="select k.* from (Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL'and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in('29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','45103','45104','45105','45106','45107')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'C%' or Schedule like 'D%' order by GL_Master.Schedule)k where k.Account_Code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10327','40829','10328','10329','40830','10330','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','45103','45104','45105','45106','45107') and k.Op_Balance!=0";

								//23-02-2024 ,'10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','30451','30414','20068','10373','40851','10374','10375','40852','10376','10385','40857','10386','10394','40861','10395','10396','40862','10397','10400','40864','10401','10404','40866','10405','10410','40869','10411','10412','40870','10413','10418','40873','10419','10420','40874','10421','10431','40879','10432','10433','40880','10434'
								//String sql="select k.* from (Select GL_Master.GL_Code as Account_Code,GL_Name as Account_Name,Category,Schedule,Case when Opening_Balance.Opening_Balance is NULL Then 0 else Opening_Balance.Opening_Balance End as Op_Balance from GL_Master FULL JOIN (Select Opening_Balance.Account_Code,case when Opening_Balance is NULL Then 0 else Opening_Balance End + case when Receipt is NULL then 0 else Receipt End - case when Payment is NULL Then 0 else Payment End as Opening_Balance from (Select Account_Code,case when sum(Opening_Balance) is Null Then 0 else sum(Opening_Balance) End as Opening_Balance from GL_Opening_Balance group by Account_Code)Opening_Balance full join (Select case when Receipts.Account_No is NULL Then Payments.Account_No else Receipts.Account_No End as Account_Code,case when Receipt is NULL Then 0 else Receipt End as Receipt,case when Payment is NULL Then 0 else Payment End as Payment from (select Account_No,sum(Transaction_Amount) as Receipt from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Credit' and Flag='GL'and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in('29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','10311','40821','10312','10313','40822','10314','10288','40817','10289','45013','45026','45032','45053','45103','45104','45105','45106','45107','10335','40833','10336','45112','41007','45103','45104','45105','45106','45107','45108','45109','45110','45111','10341','40835','10342','20066','30413','20067','10347','40838','10348','10349','40839','10350','45115','45116','45117','45118','10355','40842','10356','10357','40843','10358','45113','45115','45116','45117','45118','45119','45120','45121','45122','10367','40848','10368','10369','40849','10370','20201','20202','20203','30415','30416','30452','30451','30414','20068','10373','40851','10374','10375','40852','10376','10385','40857','10386','10394','40861','10395','10396','40862','10397','10400','40864','10401','10404','40866','10405','10410','40869','10411','10412','40870','10413','10418','40873','10419','10420','40874','10421','10431','40879','10432','10433','40880','10434')) group by Account_No) Receipts full join (select Account_No,sum(Transaction_Amount) as Payment from Daily_Transaction where Transaction_Date<to_date('"+Select_Date+"','dd/MM/yyyy') and Transaction_Type='Debit' and Flag='GL' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in ('29006','10327','40829','10328','10329','40830','10330','45039','45022','45037','45035','45011','45025','45029','30442','20092','45103','45104','45105','45106','45107')) group by Account_No) Payments on Receipts.Account_No =Payments.Account_No) RandC on Opening_Balance.Account_Code=RandC.Account_Code) Opening_Balance on GL_Master.GL_Code=Opening_Balance.Account_Code where Schedule like 'C%' or Schedule like 'D%' order by GL_Master.Schedule)k where k.Account_Code not in ('10245','10246','40803','10247','10248','40804','10249','10250','40805','29006','10327','40829','10328','10329','40830','10330','10257','10258','40672','10257','10258','40808','10253','10254','20094','30445','20095','10276','10277','10278','10279','40811','40812','10282','10283','40814','45103','45104','45105','45106','45107') and k.Op_Balance!=0";
								
								//04.03.2024
								String sql = "Select a.GL_Code as Account_Code,a.GL_Name as Account_Name,Category,Schedule,CB as OP_BALANCE from GL_Master a left join (Select GL_Code,NVL(Opening_Balance,0)+NVL(Tran_Amt,0) as CB from GL_Master left join (Select Account_No,sum(case when Transaction_Type='Credit' then Transaction_Amount else -1*Transaction_Amount End) as Tran_Amt from Daily_Transaction where Transaction_Date<='"+Select_Date+"' and to_char(Transaction_Id||Transaction_Date) not in (select to_char(Transaction_Id||Transaction_Date) from Daily_Transaction where Account_No in (Select GL_Code from dbuser1.SK_GL)) group by Account_No) Daily_Transaction on GL_Master.GL_Code=Daily_Transaction.Account_no left join (Select Account_Code,sum(Opening_Balance) as Opening_Balance from GL_Opening_Balance group by Account_Code) GL_Opening_Balance on GL_Master.GL_Code=GL_Opening_Balance.Account_Code) d on a.GL_Code=d.GL_Code left join Schedule_Master1 c on a.SCHEDULE=c.SCHEDULE_CODE where Category in ('Asset','Liability') and NVL(CB,0)!=0 order by a.Schedule,a.GL_Code";

								return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException{  
						
						SimpleBranch gl=new SimpleBranch();
						
						gl.setS41(rs.getInt(1));  // Account Code
						gl.setS31(rs.getString(2));   // Account Name
						gl.setS32(rs.getString(3)); // Category
						gl.setS33(rs.getString(4)); // Schedule
						//gl.setS42(rs.getInt(5)); // Op_Balance
						
						gl.setS142(rs.getDouble(5)); // Op_Balance
						
						return gl;
					}
								 }     );
							}
				
			 
			 
			 public List<SimpleBranch> Mis_PenaltyIncome_Report(String sql)
			 {
					//--Set Connection----------------------------
								int j=Binfo;
								this.template=con.getCon2(j);
					//-----------------------------------------------------
						System.out.println(sql);
						 final double i=0;
						return template.query(sql,new RowMapper<SimpleBranch>(){   public SimpleBranch mapRow(ResultSet rs, int row) throws SQLException					{  
      
						SimpleBranch gl=new SimpleBranch();
						SimpleDateFormat sd=new SimpleDateFormat("dd/MM/yyyy");
						 DecimalFormat df = new DecimalFormat("#.00");   
						 gl.setS31(rs.getString(1));//sno
						gl.setS32(rs.getString(2));  //Bcode
						gl.setS33(rs.getString(3)); //Name
						gl.setS34(rs.getString(4)); //App code
						gl.setS35(rs.getString(5)); //Name
						
						gl.setS36(rs.getString(6));//trans id
						gl.setS37(rs.getString(7));//trans date
						gl.setS38(rs.getString(8));//particulars
						gl.setS39(rs.getString(9));//Amount
						gl.setS144(rs.getDouble(10));//Amount
					
						
						return gl;
					}
					 }     );
				}
		 
			 
			 
			 
}
